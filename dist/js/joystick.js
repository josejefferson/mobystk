(()=>{"use strict";var t,e={304:(t,e,n)=>{var o={joyLUp:["W","T","058","195"],joyLLeft:["A","F","063","196"],joyLDown:["S","G","096","197"],joyLRight:["D","H","097","198"],joyRUp:["5","9","098","199"],joyRLeft:["6","0","099","200"],joyRDown:["7","[","100","201"],joyRRight:["8","]","101","202"],padUp:["UP","Z","102","203","XUSB_GAMEPAD_DPAD_UP"],padLeft:["LEFT","X","103","204","XUSB_GAMEPAD_DPAD_LEFT"],padDown:["DOWN","C","104","205","XUSB_GAMEPAD_DPAD_DOWN"],padRight:["RIGHT","V","105","206","XUSB_GAMEPAD_DPAD_RIGHT"],actUp:["I","B","106","207","XUSB_GAMEPAD_Y"],actLeft:["J","N","107","208","XUSB_GAMEPAD_X"],actDown:["K","M","108","209","XUSB_GAMEPAD_A"],actRight:["L","Ç","109","210","XUSB_GAMEPAD_B"],left1:["Q","Y","110","211","XUSB_GAMEPAD_LEFT_SHOULDER"],left2:["1","3","111","212","XUSB_GAMEPAD_LEFT_TRIGGER"],left3:[";","´","187","213","XUSB_GAMEPAD_LEFT_THUMB"],right1:["E","U","188","214","XUSB_GAMEPAD_RIGHT_SHOULDER"],right2:["2","4","189","215","XUSB_GAMEPAD_RIGHT_TRIGGER"],right3:[".","~","190","216","XUSB_GAMEPAD_RIGHT_THUMB"],select:["ENTER","P","193","217","XUSB_GAMEPAD_BACK"],start:["SPACE","O","231","218","XUSB_GAMEPAD_START"],pause:["ESC","ESC","ESC","ESC","ESC"],load:["F1","F1","F1","F1","F1"],save:["[","[","[","[","["],fast:["TAB","TAB","TAB","TAB","TAB"],volUp:["MEDIA_VOLUME_UP","MEDIA_VOLUME_UP","MEDIA_VOLUME_UP","MEDIA_VOLUME_UP","MEDIA_VOLUME_UP"],volDown:["MEDIA_VOLUME_DOWN","MEDIA_VOLUME_DOWN","MEDIA_VOLUME_DOWN","MEDIA_VOLUME_DOWN","MEDIA_VOLUME_DOWN"]};window.keymappings=o;const r=o;var i=n(860),a=n.n(i)().namespace("joystick");function c(t,e){var n=a(t);return null===n?e:n}window.ls=a,window.getOpt=c;var s={ip:c("code","localhost:5000"),layout:c("layout"),player:c("player",1)-1,password:c("password"),debug:c("debug",!1),locked:c("locked",[]),hidden:c("hidden",[]),invertL:c("invertL",!1),invertR:c("invertR",!1),disJoyXAxis:c("disJoyXAxis",!1),disJoyYAxis:c("disJoyYAxis",!1),dblClickLoadSave:c("dblClickLoadSave",!1),changeKeyOnDrag:c("changeKeyOnDrag",!0),vibrate:c("vibrate",15),vibrateJoystick:c("vibrateJoystick",5),vibrationFromGame:c("vibrationFromGame",!0),vgamepad:c("vgamepad",!1),bgImage:c("bgImage",""),bgOpacity:c("bgOpacity",.5),bgBlur:c("bgBlur",0),colorsBackground:c("background","rgba(0, 0, 0, 1)"),colorsColor:c("color","rgba(255, 255, 255, 0.53)"),colorsBorder:c("border","rgba(255, 255, 255, 0.53)"),colorsActive:c("active","rgba(255, 255, 255, 0.2)"),customCSS:c("customCSS",""),customJS:c("customJS",""),pluginMobile:c("pluginMobile",!1),driveSensitivity:c("driveSensitivity",2),drivePrecision:c("drivePrecision",1)};window.options=s;const l=s;var d,u=n(45),p=n(294),v=document.querySelector(".ping"),y=!1,f=Date.now(),h={INFO:function(t){(0,p.Am)(t)},AUTH_FAILED:function(){if(!y){document.body.classList.remove("connecting","connected"),document.body.classList.add("disconnected");var t=prompt("O computador requer uma senha para se conectar ao MobyStk");null!==t&&(localStorage.setItem("joystick.password",t),y=!0,(0,u.Z)(),window.location.reload())}},pong:function(t){Number(t)===d&&(v&&(v.innerText=String(Date.now()-f)+"ms"),d=void 0)}};window.socketConnect=function(){var t;try{t=new WebSocket("ws://"+l.ip)}catch(t){return l.debug&&console.error(t),void e()}function e(){document.body.classList.remove("connecting","connected"),document.body.classList.add("disconnected"),setTimeout((function(){return g=m()}),3e3)}return t.addEventListener("open",(function(){document.body.classList.remove("connecting","disconnected"),document.body.classList.add("connected"),t.send("PASSWORD "+(l.password||""))})),t.addEventListener("close",e),t.addEventListener("message",(function(t){var e=t.data.split(" "),n=e[0],o=e.slice(1),r=h[n];"function"==typeof r&&r(o.join(" "))})),document.body.classList.remove("connected","disconnected"),document.body.classList.add("connecting"),t};var m=function(){return window.socketConnect()},g=m();window.socket=g,setInterval((function(){d&&v&&(v.innerText="+999ms"),d=Math.floor(1e6*Math.random()),f=Date.now(),null==g||g.send("ping ".concat(d))}),1e3);var b=Date.now();function w(t,e){var n;return void 0===e&&(e=!1),n=Array.isArray(t)?t.reduce((function(t,e){return t+Number(e)}),0):Number(t),e?(b=Date.now()+n,navigator.vibrate(t)):Date.now()+n>b&&navigator.vibrate(t)}var L=n(775),k=n(794),E=n(573),A=n(795),_={buttons:L.Z,groups:k.Z,joysticks:E.Z,layouts:A.Z,currentLayout:null,currentTouches:[],elements:{all:[],buttons:[],groups:[],joysticks:[]}};window.Controller=_;const S=_;var j=!1,O=!1,M=[];function x(){var t;(null===(t=window.layoutEditor)||void 0===t?void 0:t.opened)||(K("load"),K("load",!0),w(3*l.vibrate))}function D(){var t;(null===(t=window.layoutEditor)||void 0===t?void 0:t.opened)||(K("save"),K("save",!0),w(3*l.vibrate))}function P(){var t;(null===(t=window.layoutEditor)||void 0===t?void 0:t.opened)||O||(this.instance&&this.instance[this.instance.active?"release":"press"](),j||(M=[]),j=!j,window.recordingMacro=j,window.lastMacro=M)}function T(){var t,e,n,o,r;return e=this,n=void 0,r=function(){var e,n,o;return function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((r=(r=a.trys).length>0&&r[r.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}}(this,(function(r){switch(r.label){case 0:if(null===(t=window.layoutEditor)||void 0===t?void 0:t.opened)return[2];if(j)return[2];O=!O,window.playingMacro=O,this.instance&&this.instance.press(),e=0,n=M,r.label=1;case 1:return e<n.length?(o=n[e],O?1!==(null==g?void 0:g.readyState)?[3,4]:(null==g||g.send(o),[4,new Promise((function(t){return setTimeout(t,50)}))]):[3,4]):[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return this.instance&&this.instance.release(),O=!1,window.playingMacro=O,[2]}}))},new((o=void 0)||(o=Promise))((function(t,i){function a(t){try{s(r.next(t))}catch(t){i(t)}}function c(t){try{s(r.throw(t))}catch(t){i(t)}}function s(e){var n;e.done?t(e.value):(n=e.value,n instanceof o?n:new o((function(t){t(n)}))).then(a,c)}s((r=r.apply(e,n||[])).next())}))}function U(){document.documentElement.requestFullscreen()}window.playingMacro=O,window.recordingMacro=j,window.lastMacro=M,window.loadState=x,window.saveState=D,window.recordMacro=P,window.playMacro=T,window.fullScreen=U;var C=document.documentElement,B=document.querySelector(".edit"),I=document.querySelector(".backgroundImage"),R=document.querySelector(".deviceInfo"),X=R.querySelector(".battery"),G=X.querySelector(".battery-icon"),z=X.querySelector(".battery-level"),J=R.querySelector(".clock"),F=R.querySelector(".player .player-number"),H=R.querySelector(".layout"),q=(R.querySelector(".status"),document.querySelector(".ping")),N=document.querySelector(".controller-indicator"),Y=document.querySelector(".controller-layout"),V=document.querySelector('meta[name="viewport"]'),W=l.vgamepad?"mdi-google-controller":"mdi-keyboard";N.classList.add(W),h.V=function(t){var e=t.toLowerCase().split(" ")[0];if(l.vibrationFromGame){var n=parseInt(e.split("|")[0]);w(n?3e3:0,!0),N.classList[n?"remove":"add"](W),N.classList[n?"add":"remove"]("mdi-vibrate")}},window.sendCmd=function(t,e,n){if(void 0===e&&(e=!1),t&&t.length)return"string"==typeof t&&(t=[t]),n||(t=t.map((function(t){var e,n;return l.vgamepad?null===(e=r[t])||void 0===e?void 0:e[4]:null===(n=r[t])||void 0===n?void 0:n[l.player]}))),j&&n?M.push("".concat(n," ").concat(t," ").concat(l.player)):j?M.push("".concat(e?"R":"P"," ").concat(t," ").concat(l.player)):void(g&&1===g.readyState&&(n?g.send("".concat(n," ").concat(t," ").concat(l.player)):g.send("".concat(e?"R":"P"," ").concat(t," ").concat(l.player))))};var Z,K=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return window.sendCmd.apply(window,t)},Q=function(){function t(){this.events={}}return t.prototype.on=function(t,e){for(var n=this,o=0,r=t.split(" ");o<r.length;o++){var i=r[o];"object"!=typeof this.events[i]&&(this.events[i]=[]),this.events[i].push(e)}return function(){for(var o=0,r=t.split(" ");o<r.length;o++){var i=r[o];n.off(i,e)}}},t.prototype.off=function(t,e){for(var n=0,o=t.split(" ");n<o.length;n++){var r=o[n];if("object"==typeof this.events[r]){var i=this.events[r].indexOf(e);i>-1&&this.events[r].splice(i,1)}}},t.prototype.emit=function(t){for(var e=this,n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];for(var r=0,i=t.split(" ");r<i.length;r++){var a=i[r];"object"==typeof this.events[a]&&this.events[a].forEach((function(t){return t.apply(e,n)}))}},t.prototype.once=function(t,e){for(var n=this,o=function(t){var o=r.on(t,(function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];o(),e.apply(n,t)}))},r=this,i=0,a=t.split(" ");i<a.length;i++)o(a[i])},t}(),$=(Z=function(t,e){return Z=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},Z(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}Z(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});const tt=function(t){function e(e){var n=t.call(this)||this;return n.type="mobystk:unknown",n.id=e.id||"mobystk:unknown",n.name=e.name||"(Sem nome)",n.x=e.x||[0,"px"],n.y=e.y||[0,"px"],n.anchorX=e.anchorX||0,n.anchorY=e.anchorY||0,n.width=e.width||[100,"px"],n.height=e.height||[100,"px"],n}return $(e,t),e.prototype.render=function(){var t=this.element;t.style.left=null,t.style.right=null,t.style.top=null,t.style.bottom=null,t.style.transform=null,t.style.width=this.width.join(""),t.style.height=this.height.join(""),0===this.anchorX&&(t.style.left=this.x.join("")),1===this.anchorX&&(t.style.right=this.x.join("")),0===this.anchorY&&(t.style.top=this.y.join("")),1===this.anchorY&&(t.style.bottom=this.y.join("")),t.classList[2===this.anchorX?"add":"remove"]("center-x"),t.classList[2===this.anchorY?"add":"remove"]("center-y"),t.classList[this.editing?"add":"remove"]("controller-editing")},e.prototype.toObject=function(){return{type:this.type,id:this.id,name:this.name,x:this.x,y:this.y,anchorX:this.anchorX,anchorY:this.anchorY,width:this.width,height:this.height}},e}(Q);var et=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),nt=function(){return nt=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},nt.apply(this,arguments)},ot=function(t){function e(e){var n=t.call(this,e)||this;n.type="mobystk:button",n.content=e.content||{type:"mobystk:text",value:""},n.key=e.key||"",n.customAction=e.customAction||!1,n.lockable=e.lockable||!1,n.diagonal=e.diagonal||!1,n.diagonal&&(n.targets=e.targets||[]),n.scalable=e.scalable||!1,n.border=e.border||[!0,!0,!0,!0],n.radius=e.radius||[[0,"px"],[0,"px"],[0,"px"],[0,"px"]],n.fontSize=e.fontSize||[20,"px"],n.active=!1,n.editing=!1;var o=document.createElement("button");return o.classList.add("controller-button"),o.dataset.id=n.id,o.instance=n,n.element=o,n}return et(e,t),e.prototype.press=function(t){var e=this;if(void 0===t&&(t=!1),this.diagonal)for(var n=0,o=S.elements.buttons.filter((function(t){return e.targets.includes(t.id)&&!t.lockable}));n<o.length;n++)o[n].press(!0);else this.active||this.customAction||this.emit("press",this.key),!this.scalable||this.active||t?!this.active&&t&&(this.element.classList.add("controller-button-active-diagonal"),this.element.classList.add("controller-button-scale-diagonal")):this.element.classList.add("controller-button-scale"),this.active=!0,this.element.classList.add("controller-button-active")},e.prototype.release=function(){var t=this;if(this.diagonal)for(var e=0,n=S.elements.buttons.filter((function(e){return t.targets.includes(e.id)}));e<n.length;e++)n[e].release();else this.active&&!this.customAction&&this.emit("release",this.key),this.active=!1,this.element.classList.remove("controller-button-active"),this.element.classList.remove("controller-button-scale"),this.element.classList.remove("controller-button-active-diagonal"),this.element.classList.remove("controller-button-scale-diagonal")},e.prototype.render=function(){t.prototype.render.call(this);var e=this.element;this.border[0]||(e.style.borderTop="0"),this.border[1]||(e.style.borderRight="0"),this.border[2]||(e.style.borderBottom="0"),this.border[3]||(e.style.borderLeft="0");var n=this.radius.map((function(t){return t.join("")})).join(" ");if(e.style.borderRadius=n,e.style.fontSize=this.fontSize.join(""),e.classList[this.diagonal?"add":"remove"]("controller-button-diagonal"),e.classList[this.lockable?"add":"remove"]("controller-button-lockable"),e.innerHTML="","mobystk:text"===this.content.type)e.innerText=this.content.value;else if("mobystk:icon"===this.content.type){var o=document.createElement("i");o.classList.add("mdi","mdi-"+this.content.value),e.appendChild(o)}this._html&&(e.innerHTML=this._html),e.classList[this.customAction?"add":"remove"]("controller-custom-action"),e.dataset.action=this.customAction||null},e.prototype.toObject=function(){return nt(nt({},t.prototype.toObject.call(this)),{type:this.type,key:this.key,border:this.border,fontSize:this.fontSize,content:this.content,radius:this.radius,lockable:this.lockable,scalable:this.scalable,customAction:this.customAction,diagonal:this.diagonal,targets:this.targets})},e}(tt);const rt=ot;var it=n(694),at=n.n(it),ct=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),st=function(){return st=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},st.apply(this,arguments)};const lt=function(t){function e(e){var n=t.call(this,e)||this;n.type="mobystk:joystick",n.size=e.size||[90,"px"],n.padding=e.padding||60,n.keys=e.keys||["joyLUp","joyLLeft","joyLDown","joyLRight"],n.position={up:!1,down:!1,left:!1,right:!1};var o=document.createElement("div");return o.classList.add("controller-joystick"),o.dataset.id=n.id,o.instance=n,n.element=o,n}return ct(e,t),e.prototype.render=function(){var e=this;this.width=[this.size[0]+this.padding,this.size[1]],this.height=[this.size[0]+this.padding,this.size[1]],t.prototype.render.call(this);var n=this.element;this.position={up:!1,down:!1,left:!1,right:!1},this.nipple&&this.nipple.destroy(),this.nipple=at().create({zone:n,size:this.size[0],mode:"static",position:{left:"50%",top:"50%"},lockX:l.disJoyYAxis,lockY:l.disJoyXAxis}),this.nipple.on("move",(function(t,n){return e.emit("move",e,t,n)})),this.nipple.on("end",(function(t,n){return e.emit("end",e,t,n)}))},e.prototype.toObject=function(){return st(st({},t.prototype.toObject.call(this)),{type:this.type,size:this.size,padding:this.padding,keys:this.keys})},e}(tt);function dt(t){var e,n;if(!(null===(e=window.layoutEditor)||void 0===e?void 0:e.opened))for(var o=function(t){var e=S.currentTouches.findIndex((function(e){return e.touch.identifier===t.identifier}));if(e<0)return"continue";(null===(n=S.currentTouches[e].target)||void 0===n?void 0:n.instance)instanceof rt&&S.currentTouches[e].target.instance.release(),S.currentTouches.splice(e,1)},r=0,i=Array.from(t.changedTouches);r<i.length;r++)o(i[r])}document.addEventListener("touchstart",(function(t){var e;if(!(null===(e=window.layoutEditor)||void 0===e?void 0:e.opened))for(var n=0,o=Array.from(t.changedTouches);n<o.length;n++){for(var r=o[n],i=document.elementFromPoint(r.clientX,r.clientY);null!==i&&!(i.instance instanceof rt&&!i.instance.customAction||i.instance instanceof lt);)i=i.parentElement;if(null==i?void 0:i.instance.lockable)w(l.vibrate),i.instance.active?i.instance.release():i.instance.press();else{var a=(null==i?void 0:i.instance)instanceof lt;S.currentTouches.push({target:i,touch:r,joystick:a}),i&&(w(l.vibrate),a||i.instance.press())}}})),document.addEventListener("touchmove",(function(t){var e,n,o;if(!(null===(e=window.layoutEditor)||void 0===e?void 0:e.opened))for(var r=function(t){var e=S.currentTouches.findIndex((function(e){return e.touch.identifier===t.identifier}));if(e<0)return"continue";var r=S.currentTouches[e];if(r.joystick)return"continue";if(!l.changeKeyOnDrag&&r.target)return"continue";r.touch=t;for(var i=document.elementFromPoint(t.clientX,t.clientY);null!==i&&(!(i.instance instanceof rt)||i.instance.customAction||i.instance.lockable);)i=i.parentElement;return r.target===i?"continue":(null===(n=r.target)||void 0===n||n.instance.release(),i&&!(null===(o=i.instance)||void 0===o?void 0:o.active)||(i=null),r.target=i,i?(i.instance.press(),void w(l.vibrate)):"continue")},i=0,a=Array.from(t.changedTouches);i<a.length;i++){r(a[i])}})),document.addEventListener("touchend",dt),document.addEventListener("touchcancel",dt);var ut=["mobystk:joystick_left","mobystk:joystick_right"];function pt(t,e,n){var o,r;if(w(l.vibrateJoystick*(null==n?void 0:n.distance)/45),l.vgamepad&&ut.includes(t.id)){var i=Math.round(65534/90*(45+(null==n?void 0:n.distance)*Math.cos(null===(o=null==n?void 0:n.angle)||void 0===o?void 0:o.radian))-32768),a=Math.round(65534/90*(45+(null==n?void 0:n.distance)*Math.sin(null===(r=null==n?void 0:n.angle)||void 0===r?void 0:r.radian))-32768);(isNaN(i)||isNaN(a))&&(i=a=0),"mobystk:joystick_left"===t.id&&K("".concat(i,"|").concat(a),!1,"VJL"),"mobystk:joystick_right"===t.id&&K("".concat(i,"|").concat(a),!1,"VJR")}if(!(null==n?void 0:n.direction))return c("up",!1),c("left",!1),c("down",!1),void c("right",!1);function c(e,n){var o=function(t,e){var n={up:[t[0],"Top"],left:[t[1],"Left"],down:[t[2],"Bottom"],right:[t[3],"Right"]}[e];return{key:n[0],border:n[1]}}(t.keys,e),r=o.key,i=o.border;if(t.element.querySelector(".back").style["border".concat(i,"Width")]=n?"7px":"",!l.vgamepad||!ut.includes(t.id)){if(t.position[e]===n)return;K([r],!n)}t.position[e]=n}l.disJoyYAxis||c("up",(null==n?void 0:n.angle.degree)>22.5&&(null==n?void 0:n.angle.degree)<157.5),l.disJoyXAxis||c("left",(null==n?void 0:n.angle.degree)>112.5&&(null==n?void 0:n.angle.degree)<247.5),l.disJoyYAxis||c("down",(null==n?void 0:n.angle.degree)>202.5&&(null==n?void 0:n.angle.degree)<337.5),l.disJoyXAxis||c("right",(null==n?void 0:n.angle.degree)>292.5||(null==n?void 0:n.angle.degree)<67.5)}function vt(){var t;t=window.outerHeight>window.outerWidth/1.7777777777777777?640:window.outerWidth/window.outerHeight*360,V.setAttribute("content","width=".concat(t,", user-scalable=0")),S.currentTouches=S.currentTouches.filter((function(t){return!t.joystick})),S.elements.joysticks.forEach((function(t){return t.render()}))}window.addEventListener("load",vt),window.addEventListener("resize",vt);var yt=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),ft=function(){return ft=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},ft.apply(this,arguments)},ht=function(t){function e(e){var n=t.call(this,e)||this;n.type="mobystk:group",n.content=e.content||[],n.parsedContent=e.parsedContent||[];var o=document.createElement("div");o.classList.add("controller-group"),o.dataset.id=n.id,o.instance=n,n.element=o;for(var r=0,i=n.parsedContent;r<i.length;r++){var a=i[r];o.appendChild(a.element),a.render()}return n}return yt(e,t),e.prototype.toObject=function(){return ft(ft({},t.prototype.toObject.call(this)),{type:this.type,content:this.content})},e}(tt);const mt=ht;function gt(){var t=S.elements.buttons.find((function(t){return"drive"===t.customAction})),e=t?t._html='\n\t<svg viewBox="0 0 32 32">\n\t\t<path d="M16 0a16 16 0 100 32 16 16 0 000-32zm0 4a12 12 0 0111.3 8H4.7c1.7-4.6 6-8 11.3-8zm0 14a2 2 0 110-4 2 2 0 010 4zM4 16c5.5 0 9.9 5.3 10 11.8A12 12 0 014 16zm14 11.8c.1-6.5 4.5-11.8 10-11.8a12 12 0 01-10 11.8z"></path>\n\t</svg>':"";null==t||t.render(),t&&t.element.addEventListener("touchstart",(function(){var n;(null===(n=window.layoutEditor)||void 0===n?void 0:n.opened)||(t.active?(t.release(),t.element.innerHTML=e,window.ondevicemotion=null,l.vgamepad?K("0|0",!1,"VJL"):(K("joyLUp",!0),K("joyLLeft",!0),K("joyLRight",!0))):function(){t.press(),t.element.innerHTML='<i class="driveArrow mdi mdi-arrow-up"></i>';var e=0,n=0,o=[];window.ondevicemotion=function(r){var i=window.outerWidth>window.outerHeight,a=r.accelerationIncludingGravity[i?"x":"y"]>=0?1:-1;e=parseFloat(r.accelerationIncludingGravity[i?"y":"x"].toFixed(1)),e*=a*(i?1:-1);var c=t.element.children[0];if(l.vgamepad){var s=Math.round(32767/l.driveSensitivity*e);s<10923*l.drivePrecision&&s>-10923*l.drivePrecision&&(s=0),s>32767&&(s=32767),s<-32767&&(s=-32767),d=90*s/32767,c.style.transform="rotate(".concat(d,"deg)"),K("".concat(s,"|0"),!1,"VJL")}else{var d=function(t,e,n,o){var r=0;return-45===t?(e>n&&(r=45),e<-n+o&&(r=-45),e>2*n&&(r*=2),e<2*-n-o&&(r*=2)):45===t?(e>n-o&&(r=45),e<-n&&(r=-45),e>2*n+o&&(r*=2),e<2*-n&&(r*=2)):(e>n&&(r=45),e<-n&&(r=-45),e>2*n&&(r*=2),e<2*-n&&(r*=2)),r}(n,e,l.driveSensitivity,l.drivePrecision);if(d===n)return;c.style.transform="rotate(".concat(d,"deg)"),n=d,w(2*l.vibrate);var u=function(t){var e;switch(t){case-90:e=["joyLLeft"];break;case-45:e=["joyLUp","joyLLeft"];break;case 45:e=["joyLUp","joyLRight"];break;case 90:e=["joyLRight"];break;default:e=["joyLUp"]}return e}(d),p=u.filter((function(t){return!o.includes(t)})),v=o.filter((function(t){return!u.includes(t)}));K(p),K(v,!0),o=function(t,e,n){if(n||2===arguments.length)for(var o,r=0,i=e.length;r<i;r++)!o&&r in e||(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return t.concat(o||Array.prototype.slice.call(e))}([],u,!0)}}}())})),"https:"!==location.protocol&&"localhost"!==location.hostname&&"127.0.0.1"!==location.hostname&&t&&t.element&&(t.element.style.display="none")}var bt=function(){return bt=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},bt.apply(this,arguments)},wt=function(t,e,n){if(n||2===arguments.length)for(var o,r=0,i=e.length;r<i;r++)!o&&r in e||(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return t.concat(o||Array.prototype.slice.call(e))};function Lt(t,e){if(void 0===e&&(e=[]),"mobystk:layout"===t.type||"mobystk:group"===t.type){"mobystk:layout"!==t.type&&e.push(t);for(var n=0,o=t.parsedContent;n<o.length;n++)Lt(o[n],e)}else e.push(t);return e}function kt(t){var e,n,o="import"in t?t.import:t.id;if(!(null===(e=l.hidden)||void 0===e?void 0:e.includes(o))&&("import"in t&&(t=function(t){var e=wt(wt(wt([],S.buttons,!0),S.groups,!0),S.joysticks,!0).find((function(e){return e.id===t.import}));if(e)return bt(bt({},e),t)}(t)),t)){if("mobystk:button"===t.type)return(null===(n=l.locked)||void 0===n?void 0:n.includes(o))&&(t=bt(bt({},t),{lockable:!0})),new rt(t);if("mobystk:group"===t.type){t.parsedContent=t.content.map(kt).filter((function(t){return t}));var r=new mt(t);return t.parsedContent=t.parsedContent.map((function(t){return t.parent=r})),r}return"mobystk:joystick"===t.type?new lt(t):void 0}}if(!l.layout)throw window.location.href="index.html",new Error("Layout não selecionado");var Et,At,_t=S.layouts.find((function(t){return t.id===l.layout}));if(!_t)throw alert("Layout não encontrado!"),window.location.href="index.html",new Error("Layout não encontrado");!function(t){var e=bt(bt({},t),{parsedContent:t.content.map(kt).filter((function(t){return t}))}),n=Lt(e);Y.innerHTML="";for(var o=0,r=e.parsedContent;o<r.length;o++){var i=r[o];i&&(Y.appendChild(i.element),i.render())}S.currentLayout=e,S.elements.all=n,S.elements.buttons=n.filter((function(t){return t instanceof rt})),S.elements.groups=n.filter((function(t){return t instanceof mt})),S.elements.joysticks=n.filter((function(t){return t instanceof lt})),H.innerText=t.name||"???",function(){var t=S.elements.buttons.find((function(t){return"load-state"===t.customAction}));t&&t.element.addEventListener(l.dblClickLoadSave?"dblclick":"click",x);var e=S.elements.buttons.find((function(t){return"save-state"===t.customAction}));e&&e.element.addEventListener(l.dblClickLoadSave?"dblclick":"click",D),j=!1,O=!1,M=[],window.recordingMacro=j,window.playingMacro=O,window.lastMacro=M;var n=S.elements.buttons.find((function(t){return"macro-record"===t.customAction}));n&&n.element.addEventListener("click",P);var o=S.elements.buttons.find((function(t){return"macro-play"===t.customAction}));o&&o.element.addEventListener("click",T),document.querySelector(".deviceInfo").addEventListener("dblclick",U)}(),gt()}(_t);for(var St=0,jt=S.elements.all;St<jt.length;St++){var Ot=jt[St];Ot instanceof rt?(Ot.on("press",(function(t){return K(t,!1)})),Ot.on("release",(function(t){return K(t,!0)}))):Ot instanceof lt&&Ot.on("move end",pt)}l.hidden.includes("mobystk:deviceInfo")&&R.classList.add("hidden"),l.hidden.includes("mobystk:ping")&&q.classList.add("hidden"),B.addEventListener("click",u.Z),B.addEventListener("contextmenu",(function(){window.layoutEditor.opened?window.layoutEditor.end():window.layoutEditor.start()})),l.layout||(location.href="index.html"),l.debug&&document.body.classList.add("debug"),l.invertL&&document.body.classList.add("invertL"),l.invertR&&document.body.classList.add("invertR"),l.bgImage&&(I.style.backgroundImage="url('".concat(l.bgImage,"')")),l.bgOpacity&&(I.style.opacity=String(l.bgOpacity)),l.bgBlur&&(I.style.filter="blur(".concat(l.bgBlur,"px)")),l.colorsBackground&&C.style.setProperty("--background",l.colorsBackground),l.colorsColor&&C.style.setProperty("--color",l.colorsColor),l.colorsBorder&&C.style.setProperty("--border",l.colorsBorder),l.colorsActive&&C.style.setProperty("--active",l.colorsActive);var Mt=document.createElement("style");if(Mt.textContent=l.customCSS,document.body.append(Mt),l.customJS&&l.customJS.trim()&&confirm("Deseja executar os plugins?"))try{new Function(l.customJS.trim())()}catch(t){alert("Ocorreu um erro ao executar os plugins\n\n"+(t.message||""))}if(l.pluginMobile){var xt=document.createElement("script");xt.src="lib/plugins/mobile.js",xt.onerror=function(){return(0,p.Am)("Erro ao carregar plugin MobyStk Mobile")},document.body.appendChild(xt)}function Dt(t){var e;(e=G.classList).remove.apply(e,Array.from(G.classList)),G.classList.add("mdi");var n=t.charging,o=100*t.level,r=10*Math.round(o/10);z.innerText=Math.round(o)+"% •",0===r?G.classList.add("mdi-battery-outline"):100===r?G.classList.add("mdi-battery"+(n?"-charging-100":"")):G.classList.add("mdi-battery-"+(n?"charging-":"")+r)}function Pt(){var t=(new Date).getHours().toString().padStart(2,"0"),e=(new Date).getMinutes().toString().padStart(2,"0");J.innerText=t+":"+e}null===(At=null===(Et=navigator.getBattery)||void 0===Et?void 0:Et.call(navigator))||void 0===At||At.then((function(t){Dt(t),t.addEventListener("chargingchange",(function(t){return Dt(t.target)})),t.addEventListener("levelchange",(function(t){return Dt(t.target)}))})).catch(console.error),window.setInterval(Pt,1e3),Pt(),F.innerText=String(l.player+1),l.debug&&R.addEventListener("click",(function(){l.player+=1,l.player>3&&(l.player=0),F.innerText=String(l.player+1)})),document.addEventListener("contextmenu",(function(t){return t.preventDefault()})),window.addEventListener("load",(function(){document.body.classList.remove("preload")}))}},n={};function o(t){var r=n[t];if(void 0!==r)return r.exports;var i=n[t]={exports:{}};return e[t].call(i.exports,i,i.exports,o),i.exports}o.m=e,t=[],o.O=(e,n,r,i)=>{if(!n){var a=1/0;for(d=0;d<t.length;d++){for(var[n,r,i]=t[d],c=!0,s=0;s<n.length;s++)(!1&i||a>=i)&&Object.keys(o.O).every((t=>o.O[t](n[s])))?n.splice(s--,1):(c=!1,i<a&&(a=i));if(c){t.splice(d--,1);var l=r();void 0!==l&&(e=l)}}return e}i=i||0;for(var d=t.length;d>0&&t[d-1][2]>i;d--)t[d]=t[d-1];t[d]=[n,r,i]},o.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return o.d(e,{a:e}),e},o.d=(t,e)=>{for(var n in e)o.o(e,n)&&!o.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},o.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t={698:0};o.O.j=e=>0===t[e];var e=(e,n)=>{var r,i,[a,c,s]=n,l=0;if(a.some((e=>0!==t[e]))){for(r in c)o.o(c,r)&&(o.m[r]=c[r]);if(s)var d=s(o)}for(e&&e(n);l<a.length;l++)i=a[l],o.o(t,i)&&t[i]&&t[i][0](),t[i]=0;return o.O(d)},n=self.webpackChunkjoystick=self.webpackChunkjoystick||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))})();var r=o.O(void 0,[817,311],(()=>o(304)));r=o.O(r)})();
//# sourceMappingURL=joystick.js.map