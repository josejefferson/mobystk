import{a as at,b as ct,e as Ie,f as z,g as F,h as l,i as f}from"../chunk-XLFMGHWV.js";var $e=at((ae,ge)=>{(function(s,o){typeof ae=="object"&&typeof ge=="object"?ge.exports=o():typeof define=="function"&&define.amd?define("nipplejs",[],o):typeof ae=="object"?ae.nipplejs=o():s.nipplejs=o()})(window,function(){return function(s){var o={};function n(r){if(o[r])return o[r].exports;var d=o[r]={i:r,l:!1,exports:{}};return s[r].call(d.exports,d,d.exports,n),d.l=!0,d.exports}return n.m=s,n.c=o,n.d=function(r,d,m){n.o(r,d)||Object.defineProperty(r,d,{enumerable:!0,get:m})},n.r=function(r){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})},n.t=function(r,d){if(1&d&&(r=n(r)),8&d||4&d&&typeof r=="object"&&r&&r.__esModule)return r;var m=Object.create(null);if(n.r(m),Object.defineProperty(m,"default",{enumerable:!0,value:r}),2&d&&typeof r!="string")for(var _ in r)n.d(m,_,function(O){return r[O]}.bind(null,_));return m},n.n=function(r){var d=r&&r.__esModule?function(){return r.default}:function(){return r};return n.d(d,"a",d),d},n.o=function(r,d){return Object.prototype.hasOwnProperty.call(r,d)},n.p="",n(n.s=0)}([function(s,o,n){"use strict";n.r(o);var r,d=function(t,e){var i=e.x-t.x,a=e.y-t.y;return Math.sqrt(i*i+a*a)},m=function(t){return t*(Math.PI/180)},_=function(t){return t*(180/Math.PI)},O=new Map,A=function(t){O.has(t)&&clearTimeout(O.get(t)),O.set(t,setTimeout(t,100))},D=function(t,e,i){for(var a,c=e.split(/[ ,]+/g),p=0;p<c.length;p+=1)a=c[p],t.addEventListener?t.addEventListener(a,i,!1):t.attachEvent&&t.attachEvent(a,i)},R=function(t,e,i){for(var a,c=e.split(/[ ,]+/g),p=0;p<c.length;p+=1)a=c[p],t.removeEventListener?t.removeEventListener(a,i):t.detachEvent&&t.detachEvent(a,i)},G=function(t){return t.preventDefault(),t.type.match(/^touch/)?t.changedTouches:t},w=function(){return{x:window.pageXOffset!==void 0?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,y:window.pageYOffset!==void 0?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop}},S=function(t,e){e.top||e.right||e.bottom||e.left?(t.style.top=e.top,t.style.right=e.right,t.style.bottom=e.bottom,t.style.left=e.left):(t.style.left=e.x+"px",t.style.top=e.y+"px")},W=function(t,e,i){var a=V(t);for(var c in a)if(a.hasOwnProperty(c))if(typeof e=="string")a[c]=e+" "+i;else{for(var p="",h=0,u=e.length;h<u;h+=1)p+=e[h]+" "+i+", ";a[c]=p.slice(0,-2)}return a},V=function(t){var e={};return e[t]="",["webkit","Moz","o"].forEach(function(i){e[i+t.charAt(0).toUpperCase()+t.slice(1)]=""}),e},C=function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t},ce=function(t,e){if(t.length)for(var i=0,a=t.length;i<a;i+=1)e(t[i]);else e(t)},Ve="ontouchstart"in window,Qe=!!window.PointerEvent,Ze=!!window.MSPointerEvent,ke={start:"mousedown",move:"mousemove",end:"mouseup"},X={};function J(){}Qe?r={start:"pointerdown",move:"pointermove",end:"pointerup, pointercancel"}:Ze?r={start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}:Ve?(r={start:"touchstart",move:"touchmove",end:"touchend, touchcancel"},X=ke):r=ke,J.prototype.on=function(t,e){var i,a=t.split(/[ ,]+/g);this._handlers_=this._handlers_||{};for(var c=0;c<a.length;c+=1)i=a[c],this._handlers_[i]=this._handlers_[i]||[],this._handlers_[i].push(e);return this},J.prototype.off=function(t,e){return this._handlers_=this._handlers_||{},t===void 0?this._handlers_={}:e===void 0?this._handlers_[t]=null:this._handlers_[t]&&this._handlers_[t].indexOf(e)>=0&&this._handlers_[t].splice(this._handlers_[t].indexOf(e),1),this},J.prototype.trigger=function(t,e){var i,a=this,c=t.split(/[ ,]+/g);a._handlers_=a._handlers_||{};for(var p=0;p<c.length;p+=1)i=c[p],a._handlers_[i]&&a._handlers_[i].length&&a._handlers_[i].forEach(function(h){h.call(a,{type:i,target:a},e)})},J.prototype.config=function(t){this.options=this.defaults||{},t&&(this.options=function(e,i){var a={};for(var c in e)e.hasOwnProperty(c)&&i.hasOwnProperty(c)?a[c]=i[c]:e.hasOwnProperty(c)&&(a[c]=e[c]);return a}(this.options,t))},J.prototype.bindEvt=function(t,e){var i=this;return i._domHandlers_=i._domHandlers_||{},i._domHandlers_[e]=function(){typeof i["on"+e]=="function"?i["on"+e].apply(i,arguments):console.warn('[WARNING] : Missing "on'+e+'" handler.')},D(t,r[e],i._domHandlers_[e]),X[e]&&D(t,X[e],i._domHandlers_[e]),i},J.prototype.unbindEvt=function(t,e){return this._domHandlers_=this._domHandlers_||{},R(t,r[e],this._domHandlers_[e]),X[e]&&R(t,X[e],this._domHandlers_[e]),delete this._domHandlers_[e],this};var le=J;function b(t,e){return this.identifier=e.identifier,this.position=e.position,this.frontPosition=e.frontPosition,this.collection=t,this.defaults={size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:.5,mode:"dynamic",zone:document.body,lockX:!1,lockY:!1,shape:"circle"},this.config(e),this.options.mode==="dynamic"&&(this.options.restOpacity=0),this.id=b.id,b.id+=1,this.buildEl().stylize(),this.instance={el:this.ui.el,on:this.on.bind(this),off:this.off.bind(this),show:this.show.bind(this),hide:this.hide.bind(this),add:this.addToDom.bind(this),remove:this.removeFromDom.bind(this),destroy:this.destroy.bind(this),setPosition:this.setPosition.bind(this),resetDirection:this.resetDirection.bind(this),computeDirection:this.computeDirection.bind(this),trigger:this.trigger.bind(this),position:this.position,frontPosition:this.frontPosition,ui:this.ui,identifier:this.identifier,id:this.id,options:this.options},this.instance}b.prototype=new le,b.constructor=b,b.id=0,b.prototype.buildEl=function(t){return this.ui={},this.options.dataOnly?this:(this.ui.el=document.createElement("div"),this.ui.back=document.createElement("div"),this.ui.front=document.createElement("div"),this.ui.el.className="nipple collection_"+this.collection.id,this.ui.back.className="back",this.ui.front.className="front",this.ui.el.setAttribute("id","nipple_"+this.collection.id+"_"+this.id),this.ui.el.appendChild(this.ui.back),this.ui.el.appendChild(this.ui.front),this)},b.prototype.stylize=function(){if(this.options.dataOnly)return this;var t=this.options.fadeTime+"ms",e=function(c,p){var h=V(c);for(var u in h)h.hasOwnProperty(u)&&(h[u]=p);return h}("borderRadius","50%"),i=W("transition","opacity",t),a={};return a.el={position:"absolute",opacity:this.options.restOpacity,display:"block",zIndex:999},a.back={position:"absolute",display:"block",width:this.options.size+"px",height:this.options.size+"px",marginLeft:-this.options.size/2+"px",marginTop:-this.options.size/2+"px",background:this.options.color,opacity:".5"},a.front={width:this.options.size/2+"px",height:this.options.size/2+"px",position:"absolute",display:"block",marginLeft:-this.options.size/4+"px",marginTop:-this.options.size/4+"px",background:this.options.color,opacity:".5"},C(a.el,i),this.options.shape==="circle"&&C(a.back,e),C(a.front,e),this.applyStyles(a),this},b.prototype.applyStyles=function(t){for(var e in this.ui)if(this.ui.hasOwnProperty(e))for(var i in t[e])this.ui[e].style[i]=t[e][i];return this},b.prototype.addToDom=function(){return this.options.dataOnly||document.body.contains(this.ui.el)?this:(this.options.zone.appendChild(this.ui.el),this)},b.prototype.removeFromDom=function(){return this.options.dataOnly||!document.body.contains(this.ui.el)?this:(this.options.zone.removeChild(this.ui.el),this)},b.prototype.destroy=function(){clearTimeout(this.removeTimeout),clearTimeout(this.showTimeout),clearTimeout(this.restTimeout),this.trigger("destroyed",this.instance),this.removeFromDom(),this.off()},b.prototype.show=function(t){var e=this;return e.options.dataOnly||(clearTimeout(e.removeTimeout),clearTimeout(e.showTimeout),clearTimeout(e.restTimeout),e.addToDom(),e.restCallback(),setTimeout(function(){e.ui.el.style.opacity=1},0),e.showTimeout=setTimeout(function(){e.trigger("shown",e.instance),typeof t=="function"&&t.call(this)},e.options.fadeTime)),e},b.prototype.hide=function(t){var e=this;if(e.options.dataOnly)return e;if(e.ui.el.style.opacity=e.options.restOpacity,clearTimeout(e.removeTimeout),clearTimeout(e.showTimeout),clearTimeout(e.restTimeout),e.removeTimeout=setTimeout(function(){var c=e.options.mode==="dynamic"?"none":"block";e.ui.el.style.display=c,typeof t=="function"&&t.call(e),e.trigger("hidden",e.instance)},e.options.fadeTime),e.options.restJoystick){var i=e.options.restJoystick,a={};a.x=i===!0||i.x!==!1?0:e.instance.frontPosition.x,a.y=i===!0||i.y!==!1?0:e.instance.frontPosition.y,e.setPosition(t,a)}return e},b.prototype.setPosition=function(t,e){var i=this;i.frontPosition={x:e.x,y:e.y};var a=i.options.fadeTime+"ms",c={};c.front=W("transition",["top","left"],a);var p={front:{}};p.front={left:i.frontPosition.x+"px",top:i.frontPosition.y+"px"},i.applyStyles(c),i.applyStyles(p),i.restTimeout=setTimeout(function(){typeof t=="function"&&t.call(i),i.restCallback()},i.options.fadeTime)},b.prototype.restCallback=function(){var t={};t.front=W("transition","none",""),this.applyStyles(t),this.trigger("rested",this.instance)},b.prototype.resetDirection=function(){this.direction={x:!1,y:!1,angle:!1}},b.prototype.computeDirection=function(t){var e,i,a,c=t.angle.radian,p=Math.PI/4,h=Math.PI/2;if(c>p&&c<3*p&&!t.lockX?e="up":c>-p&&c<=p&&!t.lockY?e="left":c>3*-p&&c<=-p&&!t.lockX?e="down":t.lockY||(e="right"),t.lockY||(i=c>-h&&c<h?"left":"right"),t.lockX||(a=c>0?"up":"down"),t.force>this.options.threshold){var u,x={};for(u in this.direction)this.direction.hasOwnProperty(u)&&(x[u]=this.direction[u]);var y={};for(u in this.direction={x:i,y:a,angle:e},t.direction=this.direction,x)x[u]===this.direction[u]&&(y[u]=!0);if(y.x&&y.y&&y.angle)return t;y.x&&y.y||this.trigger("plain",t),y.x||this.trigger("plain:"+i,t),y.y||this.trigger("plain:"+a,t),y.angle||this.trigger("dir dir:"+e,t)}else this.resetDirection();return t};var et=b;function v(t,e){this.nipples=[],this.idles=[],this.actives=[],this.ids=[],this.pressureIntervals={},this.manager=t,this.id=v.id,v.id+=1,this.defaults={zone:document.body,multitouch:!1,maxNumberOfNipples:10,mode:"dynamic",position:{top:0,left:0},catchDistance:200,size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:.5,lockX:!1,lockY:!1,shape:"circle",dynamicPage:!1,follow:!1},this.config(e),this.options.mode!=="static"&&this.options.mode!=="semi"||(this.options.multitouch=!1),this.options.multitouch||(this.options.maxNumberOfNipples=1);var i=getComputedStyle(this.options.zone.parentElement);return i&&i.display==="flex"&&(this.parentIsFlex=!0),this.updateBox(),this.prepareNipples(),this.bindings(),this.begin(),this.nipples}v.prototype=new le,v.constructor=v,v.id=0,v.prototype.prepareNipples=function(){var t=this.nipples;t.on=this.on.bind(this),t.off=this.off.bind(this),t.options=this.options,t.destroy=this.destroy.bind(this),t.ids=this.ids,t.id=this.id,t.processOnMove=this.processOnMove.bind(this),t.processOnEnd=this.processOnEnd.bind(this),t.get=function(e){if(e===void 0)return t[0];for(var i=0,a=t.length;i<a;i+=1)if(t[i].identifier===e)return t[i];return!1}},v.prototype.bindings=function(){this.bindEvt(this.options.zone,"start"),this.options.zone.style.touchAction="none",this.options.zone.style.msTouchAction="none"},v.prototype.begin=function(){var t=this.options;if(t.mode==="static"){var e=this.createNipple(t.position,this.manager.getIdentifier());e.add(),this.idles.push(e)}},v.prototype.createNipple=function(t,e){var i=this.manager.scroll,a={},c=this.options,p=this.parentIsFlex?i.x:i.x+this.box.left,h=this.parentIsFlex?i.y:i.y+this.box.top;if(t.x&&t.y)a={x:t.x-p,y:t.y-h};else if(t.top||t.right||t.bottom||t.left){var u=document.createElement("DIV");u.style.display="hidden",u.style.top=t.top,u.style.right=t.right,u.style.bottom=t.bottom,u.style.left=t.left,u.style.position="absolute",c.zone.appendChild(u);var x=u.getBoundingClientRect();c.zone.removeChild(u),a=t,t={x:x.left+i.x,y:x.top+i.y}}var y=new et(this,{color:c.color,size:c.size,threshold:c.threshold,fadeTime:c.fadeTime,dataOnly:c.dataOnly,restJoystick:c.restJoystick,restOpacity:c.restOpacity,mode:c.mode,identifier:e,position:t,zone:c.zone,frontPosition:{x:0,y:0},shape:c.shape});return c.dataOnly||(S(y.ui.el,a),S(y.ui.front,y.frontPosition)),this.nipples.push(y),this.trigger("added "+y.identifier+":added",y),this.manager.trigger("added "+y.identifier+":added",y),this.bindNipple(y),y},v.prototype.updateBox=function(){this.box=this.options.zone.getBoundingClientRect()},v.prototype.bindNipple=function(t){var e,i=this,a=function(c,p){e=c.type+" "+p.id+":"+c.type,i.trigger(e,p)};t.on("destroyed",i.onDestroyed.bind(i)),t.on("shown hidden rested dir plain",a),t.on("dir:up dir:right dir:down dir:left",a),t.on("plain:up plain:right plain:down plain:left",a)},v.prototype.pressureFn=function(t,e,i){var a=this,c=0;clearInterval(a.pressureIntervals[i]),a.pressureIntervals[i]=setInterval(function(){var p=t.force||t.pressure||t.webkitForce||0;p!==c&&(e.trigger("pressure",p),a.trigger("pressure "+e.identifier+":pressure",p),c=p)}.bind(a),100)},v.prototype.onstart=function(t){var e=this,i=e.options,a=t;return t=G(t),e.updateBox(),ce(t,function(c){e.actives.length<i.maxNumberOfNipples?e.processOnStart(c):a.type.match(/^touch/)&&(Object.keys(e.manager.ids).forEach(function(p){if(Object.values(a.touches).findIndex(function(u){return u.identifier===p})<0){var h=[t[0]];h.identifier=p,e.processOnEnd(h)}}),e.actives.length<i.maxNumberOfNipples&&e.processOnStart(c))}),e.manager.bindDocument(),!1},v.prototype.processOnStart=function(t){var e,i=this,a=i.options,c=i.manager.getIdentifier(t),p=t.force||t.pressure||t.webkitForce||0,h={x:t.pageX,y:t.pageY},u=i.getOrCreate(c,h);u.identifier!==c&&i.manager.removeIdentifier(u.identifier),u.identifier=c;var x=function(y){y.trigger("start",y),i.trigger("start "+y.id+":start",y),y.show(),p>0&&i.pressureFn(t,y,y.identifier),i.processOnMove(t)};if((e=i.idles.indexOf(u))>=0&&i.idles.splice(e,1),i.actives.push(u),i.ids.push(u.identifier),a.mode!=="semi")x(u);else{if(!(d(h,u.position)<=a.catchDistance))return u.destroy(),void i.processOnStart(t);x(u)}return u},v.prototype.getOrCreate=function(t,e){var i,a=this.options;return/(semi|static)/.test(a.mode)?(i=this.idles[0])?(this.idles.splice(0,1),i):a.mode==="semi"?this.createNipple(e,t):(console.warn("Coudln't find the needed nipple."),!1):i=this.createNipple(e,t)},v.prototype.processOnMove=function(t){var e=this.options,i=this.manager.getIdentifier(t),a=this.nipples.get(i),c=this.manager.scroll;if(function($){return isNaN($.buttons)?$.pressure!==0:$.buttons!==0}(t)){if(!a)return console.error("Found zombie joystick with ID "+i),void this.manager.removeIdentifier(i);if(e.dynamicPage){var p=a.el.getBoundingClientRect();a.position={x:c.x+p.left,y:c.y+p.top}}a.identifier=i;var h=a.options.size/2,u={x:t.pageX,y:t.pageY};e.lockX&&(u.y=a.position.y),e.lockY&&(u.x=a.position.x);var x,y,xe,Ee,Q,N,de,pe,Z,ee,K=d(u,a.position),Y=(x=u,y=a.position,xe=y.x-x.x,Ee=y.y-x.y,_(Math.atan2(Ee,xe))),ot=m(Y),nt=K/h,it={distance:K,position:u};if(a.options.shape==="circle"?(Q=Math.min(K,h),de=a.position,pe=Q,ee={x:0,y:0},Z=m(Z=Y),ee.x=de.x-pe*Math.cos(Z),ee.y=de.y-pe*Math.sin(Z),N=ee):(N=function($,oe,ne){return{x:Math.min(Math.max($.x,oe.x-ne),oe.x+ne),y:Math.min(Math.max($.y,oe.y-ne),oe.y+ne)}}(u,a.position,h),Q=d(N,a.position)),e.follow){if(K>h){var st=u.x-N.x,rt=u.y-N.y;a.position.x+=st,a.position.y+=rt,a.el.style.top=a.position.y-(this.box.top+c.y)+"px",a.el.style.left=a.position.x-(this.box.left+c.x)+"px",K=d(u,a.position)}}else u=N,K=Q;var Oe=u.x-a.position.x,Ce=u.y-a.position.y;a.frontPosition={x:Oe,y:Ce},e.dataOnly||S(a.ui.front,a.frontPosition);var te={identifier:a.identifier,position:u,force:nt,pressure:t.force||t.pressure||t.webkitForce||0,distance:K,angle:{radian:ot,degree:Y},vector:{x:Oe/h,y:-Ce/h},raw:it,instance:a,lockX:e.lockX,lockY:e.lockY};(te=a.computeDirection(te)).angle={radian:m(180-Y),degree:180-Y},a.trigger("move",te),this.trigger("move "+a.id+":move",te)}else this.processOnEnd(t)},v.prototype.processOnEnd=function(t){var e=this,i=e.options,a=e.manager.getIdentifier(t),c=e.nipples.get(a),p=e.manager.removeIdentifier(c.identifier);c&&(i.dataOnly||c.hide(function(){i.mode==="dynamic"&&(c.trigger("removed",c),e.trigger("removed "+c.id+":removed",c),e.manager.trigger("removed "+c.id+":removed",c),c.destroy())}),clearInterval(e.pressureIntervals[c.identifier]),c.resetDirection(),c.trigger("end",c),e.trigger("end "+c.id+":end",c),e.ids.indexOf(c.identifier)>=0&&e.ids.splice(e.ids.indexOf(c.identifier),1),e.actives.indexOf(c)>=0&&e.actives.splice(e.actives.indexOf(c),1),/(semi|static)/.test(i.mode)?e.idles.push(c):e.nipples.indexOf(c)>=0&&e.nipples.splice(e.nipples.indexOf(c),1),e.manager.unbindDocument(),/(semi|static)/.test(i.mode)&&(e.manager.ids[p.id]=p.identifier))},v.prototype.onDestroyed=function(t,e){this.nipples.indexOf(e)>=0&&this.nipples.splice(this.nipples.indexOf(e),1),this.actives.indexOf(e)>=0&&this.actives.splice(this.actives.indexOf(e),1),this.idles.indexOf(e)>=0&&this.idles.splice(this.idles.indexOf(e),1),this.ids.indexOf(e.identifier)>=0&&this.ids.splice(this.ids.indexOf(e.identifier),1),this.manager.removeIdentifier(e.identifier),this.manager.unbindDocument()},v.prototype.destroy=function(){for(var t in this.unbindEvt(this.options.zone,"start"),this.nipples.forEach(function(e){e.destroy()}),this.pressureIntervals)this.pressureIntervals.hasOwnProperty(t)&&clearInterval(this.pressureIntervals[t]);this.trigger("destroyed",this.nipples),this.manager.unbindDocument(),this.off()};var tt=v;function k(t){var e=this;e.ids={},e.index=0,e.collections=[],e.scroll=w(),e.config(t),e.prepareCollections();var i=function(){var c;e.collections.forEach(function(p){p.forEach(function(h){c=h.el.getBoundingClientRect(),h.position={x:e.scroll.x+c.left,y:e.scroll.y+c.top}})})};D(window,"resize",function(){A(i)});var a=function(){e.scroll=w()};return D(window,"scroll",function(){A(a)}),e.collections}k.prototype=new le,k.constructor=k,k.prototype.prepareCollections=function(){var t=this;t.collections.create=t.create.bind(t),t.collections.on=t.on.bind(t),t.collections.off=t.off.bind(t),t.collections.destroy=t.destroy.bind(t),t.collections.get=function(e){var i;return t.collections.every(function(a){return!(i=a.get(e))}),i}},k.prototype.create=function(t){return this.createCollection(t)},k.prototype.createCollection=function(t){var e=new tt(this,t);return this.bindCollection(e),this.collections.push(e),e},k.prototype.bindCollection=function(t){var e,i=this,a=function(c,p){e=c.type+" "+p.id+":"+c.type,i.trigger(e,p)};t.on("destroyed",i.onDestroyed.bind(i)),t.on("shown hidden rested dir plain",a),t.on("dir:up dir:right dir:down dir:left",a),t.on("plain:up plain:right plain:down plain:left",a)},k.prototype.bindDocument=function(){this.binded||(this.bindEvt(document,"move").bindEvt(document,"end"),this.binded=!0)},k.prototype.unbindDocument=function(t){Object.keys(this.ids).length&&t!==!0||(this.unbindEvt(document,"move").unbindEvt(document,"end"),this.binded=!1)},k.prototype.getIdentifier=function(t){var e;return t?(e=t.identifier===void 0?t.pointerId:t.identifier)===void 0&&(e=this.latest||0):e=this.index,this.ids[e]===void 0&&(this.ids[e]=this.index,this.index+=1),this.latest=e,this.ids[e]},k.prototype.removeIdentifier=function(t){var e={};for(var i in this.ids)if(this.ids[i]===t){e.id=i,e.identifier=this.ids[i],delete this.ids[i];break}return e},k.prototype.onmove=function(t){return this.onAny("move",t),!1},k.prototype.onend=function(t){return this.onAny("end",t),!1},k.prototype.oncancel=function(t){return this.onAny("end",t),!1},k.prototype.onAny=function(t,e){var i,a=this,c="processOn"+t.charAt(0).toUpperCase()+t.slice(1);return e=G(e),ce(e,function(p){i=a.getIdentifier(p),ce(a.collections,function(h,u,x){x.ids.indexOf(u)>=0&&(x[c](h),h._found_=!0)}.bind(null,p,i)),p._found_||a.removeIdentifier(i)}),!1},k.prototype.destroy=function(){this.unbindDocument(!0),this.ids={},this.index=0,this.collections.forEach(function(t){t.destroy()}),this.off()},k.prototype.onDestroyed=function(t,e){if(this.collections.indexOf(e)<0)return!1;this.collections.splice(this.collections.indexOf(e),1)};var we=new k;o.default={create:function(t){return we.create(t)},factory:we}}]).default})});var q=document.documentElement,ue=document.querySelector(".edit"),ie=document.querySelector(".backgroundImage"),H=document.querySelector(".deviceInfo"),_e=H.querySelector(".battery"),B=_e.querySelector(".battery-icon"),Le=_e.querySelector(".battery-level"),Te=H.querySelector(".clock"),Me=H.querySelector(".player .player-number"),vt=H.querySelector(".status"),Se=document.querySelector(".ping"),U=document.querySelector(".controller-indicator"),me=document.querySelector(".controller-layout"),bt=document.querySelector('meta[name="viewport"]');l.hidden.includes("mobystk:deviceInfo")&&H.classList.add("hidden");l.hidden.includes("mobystk:ping")&&Se.classList.add("hidden");ue.addEventListener("click",Ie);ue.addEventListener("contextmenu",()=>{window.layoutEditor.opened?window.layoutEditor.end():window.layoutEditor.start()});l.layout||(location.href="index.html");l.debug&&document.body.classList.add("debug");l.invertL&&document.body.classList.add("invertL");l.invertR&&document.body.classList.add("invertR");l.bgImage&&(ie.style.backgroundImage=`url('${l.bgImage}')`);l.bgOpacity&&(ie.style.opacity=String(l.bgOpacity));l.bgBlur&&(ie.style.filter=`blur(${l.bgBlur}px)`);l.colorsBackground&&q.style.setProperty("--background",l.colorsBackground);l.colorsColor&&q.style.setProperty("--color",l.colorsColor);l.colorsBorder&&q.style.setProperty("--border",l.colorsBorder);l.colorsActive&&q.style.setProperty("--active",l.colorsActive);var De=document.createElement("style");De.textContent=l.customCSS;document.body.append(De);if(l.customJS&&l.customJS.trim()&&confirm("Deseja executar os plugins?"))try{new Function(l.customJS.trim())()}catch(s){alert(`Ocorreu um erro ao executar os plugins

`+(s?.message||""))}if(l.pluginMobile){let s=document.createElement("script");s.src="lib/plugins/mobile.js",s.onerror=()=>z("Erro ao carregar plugin MobyStk Mobile"),document.body.appendChild(s)}navigator.getBattery?.()?.then(s=>{fe(s),s.addEventListener("chargingchange",o=>fe(o.target)),s.addEventListener("levelchange",o=>fe(o.target))}).catch(console.error);function fe(s){B.classList.remove(...Array.from(B.classList)),B.classList.add("mdi");let o=s.charging,n=s.level*100,r=Math.round(n/10)*10;Le.innerText=Math.round(n)+"% \u2022",r===0?B.classList.add("mdi-battery-outline"):r===100?B.classList.add("mdi-battery"+(o?"-charging-100":"")):B.classList.add("mdi-battery-"+(o?"charging-":"")+r)}window.setInterval(Pe,1e3);Pe();se();function Pe(){let s=new Date().getHours().toString().padStart(2,"0"),o=new Date().getMinutes().toString().padStart(2,"0");Te.innerText=s+":"+o}function se(){let s=l.useKeyboard?"mdi-keyboard":"mdi-google-controller";U.classList.add(s),Me.innerText=(l.useKeyboard?"Teclado ":"Controle ")+String(l.player+1)}l.debug&&H.addEventListener("click",()=>{l.player+=1,l.player>3&&(l.player=0),se()});var Ae=Date.now(),Je=0;function E(s,o=!1){let n;return Array.isArray(s)?n=s.reduce((r,d)=>r+=Number(d),0):n=Number(s),n>Je&&(o=!0),Je=n,o?(Ae=Date.now()+n,navigator.vibrate(s)):Date.now()+n>Ae?navigator.vibrate(s):!1}var re=document.querySelector(".ping"),he=class{constructor(){this.pingTime=Date.now();this.connect(),setInterval(()=>this.sendPing(),1e3)}connect(){try{this.instance=new WebSocket("ws://"+l.ip)}catch(o){l.debug&&console.error(o),this.onClose();return}this.instance.addEventListener("open",this.onOpen.bind(this)),this.instance.addEventListener("close",this.onClose.bind(this)),this.instance.addEventListener("message",this.onMessage.bind(this)),document.body.classList.remove("connected","disconnected"),document.body.classList.add("connecting")}onOpen(){document.body.classList.remove("connecting","disconnected"),document.body.classList.add("connected")}onClose(){document.body.classList.remove("connecting","connected"),document.body.classList.add("disconnected"),setTimeout(()=>this.connect(),3e3)}onMessage(o){let[n,r]=JSON.parse(o.data);n==="welcome"&&this.onWelcome(r),n==="handshakeOK"&&this.onHandshakeOK(r),n==="handshakeFailed"&&this.onHandshakeFailed(r),n==="pong"&&this.onPong(r),n==="vibrate"&&this.onVibrate(r)}sendCommand(o,n){if(L)return void P.push([o,n]);if(this.instance.readyState!==this.instance.OPEN)return;let d=JSON.stringify([o,n]);this.instance.send(d)}sendPing(){this.instance.readyState===this.instance.OPEN&&(this.pingID&&re&&(re.innerText="+999ms"),this.pingID=Math.floor(Math.random()*1e6),this.pingTime=Date.now(),this.sendCommand("ping",{id:this.pingID}))}sendKey(o,n){this.sendCommand("key",{key:o,action:n})}sendJoystickPos(o,n=0,r=0){this.sendCommand("key",{key:o,action:"press",x:n||0,y:r||0})}onWelcome(o){let n=null;o.needPassword&&(n=l.password||this.askPassword()||null,!n)||this.sendCommand("handshake",{player:l.player,password:n,useKeyboard:l.useKeyboard})}onHandshakeOK(o){o.otherPlayerConnected&&z("Outro jogador j\xE1 est\xE1 conectado neste controle"),o.vGamepadDisabled&&z("O controle virtual est\xE1 desativado, voc\xEA pode ativ\xE1-lo nas op\xE7\xF5es do MobyStk no computador"),o.vGamepadError&&z("N\xE3o foi poss\xEDvel criar um controle virtual. Utilizando o teclado"),l.useKeyboard=o.useKeyboard,se()}onHandshakeFailed(o){o.passwordIncorrect&&(alert("Senha incorreta"),l.password=void 0,localStorage.removeItem("joystick.password"),this.onWelcome({needPassword:!0}))}onPong(o){Number(o.id)===this.pingID&&(re&&(re.innerText=String(Date.now()-this.pingTime)+"ms"),this.pingID=void 0)}onVibrate(o){l.vibrationFromGame&&(E(o.largeMotor?1e3:1,!0),U.classList[o.largeMotor?"remove":"add"](l.useKeyboard?"mdi-keyboard":"mdi-google-controller"),U.classList[o.largeMotor?"add":"remove"]("mdi-vibrate"))}askPassword(){let o=prompt("O computador requer uma senha para se conectar ao MobyStk");return o?(l.password=o,localStorage.setItem("joystick.password",JSON.stringify(o)),o):void z("Voc\xEA precisa informar a senha para se conectar")}},g=new he;var L=!1,T=!1,P=[];function Ke(){window.layoutEditor?.opened||(g.sendKey("LOAD","press"),g.sendKey("LOAD","release"),E(l.vibrate*3))}function ze(){window.layoutEditor?.opened||(g.sendKey("SAVE","press"),g.sendKey("SAVE","release"),E(l.vibrate*3))}function He(){window.layoutEditor?.opened||T||(this.instance&&this.instance[this.instance.active?"release":"press"](),L||(P=[]),L=!L,window.recordingMacro=L,window.lastMacro=P)}async function Be(){if(!window.layoutEditor?.opened&&!L){T=!T,window.playingMacro=T,this.instance&&this.instance.press();for(let s of P){if(!T||g.instance.readyState!==WebSocket.OPEN)break;g?.sendCommand(s[0],s[1]),await new Promise(o=>setTimeout(o,50))}this.instance&&this.instance.release(),T=!1,window.playingMacro=T}}function Ne(){document.documentElement.requestFullscreen()}document.addEventListener("fullscreenchange",s=>{let o=f.elements.buttons.find(n=>n.customAction==="fullscreen");o&&(document.fullscreenElement?o.element.classList.add("hidden"):o.element.classList.remove("hidden"))});function ye(){let s=f.elements.buttons.find(m=>m.customAction==="load-state");s&&s.element.addEventListener(l.dblClickLoadSave?"dblclick":"click",Ke);let o=f.elements.buttons.find(m=>m.customAction==="save-state");o&&o.element.addEventListener(l.dblClickLoadSave?"dblclick":"click",ze),L=!1,T=!1,P=[],window.recordingMacro=L,window.playingMacro=T,window.lastMacro=P;let n=f.elements.buttons.find(m=>m.customAction==="macro-record");n&&n.element.addEventListener("click",He);let r=f.elements.buttons.find(m=>m.customAction==="macro-play");r&&r.element.addEventListener("click",Be);let d=f.elements.buttons.find(m=>m.customAction==="fullscreen");d&&d.element.addEventListener("click",Ne)}window.playingMacro=T;window.recordingMacro=L;window.lastMacro=P;window.loadState=Ke;window.saveState=ze;window.recordMacro=He;window.playMacro=Be;window.fullScreen=Ne;var I=class extends F{constructor(o){super(o),this.type="mobystk:button",this.content=o.content||{type:"mobystk:text",value:""},this.key=o.key||"",this.customAction=o.customAction||!1,this.lockable=o.lockable||!1,this.diagonal=o.diagonal||!1,this.diagonal&&(this.targets=o.targets||[]),this.scalable=o.scalable||!1,this.border=o.border||[!0,!0,!0,!0],this.radius=o.radius||[[0,"px"],[0,"px"],[0,"px"],[0,"px"]],this.fontSize=o.fontSize||[20,"px"],this.active=!1,this.editing=!1;let n=document.createElement("button");n.classList.add("controller-button"),n.dataset.id=this.id,n.instance=this,this.element=n}press(o=!1){if(this.diagonal){let n=f.elements.buttons.filter(r=>this.targets.includes(r.id)&&!r.lockable);for(let r of n)r.press(!0)}else!this.active&&!this.customAction&&this.emit("press",this.key),this.scalable&&!this.active&&!o?this.element?.classList.add("controller-button-scale"):!this.active&&o&&(this.element?.classList.add("controller-button-active-diagonal"),this.element?.classList.add("controller-button-scale-diagonal")),this.active=!0,this.element?.classList.add("controller-button-active")}release(){if(this.diagonal){let o=f.elements.buttons.filter(n=>this.targets.includes(n.id));for(let n of o)n.release()}else this.active&&!this.customAction&&this.emit("release",this.key),this.active=!1,this.element?.classList.remove("controller-button-active"),this.element?.classList.remove("controller-button-scale"),this.element?.classList.remove("controller-button-active-diagonal"),this.element?.classList.remove("controller-button-scale-diagonal")}render(){super.render();let o=this.element;if(!o)return;this.border[0]||(o.style.borderTop="0"),this.border[1]||(o.style.borderRight="0"),this.border[2]||(o.style.borderBottom="0"),this.border[3]||(o.style.borderLeft="0");let n=this.radius.map(r=>r.join("")).join(" ");if(o.style.borderRadius=n,o.style.fontSize=this.fontSize.join(""),o.classList[this.diagonal?"add":"remove"]("controller-button-diagonal"),o.classList[this.lockable?"add":"remove"]("controller-button-lockable"),o.innerHTML="",this.content.type==="mobystk:text")o.innerText=this.content.value;else if(this.content.type==="mobystk:icon"){let r=document.createElement("i");r.classList.add("mdi","mdi-"+this.content.value),o.appendChild(r)}this._html&&(o.innerHTML=this._html),o.classList[this.customAction?"add":"remove"]("controller-custom-action"),o.dataset.action=this.customAction||void 0}toObject(){return{...super.toObject(),type:this.type,key:this.key,border:this.border,fontSize:this.fontSize,content:this.content,radius:this.radius,lockable:this.lockable,scalable:this.scalable,customAction:this.customAction,diagonal:this.diagonal,targets:this.targets}}};var Fe=ct($e(),1);var M=class extends F{constructor(o){super(o),this.type="mobystk:joystick",this.size=o.size||[90,"px"],this.padding=o.padding||60,this.keys=o.keys||["JOYSTICK_1_UP","JOYSTICK_1_LEFT","JOYSTICK_1_DOWN","JOYSTICK_1_RIGHT"],this.position={up:!1,down:!1,left:!1,right:!1};let n=document.createElement("div");n.classList.add("controller-joystick"),n.dataset.id=this.id,n.instance=this,this.element=n}render(){this.width=[this.size[0]+this.padding,this.size[1]],this.height=[this.size[0]+this.padding,this.size[1]],super.render();let o=this.element;this.position={up:!1,down:!1,left:!1,right:!1},this.nipple&&this.nipple.destroy(),this.nipple=Fe.default.create({zone:o,size:this.size[0],mode:"static",position:{left:"50%",top:"50%"},lockX:l.disJoyYAxis,lockY:l.disJoyXAxis}),this.nipple.on("move",(n,r)=>this.emit("move",this,n,r)),this.nipple.on("end",(n,r)=>this.emit("end",this,n,r))}toObject(){return{...super.toObject(),type:this.type,size:this.size,padding:this.padding,keys:this.keys}}};document.addEventListener("touchstart",lt);document.addEventListener("touchmove",dt);document.addEventListener("touchend",je);document.addEventListener("touchcancel",je);function lt(s){if(!window.layoutEditor?.opened)for(let o of Array.from(s.changedTouches)){let n=document.elementFromPoint(o.clientX,o.clientY);for(;n!==null&&!(n.instance instanceof I&&!n.instance.customAction||n.instance instanceof M);)n=n.parentElement;if(n?.instance.lockable){E(l.vibrate),n.instance.active?n.instance.release():n.instance.press();continue}let r=n?.instance instanceof M;f.currentTouches.push({target:n,touch:o,joystick:r}),n&&(E(l.vibrate),!r&&n.instance.press())}}function dt(s){if(!window.layoutEditor?.opened)for(let o of Array.from(s.changedTouches)){let n=f.currentTouches.findIndex(m=>m.touch.identifier===o.identifier);if(n<0)continue;let r=f.currentTouches[n];if(r.joystick||!l.changeKeyOnDrag&&r.target)continue;r.touch=o;let d=document.elementFromPoint(o.clientX,o.clientY);for(;d!==null&&!(d.instance instanceof I&&!d.instance.customAction&&!d.instance.lockable);)d=d.parentElement;r.target!==d&&(r.target?.instance.release(),(!d||d.instance?.active)&&(d=null),r.target=d,d&&(d.instance.press(),E(l.vibrate)))}}function je(s){if(!window.layoutEditor?.opened)for(let o of Array.from(s.changedTouches)){let n=f.currentTouches.findIndex(r=>r.touch.identifier===o.identifier);n<0||(f.currentTouches[n].target?.instance instanceof I&&f.currentTouches[n].target.instance.release(),f.currentTouches.splice(n,1))}}var Ge=["mobystk:joystick_left_bottom","mobystk:joystick_left_top","mobystk:joystick_right_top","mobystk:joystick_right_bottom"];function ve(s,o,n){if(l.vibrateJoystick&&E(l.vibrateJoystick*n?.distance/45),!l.useKeyboard&&Ge.includes(s.id)){let d=n?.vector?.x,m=n?.vector?.y;s.id.startsWith("mobystk:joystick_left")&&g.sendJoystickPos("JOYSTICK_1",d,m),s.id.startsWith("mobystk:joystick_right")&&g.sendJoystickPos("JOYSTICK_2",d,m)}if(!n?.direction){r("up",!1),r("left",!1),r("down",!1),r("right",!1);return}l.disJoyYAxis||r("up",n?.angle.degree>22.5&&n?.angle.degree<157.5),l.disJoyXAxis||r("left",n?.angle.degree>112.5&&n?.angle.degree<247.5),l.disJoyYAxis||r("down",n?.angle.degree>202.5&&n?.angle.degree<337.5),l.disJoyXAxis||r("right",n?.angle.degree>292.5||n?.angle.degree<67.5);function r(d,m){let{key:_,border:O}=pt(s.keys,d),A=s.element.querySelector(".back");if(A.style[`border${O}Width`]=m?"7px":"",!(!l.useKeyboard&&Ge.includes(s.id))){if(s.position[d]===m)return;g.sendKey(_,m?"press":"release")}s.position[d]=m}}function pt(s,o){let n={up:[s[0],"Top"],left:[s[1],"Left"],down:[s[2],"Bottom"],right:[s[3],"Right"]},[r,d]=n[o];return{key:r,border:d}}var We=720,Xe=400;function Ye(){let s;window.innerHeight>window.innerWidth/(We/Xe)?s=We:s=window.innerWidth/window.innerHeight*Xe,document.body.style.zoom=`${window.innerWidth/s}`,f.currentTouches=f.currentTouches.filter(n=>!n.joystick),f.elements.joysticks.forEach(n=>n.render())}window.addEventListener("load",Ye);window.addEventListener("resize",Ye);var j=class extends F{constructor(o){super(o),this.type="mobystk:group",this.content=o.content||[],this.parsedContent=o.parsedContent||[];let n=document.createElement("div");n.classList.add("controller-group"),n.dataset.id=this.id,n.instance=this,this.element=n;for(let r of this.parsedContent)n.appendChild(r.element),r.render()}toObject(){return{...super.toObject(),type:this.type,content:this.content}}};var ut=`
	<svg viewBox="0 0 32 32">
		<path d="M16 0a16 16 0 100 32 16 16 0 000-32zm0 4a12 12 0 0111.3 8H4.7c1.7-4.6 6-8 11.3-8zm0 14a2 2 0 110-4 2 2 0 010 4zM4 16c5.5 0 9.9 5.3 10 11.8A12 12 0 014 16zm14 11.8c.1-6.5 4.5-11.8 10-11.8a12 12 0 01-10 11.8z"></path>
	</svg>`;function be(){let s=f.elements.buttons.find(r=>r.customAction==="drive"),o=s?s._html=ut:"";s?.render(),s&&s.element.addEventListener("touchstart",n),!mt()&&s&&s.element&&(s.element.style.display="none");function n(){if(window.layoutEditor?.opened)return;s.active?d():r();function r(){s.press(),s.element.innerHTML='<i class="driveArrow mdi mdi-arrow-up"></i>';let m=0,_=0,O=[];window.ondevicemotion=A=>{let D=window.outerWidth>window.outerHeight,R=A.accelerationIncludingGravity[D?"x":"y"]>=0?1:-1;m=parseFloat(A.accelerationIncludingGravity[D?"y":"x"].toFixed(1)),m*=R*(D?1:-1);let G=s.element.children[0];if(l.useKeyboard){let w=ft(_,m,l.driveSensitivity,l.drivePrecision);if(w===_)return;G.style.transform=`rotate(${w}deg)`,_=w,E(l.vibrate*2);let S=ht(w),W=S.filter(C=>!O.includes(C)),V=O.filter(C=>!S.includes(C));for(let C of W)g.sendKey(C,"press");for(let C of V)g.sendKey(C,"release");O=[...S]}else{let w=Math.round(32767/l.driveSensitivity*m);w<10923*l.drivePrecision&&w>-10923*l.drivePrecision&&(w=0),w>32767&&(w=32767),w<-32767&&(w=-32767);let S=90*w/32767;G.style.transform=`rotate(${S}deg)`,g.sendJoystickPos("JOYSTICK_1",w)}}}function d(){s.release(),s.element.innerHTML=o,window.ondevicemotion=null,l.useKeyboard?(g.sendKey("JOYSTICK_1_UP","release"),g.sendKey("JOYSTICK_1_LEFT","release"),g.sendKey("JOYSTICK_1_RIGHT","release")):g.sendJoystickPos("JOYSTICK_1")}}}function mt(){return location.protocol==="https:"||location.hostname==="localhost"||location.hostname==="127.0.0.1"}function ft(s,o,n,r){let d=0;return s===-45?(o>n&&(d=45),o<-n+r&&(d=-45),o>n*2&&(d*=2),o<-n*2-r&&(d*=2)):s===45?(o>n-r&&(d=45),o<-n&&(d=-45),o>n*2+r&&(d*=2),o<-n*2&&(d*=2)):(o>n&&(d=45),o<-n&&(d=-45),o>n*2&&(d*=2),o<-n*2&&(d*=2)),d}function ht(s){let o;switch(s){case-90:o=["JOYSTICK_1_LEFT"];break;case-45:o=["JOYSTICK_1_UP","JOYSTICK_1_LEFT"];break;case 45:o=["JOYSTICK_1_UP","JOYSTICK_1_RIGHT"];break;case 90:o=["JOYSTICK_1_RIGHT"];break;default:o=["JOYSTICK_1_UP"]}return o}function yt(s){let o={...s,parsedContent:s.content.map(Ue).filter(r=>!!r)},n=qe(o);me.innerHTML="";for(let r of o.parsedContent)r&&(me.appendChild(r.element),r.render());return f.currentLayout=o,f.elements.all=n,f.elements.buttons=n.filter(r=>r instanceof I),f.elements.groups=n.filter(r=>r instanceof j),f.elements.joysticks=n.filter(r=>r instanceof M),ye(),be(),s}function qe(s,o=[]){if(s.type==="mobystk:layout"||s.type==="mobystk:group"){s=s,s.type!=="mobystk:layout"&&o.push(s);for(let n of s.parsedContent)qe(n,o)}else o.push(s);return o}function Ue(s){let o="import"in s?s.import:s.id;if(!l.hidden?.includes(o)&&("import"in s&&(s=gt(s)),!!s)){if(s.type==="mobystk:button")return s=s,l.locked?.includes(o)&&(s={...s,lockable:!0}),new I(s);if(s.type==="mobystk:group"){s=s,s.parsedContent=s.content.map(Ue).filter(r=>r);let n=new j(s);return s.parsedContent=s.parsedContent.map(r=>r.parent=n),n}else if(s.type==="mobystk:joystick")return s=s,new M(s)}}function gt(s){let n=[...f.buttons,...f.groups,...f.joysticks].find(r=>r.id===s.import);if(n)return{...n,...s}}if(!l.layout)throw window.location.href="index.html",new Error("Layout n\xE3o selecionado");var Re=f.layouts.find(s=>s.id===l.layout);if(!Re)throw alert("Layout n\xE3o encontrado!"),window.location.href="index.html",new Error("Layout n\xE3o encontrado");yt(Re);for(let s of f.elements.all)s instanceof I?(s.on("press",o=>g.sendKey(o,"press")),s.on("release",o=>g.sendKey(o,"release"))):s instanceof M&&s.on("move end",ve);document.addEventListener("contextmenu",s=>s.preventDefault());window.addEventListener("load",()=>{document.body.classList.remove("preload")});
