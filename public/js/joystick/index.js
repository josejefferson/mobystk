import{a as X,b as m}from"../chunk-VBAFV64Q.js";import{a as dt,b as c,c as Ot,d as z}from"../chunk-7XZ5U2TU.js";import{a as ae,b as le,e as Ct,f as It}from"../chunk-JKTMEYDY.js";var jt=ae((rt,ht)=>{(function(o,r){typeof rt=="object"&&typeof ht=="object"?ht.exports=r():typeof define=="function"&&define.amd?define("nipplejs",[],r):typeof rt=="object"?rt.nipplejs=r():o.nipplejs=r()})(window,function(){return function(o){var r={};function i(a){if(r[a])return r[a].exports;var d=r[a]={i:a,l:!1,exports:{}};return o[a].call(d.exports,d,d.exports,i),d.l=!0,d.exports}return i.m=o,i.c=r,i.d=function(a,d,y){i.o(a,d)||Object.defineProperty(a,d,{enumerable:!0,get:y})},i.r=function(a){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},i.t=function(a,d){if(1&d&&(a=i(a)),8&d||4&d&&typeof a=="object"&&a&&a.__esModule)return a;var y=Object.create(null);if(i.r(y),Object.defineProperty(y,"default",{enumerable:!0,value:a}),2&d&&typeof a!="string")for(var O in a)i.d(y,O,function(E){return a[E]}.bind(null,O));return y},i.n=function(a){var d=a&&a.__esModule?function(){return a.default}:function(){return a};return i.d(d,"a",d),d},i.o=function(a,d){return Object.prototype.hasOwnProperty.call(a,d)},i.p="",i(i.s=0)}([function(o,r,i){"use strict";i.r(r);var a,d=function(e,t){var n=t.x-e.x,s=t.y-e.y;return Math.sqrt(n*n+s*s)},y=function(e){return e*(Math.PI/180)},O=function(e){return e*(180/Math.PI)},E=new Map,$=function(e){E.has(e)&&clearTimeout(E.get(e)),E.set(e,setTimeout(e,100))},A=function(e,t,n){for(var s,l=t.split(/[ ,]+/g),p=0;p<l.length;p+=1)s=l[p],e.addEventListener?e.addEventListener(s,n,!1):e.attachEvent&&e.attachEvent(s,n)},V=function(e,t,n){for(var s,l=t.split(/[ ,]+/g),p=0;p<l.length;p+=1)s=l[p],e.removeEventListener?e.removeEventListener(s,n):e.detachEvent&&e.detachEvent(s,n)},q=function(e){return e.preventDefault(),e.type.match(/^touch/)?e.changedTouches:e},x=function(){return{x:window.pageXOffset!==void 0?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,y:window.pageYOffset!==void 0?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop}},T=function(e,t){t.top||t.right||t.bottom||t.left?(e.style.top=t.top,e.style.right=t.right,e.style.bottom=t.bottom,e.style.left=t.left):(e.style.left=t.x+"px",e.style.top=t.y+"px")},R=function(e,t,n){var s=K(e);for(var l in s)if(s.hasOwnProperty(l))if(typeof t=="string")s[l]=t+" "+n;else{for(var p="",f=0,u=t.length;f<u;f+=1)p+=t[f]+" "+n+", ";s[l]=p.slice(0,-2)}return s},K=function(e){var t={};return t[e]="",["webkit","Moz","o"].forEach(function(n){t[n+e.charAt(0).toUpperCase()+e.slice(1)]=""}),t},S=function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},st=function(e,t){if(e.length)for(var n=0,s=e.length;n<s;n+=1)t(e[n]);else t(e)},Qt="ontouchstart"in window,Zt=!!window.PointerEvent,Yt=!!window.MSPointerEvent,bt={start:"mousedown",move:"mousemove",end:"mouseup"},U={};function B(){}Zt?a={start:"pointerdown",move:"pointermove",end:"pointerup, pointercancel"}:Yt?a={start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}:Qt?(a={start:"touchstart",move:"touchmove",end:"touchend, touchcancel"},U=bt):a=bt,B.prototype.on=function(e,t){var n,s=e.split(/[ ,]+/g);this._handlers_=this._handlers_||{};for(var l=0;l<s.length;l+=1)n=s[l],this._handlers_[n]=this._handlers_[n]||[],this._handlers_[n].push(t);return this},B.prototype.off=function(e,t){return this._handlers_=this._handlers_||{},e===void 0?this._handlers_={}:t===void 0?this._handlers_[e]=null:this._handlers_[e]&&this._handlers_[e].indexOf(t)>=0&&this._handlers_[e].splice(this._handlers_[e].indexOf(t),1),this},B.prototype.trigger=function(e,t){var n,s=this,l=e.split(/[ ,]+/g);s._handlers_=s._handlers_||{};for(var p=0;p<l.length;p+=1)n=l[p],s._handlers_[n]&&s._handlers_[n].length&&s._handlers_[n].forEach(function(f){f.call(s,{type:n,target:s},t)})},B.prototype.config=function(e){this.options=this.defaults||{},e&&(this.options=function(t,n){var s={};for(var l in t)t.hasOwnProperty(l)&&n.hasOwnProperty(l)?s[l]=n[l]:t.hasOwnProperty(l)&&(s[l]=t[l]);return s}(this.options,e))},B.prototype.bindEvt=function(e,t){var n=this;return n._domHandlers_=n._domHandlers_||{},n._domHandlers_[t]=function(){typeof n["on"+t]=="function"?n["on"+t].apply(n,arguments):console.warn('[WARNING] : Missing "on'+t+'" handler.')},A(e,a[t],n._domHandlers_[t]),U[t]&&A(e,U[t],n._domHandlers_[t]),n},B.prototype.unbindEvt=function(e,t){return this._domHandlers_=this._domHandlers_||{},V(e,a[t],this._domHandlers_[t]),U[t]&&V(e,U[t],this._domHandlers_[t]),delete this._domHandlers_[t],this};var at=B;function b(e,t){return this.identifier=t.identifier,this.position=t.position,this.frontPosition=t.frontPosition,this.collection=e,this.defaults={size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:.5,mode:"dynamic",zone:document.body,lockX:!1,lockY:!1,shape:"circle"},this.config(t),this.options.mode==="dynamic"&&(this.options.restOpacity=0),this.id=b.id,b.id+=1,this.buildEl().stylize(),this.instance={el:this.ui.el,on:this.on.bind(this),off:this.off.bind(this),show:this.show.bind(this),hide:this.hide.bind(this),add:this.addToDom.bind(this),remove:this.removeFromDom.bind(this),destroy:this.destroy.bind(this),setPosition:this.setPosition.bind(this),resetDirection:this.resetDirection.bind(this),computeDirection:this.computeDirection.bind(this),trigger:this.trigger.bind(this),position:this.position,frontPosition:this.frontPosition,ui:this.ui,identifier:this.identifier,id:this.id,options:this.options},this.instance}b.prototype=new at,b.constructor=b,b.id=0,b.prototype.buildEl=function(e){return this.ui={},this.options.dataOnly?this:(this.ui.el=document.createElement("div"),this.ui.back=document.createElement("div"),this.ui.front=document.createElement("div"),this.ui.el.className="nipple collection_"+this.collection.id,this.ui.back.className="back",this.ui.front.className="front",this.ui.el.setAttribute("id","nipple_"+this.collection.id+"_"+this.id),this.ui.el.appendChild(this.ui.back),this.ui.el.appendChild(this.ui.front),this)},b.prototype.stylize=function(){if(this.options.dataOnly)return this;var e=this.options.fadeTime+"ms",t=function(l,p){var f=K(l);for(var u in f)f.hasOwnProperty(u)&&(f[u]=p);return f}("borderRadius","50%"),n=R("transition","opacity",e),s={};return s.el={position:"absolute",opacity:this.options.restOpacity,display:"block",zIndex:999},s.back={position:"absolute",display:"block",width:this.options.size+"px",height:this.options.size+"px",marginLeft:-this.options.size/2+"px",marginTop:-this.options.size/2+"px",background:this.options.color,opacity:".5"},s.front={width:this.options.size/2+"px",height:this.options.size/2+"px",position:"absolute",display:"block",marginLeft:-this.options.size/4+"px",marginTop:-this.options.size/4+"px",background:this.options.color,opacity:".5"},S(s.el,n),this.options.shape==="circle"&&S(s.back,t),S(s.front,t),this.applyStyles(s),this},b.prototype.applyStyles=function(e){for(var t in this.ui)if(this.ui.hasOwnProperty(t))for(var n in e[t])this.ui[t].style[n]=e[t][n];return this},b.prototype.addToDom=function(){return this.options.dataOnly||document.body.contains(this.ui.el)?this:(this.options.zone.appendChild(this.ui.el),this)},b.prototype.removeFromDom=function(){return this.options.dataOnly||!document.body.contains(this.ui.el)?this:(this.options.zone.removeChild(this.ui.el),this)},b.prototype.destroy=function(){clearTimeout(this.removeTimeout),clearTimeout(this.showTimeout),clearTimeout(this.restTimeout),this.trigger("destroyed",this.instance),this.removeFromDom(),this.off()},b.prototype.show=function(e){var t=this;return t.options.dataOnly||(clearTimeout(t.removeTimeout),clearTimeout(t.showTimeout),clearTimeout(t.restTimeout),t.addToDom(),t.restCallback(),setTimeout(function(){t.ui.el.style.opacity=1},0),t.showTimeout=setTimeout(function(){t.trigger("shown",t.instance),typeof e=="function"&&e.call(this)},t.options.fadeTime)),t},b.prototype.hide=function(e){var t=this;if(t.options.dataOnly)return t;if(t.ui.el.style.opacity=t.options.restOpacity,clearTimeout(t.removeTimeout),clearTimeout(t.showTimeout),clearTimeout(t.restTimeout),t.removeTimeout=setTimeout(function(){var l=t.options.mode==="dynamic"?"none":"block";t.ui.el.style.display=l,typeof e=="function"&&e.call(t),t.trigger("hidden",t.instance)},t.options.fadeTime),t.options.restJoystick){var n=t.options.restJoystick,s={};s.x=n===!0||n.x!==!1?0:t.instance.frontPosition.x,s.y=n===!0||n.y!==!1?0:t.instance.frontPosition.y,t.setPosition(e,s)}return t},b.prototype.setPosition=function(e,t){var n=this;n.frontPosition={x:t.x,y:t.y};var s=n.options.fadeTime+"ms",l={};l.front=R("transition",["top","left"],s);var p={front:{}};p.front={left:n.frontPosition.x+"px",top:n.frontPosition.y+"px"},n.applyStyles(l),n.applyStyles(p),n.restTimeout=setTimeout(function(){typeof e=="function"&&e.call(n),n.restCallback()},n.options.fadeTime)},b.prototype.restCallback=function(){var e={};e.front=R("transition","none",""),this.applyStyles(e),this.trigger("rested",this.instance)},b.prototype.resetDirection=function(){this.direction={x:!1,y:!1,angle:!1}},b.prototype.computeDirection=function(e){var t,n,s,l=e.angle.radian,p=Math.PI/4,f=Math.PI/2;if(l>p&&l<3*p&&!e.lockX?t="up":l>-p&&l<=p&&!e.lockY?t="left":l>3*-p&&l<=-p&&!e.lockX?t="down":e.lockY||(t="right"),e.lockY||(n=l>-f&&l<f?"left":"right"),e.lockX||(s=l>0?"up":"down"),e.force>this.options.threshold){var u,k={};for(u in this.direction)this.direction.hasOwnProperty(u)&&(k[u]=this.direction[u]);var h={};for(u in this.direction={x:n,y:s,angle:t},e.direction=this.direction,k)k[u]===this.direction[u]&&(h[u]=!0);if(h.x&&h.y&&h.angle)return e;h.x&&h.y||this.trigger("plain",e),h.x||this.trigger("plain:"+n,e),h.y||this.trigger("plain:"+s,e),h.angle||this.trigger("dir dir:"+t,e)}else this.resetDirection();return e};var te=b;function g(e,t){this.nipples=[],this.idles=[],this.actives=[],this.ids=[],this.pressureIntervals={},this.manager=e,this.id=g.id,g.id+=1,this.defaults={zone:document.body,multitouch:!1,maxNumberOfNipples:10,mode:"dynamic",position:{top:0,left:0},catchDistance:200,size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:.5,lockX:!1,lockY:!1,shape:"circle",dynamicPage:!1,follow:!1},this.config(t),this.options.mode!=="static"&&this.options.mode!=="semi"||(this.options.multitouch=!1),this.options.multitouch||(this.options.maxNumberOfNipples=1);var n=getComputedStyle(this.options.zone.parentElement);return n&&n.display==="flex"&&(this.parentIsFlex=!0),this.updateBox(),this.prepareNipples(),this.bindings(),this.begin(),this.nipples}g.prototype=new at,g.constructor=g,g.id=0,g.prototype.prepareNipples=function(){var e=this.nipples;e.on=this.on.bind(this),e.off=this.off.bind(this),e.options=this.options,e.destroy=this.destroy.bind(this),e.ids=this.ids,e.id=this.id,e.processOnMove=this.processOnMove.bind(this),e.processOnEnd=this.processOnEnd.bind(this),e.get=function(t){if(t===void 0)return e[0];for(var n=0,s=e.length;n<s;n+=1)if(e[n].identifier===t)return e[n];return!1}},g.prototype.bindings=function(){this.bindEvt(this.options.zone,"start"),this.options.zone.style.touchAction="none",this.options.zone.style.msTouchAction="none"},g.prototype.begin=function(){var e=this.options;if(e.mode==="static"){var t=this.createNipple(e.position,this.manager.getIdentifier());t.add(),this.idles.push(t)}},g.prototype.createNipple=function(e,t){var n=this.manager.scroll,s={},l=this.options,p=this.parentIsFlex?n.x:n.x+this.box.left,f=this.parentIsFlex?n.y:n.y+this.box.top;if(e.x&&e.y)s={x:e.x-p,y:e.y-f};else if(e.top||e.right||e.bottom||e.left){var u=document.createElement("DIV");u.style.display="hidden",u.style.top=e.top,u.style.right=e.right,u.style.bottom=e.bottom,u.style.left=e.left,u.style.position="absolute",l.zone.appendChild(u);var k=u.getBoundingClientRect();l.zone.removeChild(u),s=e,e={x:k.left+n.x,y:k.top+n.y}}var h=new te(this,{color:l.color,size:l.size,threshold:l.threshold,fadeTime:l.fadeTime,dataOnly:l.dataOnly,restJoystick:l.restJoystick,restOpacity:l.restOpacity,mode:l.mode,identifier:t,position:e,zone:l.zone,frontPosition:{x:0,y:0},shape:l.shape});return l.dataOnly||(T(h.ui.el,s),T(h.ui.front,h.frontPosition)),this.nipples.push(h),this.trigger("added "+h.identifier+":added",h),this.manager.trigger("added "+h.identifier+":added",h),this.bindNipple(h),h},g.prototype.updateBox=function(){this.box=this.options.zone.getBoundingClientRect()},g.prototype.bindNipple=function(e){var t,n=this,s=function(l,p){t=l.type+" "+p.id+":"+l.type,n.trigger(t,p)};e.on("destroyed",n.onDestroyed.bind(n)),e.on("shown hidden rested dir plain",s),e.on("dir:up dir:right dir:down dir:left",s),e.on("plain:up plain:right plain:down plain:left",s)},g.prototype.pressureFn=function(e,t,n){var s=this,l=0;clearInterval(s.pressureIntervals[n]),s.pressureIntervals[n]=setInterval(function(){var p=e.force||e.pressure||e.webkitForce||0;p!==l&&(t.trigger("pressure",p),s.trigger("pressure "+t.identifier+":pressure",p),l=p)}.bind(s),100)},g.prototype.onstart=function(e){var t=this,n=t.options,s=e;return e=q(e),t.updateBox(),st(e,function(l){t.actives.length<n.maxNumberOfNipples?t.processOnStart(l):s.type.match(/^touch/)&&(Object.keys(t.manager.ids).forEach(function(p){if(Object.values(s.touches).findIndex(function(u){return u.identifier===p})<0){var f=[e[0]];f.identifier=p,t.processOnEnd(f)}}),t.actives.length<n.maxNumberOfNipples&&t.processOnStart(l))}),t.manager.bindDocument(),!1},g.prototype.processOnStart=function(e){var t,n=this,s=n.options,l=n.manager.getIdentifier(e),p=e.force||e.pressure||e.webkitForce||0,f={x:e.pageX,y:e.pageY},u=n.getOrCreate(l,f);u.identifier!==l&&n.manager.removeIdentifier(u.identifier),u.identifier=l;var k=function(h){h.trigger("start",h),n.trigger("start "+h.id+":start",h),h.show(),p>0&&n.pressureFn(e,h,h.identifier),n.processOnMove(e)};if((t=n.idles.indexOf(u))>=0&&n.idles.splice(t,1),n.actives.push(u),n.ids.push(u.identifier),s.mode!=="semi")k(u);else{if(!(d(f,u.position)<=s.catchDistance))return u.destroy(),void n.processOnStart(e);k(u)}return u},g.prototype.getOrCreate=function(e,t){var n,s=this.options;return/(semi|static)/.test(s.mode)?(n=this.idles[0])?(this.idles.splice(0,1),n):s.mode==="semi"?this.createNipple(t,e):(console.warn("Coudln't find the needed nipple."),!1):n=this.createNipple(t,e)},g.prototype.processOnMove=function(e){var t=this.options,n=this.manager.getIdentifier(e),s=this.nipples.get(n),l=this.manager.scroll;if(function(j){return isNaN(j.buttons)?j.pressure!==0:j.buttons!==0}(e)){if(!s)return console.error("Found zombie joystick with ID "+n),void this.manager.removeIdentifier(n);if(t.dynamicPage){var p=s.el.getBoundingClientRect();s.position={x:l.x+p.left,y:l.y+p.top}}s.identifier=n;var f=s.options.size/2,u={x:e.pageX,y:e.pageY};t.lockX&&(u.y=s.position.y),t.lockY&&(u.x=s.position.x);var k,h,xt,kt,Q,N,lt,ct,Z,Y,H=d(u,s.position),G=(k=u,h=s.position,xt=h.x-k.x,kt=h.y-k.y,O(Math.atan2(kt,xt))),oe=y(G),ne=H/f,ie={distance:H,position:u};if(s.options.shape==="circle"?(Q=Math.min(H,f),lt=s.position,ct=Q,Y={x:0,y:0},Z=y(Z=G),Y.x=lt.x-ct*Math.cos(Z),Y.y=lt.y-ct*Math.sin(Z),N=Y):(N=function(j,et,ot){return{x:Math.min(Math.max(j.x,et.x-ot),et.x+ot),y:Math.min(Math.max(j.y,et.y-ot),et.y+ot)}}(u,s.position,f),Q=d(N,s.position)),t.follow){if(H>f){var re=u.x-N.x,se=u.y-N.y;s.position.x+=re,s.position.y+=se,s.el.style.top=s.position.y-(this.box.top+l.y)+"px",s.el.style.left=s.position.x-(this.box.left+l.x)+"px",H=d(u,s.position)}}else u=N,H=Q;var Lt=u.x-s.position.x,Et=u.y-s.position.y;s.frontPosition={x:Lt,y:Et},t.dataOnly||T(s.ui.front,s.frontPosition);var tt={identifier:s.identifier,position:u,force:ne,pressure:e.force||e.pressure||e.webkitForce||0,distance:H,angle:{radian:oe,degree:G},vector:{x:Lt/f,y:-Et/f},raw:ie,instance:s,lockX:t.lockX,lockY:t.lockY};(tt=s.computeDirection(tt)).angle={radian:y(180-G),degree:180-G},s.trigger("move",tt),this.trigger("move "+s.id+":move",tt)}else this.processOnEnd(e)},g.prototype.processOnEnd=function(e){var t=this,n=t.options,s=t.manager.getIdentifier(e),l=t.nipples.get(s),p=t.manager.removeIdentifier(l.identifier);l&&(n.dataOnly||l.hide(function(){n.mode==="dynamic"&&(l.trigger("removed",l),t.trigger("removed "+l.id+":removed",l),t.manager.trigger("removed "+l.id+":removed",l),l.destroy())}),clearInterval(t.pressureIntervals[l.identifier]),l.resetDirection(),l.trigger("end",l),t.trigger("end "+l.id+":end",l),t.ids.indexOf(l.identifier)>=0&&t.ids.splice(t.ids.indexOf(l.identifier),1),t.actives.indexOf(l)>=0&&t.actives.splice(t.actives.indexOf(l),1),/(semi|static)/.test(n.mode)?t.idles.push(l):t.nipples.indexOf(l)>=0&&t.nipples.splice(t.nipples.indexOf(l),1),t.manager.unbindDocument(),/(semi|static)/.test(n.mode)&&(t.manager.ids[p.id]=p.identifier))},g.prototype.onDestroyed=function(e,t){this.nipples.indexOf(t)>=0&&this.nipples.splice(this.nipples.indexOf(t),1),this.actives.indexOf(t)>=0&&this.actives.splice(this.actives.indexOf(t),1),this.idles.indexOf(t)>=0&&this.idles.splice(this.idles.indexOf(t),1),this.ids.indexOf(t.identifier)>=0&&this.ids.splice(this.ids.indexOf(t.identifier),1),this.manager.removeIdentifier(t.identifier),this.manager.unbindDocument()},g.prototype.destroy=function(){for(var e in this.unbindEvt(this.options.zone,"start"),this.nipples.forEach(function(t){t.destroy()}),this.pressureIntervals)this.pressureIntervals.hasOwnProperty(e)&&clearInterval(this.pressureIntervals[e]);this.trigger("destroyed",this.nipples),this.manager.unbindDocument(),this.off()};var ee=g;function w(e){var t=this;t.ids={},t.index=0,t.collections=[],t.scroll=x(),t.config(e),t.prepareCollections();var n=function(){var l;t.collections.forEach(function(p){p.forEach(function(f){l=f.el.getBoundingClientRect(),f.position={x:t.scroll.x+l.left,y:t.scroll.y+l.top}})})};A(window,"resize",function(){$(n)});var s=function(){t.scroll=x()};return A(window,"scroll",function(){$(s)}),t.collections}w.prototype=new at,w.constructor=w,w.prototype.prepareCollections=function(){var e=this;e.collections.create=e.create.bind(e),e.collections.on=e.on.bind(e),e.collections.off=e.off.bind(e),e.collections.destroy=e.destroy.bind(e),e.collections.get=function(t){var n;return e.collections.every(function(s){return!(n=s.get(t))}),n}},w.prototype.create=function(e){return this.createCollection(e)},w.prototype.createCollection=function(e){var t=new ee(this,e);return this.bindCollection(t),this.collections.push(t),t},w.prototype.bindCollection=function(e){var t,n=this,s=function(l,p){t=l.type+" "+p.id+":"+l.type,n.trigger(t,p)};e.on("destroyed",n.onDestroyed.bind(n)),e.on("shown hidden rested dir plain",s),e.on("dir:up dir:right dir:down dir:left",s),e.on("plain:up plain:right plain:down plain:left",s)},w.prototype.bindDocument=function(){this.binded||(this.bindEvt(document,"move").bindEvt(document,"end"),this.binded=!0)},w.prototype.unbindDocument=function(e){Object.keys(this.ids).length&&e!==!0||(this.unbindEvt(document,"move").unbindEvt(document,"end"),this.binded=!1)},w.prototype.getIdentifier=function(e){var t;return e?(t=e.identifier===void 0?e.pointerId:e.identifier)===void 0&&(t=this.latest||0):t=this.index,this.ids[t]===void 0&&(this.ids[t]=this.index,this.index+=1),this.latest=t,this.ids[t]},w.prototype.removeIdentifier=function(e){var t={};for(var n in this.ids)if(this.ids[n]===e){t.id=n,t.identifier=this.ids[n],delete this.ids[n];break}return t},w.prototype.onmove=function(e){return this.onAny("move",e),!1},w.prototype.onend=function(e){return this.onAny("end",e),!1},w.prototype.oncancel=function(e){return this.onAny("end",e),!1},w.prototype.onAny=function(e,t){var n,s=this,l="processOn"+e.charAt(0).toUpperCase()+e.slice(1);return t=q(t),st(t,function(p){n=s.getIdentifier(p),st(s.collections,function(f,u,k){k.ids.indexOf(u)>=0&&(k[l](f),f._found_=!0)}.bind(null,p,n)),p._found_||s.removeIdentifier(n)}),!1},w.prototype.destroy=function(){this.unbindDocument(!0),this.ids={},this.index=0,this.collections.forEach(function(e){e.destroy()}),this.off()},w.prototype.onDestroyed=function(e,t){if(this.collections.indexOf(t)<0)return!1;this.collections.splice(this.collections.indexOf(t),1)};var wt=new w;r.default={create:function(e){return wt.create(e)},factory:wt}}]).default})});var Mt=Date.now();function L(o,r=!1){let i;return Array.isArray(o)?i=o.reduce((a,d)=>a+=Number(d),0):i=Number(o),r?(Mt=Date.now()+i,navigator.vibrate(o)):Date.now()+i>Mt?navigator.vibrate(o):!1}var C=!1,M=!1,D=[];function _t(){window.layoutEditor?.opened||(v("load"),v("load",!0),L(c.vibrate*3))}function Tt(){window.layoutEditor?.opened||(v("save"),v("save",!0),L(c.vibrate*3))}function Dt(){window.layoutEditor?.opened||M||(this.instance&&this.instance[this.instance.active?"release":"press"](),C||(D=[]),C=!C,window.recordingMacro=C,window.lastMacro=D)}async function At(){if(!window.layoutEditor?.opened&&!C){M=!M,window.playingMacro=M,this.instance&&this.instance.press();for(let o of D){if(!M||z?.readyState!==1)break;z?.send(o),await new Promise(r=>setTimeout(r,50))}this.instance&&this.instance.release(),M=!1,window.playingMacro=M}}function zt(){document.documentElement.requestFullscreen()}function pt(){let o=m.elements.buttons.find(d=>d.customAction==="load-state");o&&o.element.addEventListener(c.dblClickLoadSave?"dblclick":"click",_t);let r=m.elements.buttons.find(d=>d.customAction==="save-state");r&&r.element.addEventListener(c.dblClickLoadSave?"dblclick":"click",Tt),C=!1,M=!1,D=[],window.recordingMacro=C,window.playingMacro=M,window.lastMacro=D;let i=m.elements.buttons.find(d=>d.customAction==="macro-record");i&&i.element.addEventListener("click",Dt);let a=m.elements.buttons.find(d=>d.customAction==="macro-play");a&&a.element.addEventListener("click",At),document.querySelector(".deviceInfo").addEventListener("dblclick",zt)}window.playingMacro=M;window.recordingMacro=C;window.lastMacro=D;window.loadState=_t;window.saveState=Tt;window.recordMacro=Dt;window.playMacro=At;window.fullScreen=zt;var W=document.documentElement,ut=document.querySelector(".edit"),nt=document.querySelector(".backgroundImage"),P=document.querySelector(".deviceInfo"),Pt=P.querySelector(".battery"),J=Pt.querySelector(".battery-icon"),$t=Pt.querySelector(".battery-level"),St=P.querySelector(".clock"),ft=P.querySelector(".player .player-number"),Bt=P.querySelector(".layout"),Ie=P.querySelector(".status"),Ht=document.querySelector(".ping"),it=document.querySelector(".controller-indicator"),mt=document.querySelector(".controller-layout"),Jt=document.querySelector('meta[name="viewport"]');var Nt=c.vgamepad?"mdi-google-controller":"mdi-keyboard";it.classList.add(Nt);Ot.V=o=>{let[r]=o.toLowerCase().split(" ");if(c.vibrationFromGame){let i=parseInt(r.split("|")[0]);L(i?3e3:0,!0),it.classList[i?"remove":"add"](Nt),it.classList[i?"add":"remove"]("mdi-vibrate")}};function ce(o,r=!1,i){if(!(!o||!o.length)){if(typeof o=="string"&&(o=[o]),i||(o=o.map(a=>c.vgamepad?dt[a]?.[4]:dt[a]?.[c.player])),C&&i)return D.push(`${i} ${o} ${c.player}`);if(C)return D.push(`${r?"R":"P"} ${o} ${c.player}`);!z||z.readyState!==1||(i?z.send(`${i} ${o} ${c.player}`):z.send(`${r?"R":"P"} ${o} ${c.player}`))}}window.sendCmd=ce;var v=(...o)=>window.sendCmd(...o);var I=class extends X{constructor(r){super(r),this.type="mobystk:button",this.content=r.content||{type:"mobystk:text",value:""},this.key=r.key||"",this.customAction=r.customAction||!1,this.lockable=r.lockable||!1,this.diagonal=r.diagonal||!1,this.diagonal&&(this.targets=r.targets||[]),this.scalable=r.scalable||!1,this.border=r.border||[!0,!0,!0,!0],this.radius=r.radius||[[0,"px"],[0,"px"],[0,"px"],[0,"px"]],this.fontSize=r.fontSize||[20,"px"],this.active=!1,this.editing=!1;let i=document.createElement("button");i.classList.add("controller-button"),i.dataset.id=this.id,i.instance=this,this.element=i}press(r=!1){if(this.diagonal){let i=m.elements.buttons.filter(a=>this.targets.includes(a.id)&&!a.lockable);for(let a of i)a.press(!0)}else!this.active&&!this.customAction&&this.emit("press",this.key),this.scalable&&!this.active&&!r?this.element?.classList.add("controller-button-scale"):!this.active&&r&&(this.element?.classList.add("controller-button-active-diagonal"),this.element?.classList.add("controller-button-scale-diagonal")),this.active=!0,this.element?.classList.add("controller-button-active")}release(){if(this.diagonal){let r=m.elements.buttons.filter(i=>this.targets.includes(i.id));for(let i of r)i.release()}else this.active&&!this.customAction&&this.emit("release",this.key),this.active=!1,this.element?.classList.remove("controller-button-active"),this.element?.classList.remove("controller-button-scale"),this.element?.classList.remove("controller-button-active-diagonal"),this.element?.classList.remove("controller-button-scale-diagonal")}render(){super.render();let r=this.element;if(!r)return;this.border[0]||(r.style.borderTop="0"),this.border[1]||(r.style.borderRight="0"),this.border[2]||(r.style.borderBottom="0"),this.border[3]||(r.style.borderLeft="0");let i=this.radius.map(a=>a.join("")).join(" ");if(r.style.borderRadius=i,r.style.fontSize=this.fontSize.join(""),r.classList[this.diagonal?"add":"remove"]("controller-button-diagonal"),r.classList[this.lockable?"add":"remove"]("controller-button-lockable"),r.innerHTML="",this.content.type==="mobystk:text")r.innerText=this.content.value;else if(this.content.type==="mobystk:icon"){let a=document.createElement("i");a.classList.add("mdi","mdi-"+this.content.value),r.appendChild(a)}this._html&&(r.innerHTML=this._html),r.classList[this.customAction?"add":"remove"]("controller-custom-action"),r.dataset.action=this.customAction||void 0}toObject(){return{...super.toObject(),type:this.type,key:this.key,border:this.border,fontSize:this.fontSize,content:this.content,radius:this.radius,lockable:this.lockable,scalable:this.scalable,customAction:this.customAction,diagonal:this.diagonal,targets:this.targets}}};var Xt=le(jt(),1);var _=class extends X{constructor(r){super(r),this.type="mobystk:joystick",this.size=r.size||[90,"px"],this.padding=r.padding||60,this.keys=r.keys||["joyLUp","joyLLeft","joyLDown","joyLRight"],this.position={up:!1,down:!1,left:!1,right:!1};let i=document.createElement("div");i.classList.add("controller-joystick"),i.dataset.id=this.id,i.instance=this,this.element=i}render(){this.width=[this.size[0]+this.padding,this.size[1]],this.height=[this.size[0]+this.padding,this.size[1]],super.render();let r=this.element;this.position={up:!1,down:!1,left:!1,right:!1},this.nipple&&this.nipple.destroy(),this.nipple=Xt.default.create({zone:r,size:this.size[0],mode:"static",position:{left:"50%",top:"50%"},lockX:c.disJoyYAxis,lockY:c.disJoyXAxis}),this.nipple.on("move",(i,a)=>this.emit("move",this,i,a)),this.nipple.on("end",(i,a)=>this.emit("end",this,i,a))}toObject(){return{...super.toObject(),type:this.type,size:this.size,padding:this.padding,keys:this.keys}}};document.addEventListener("touchstart",de);document.addEventListener("touchmove",pe);document.addEventListener("touchend",Ft);document.addEventListener("touchcancel",Ft);function de(o){if(!window.layoutEditor?.opened)for(let r of Array.from(o.changedTouches)){let i=document.elementFromPoint(r.clientX,r.clientY);for(;i!==null&&!(i.instance instanceof I&&!i.instance.customAction||i.instance instanceof _);)i=i.parentElement;if(i?.instance.lockable){L(c.vibrate),i.instance.active?i.instance.release():i.instance.press();continue}let a=i?.instance instanceof _;m.currentTouches.push({target:i,touch:r,joystick:a}),i&&(L(c.vibrate),!a&&i.instance.press())}}function pe(o){if(!window.layoutEditor?.opened)for(let r of Array.from(o.changedTouches)){let i=m.currentTouches.findIndex(y=>y.touch.identifier===r.identifier);if(i<0)continue;let a=m.currentTouches[i];if(a.joystick||!c.changeKeyOnDrag&&a.target)continue;a.touch=r;let d=document.elementFromPoint(r.clientX,r.clientY);for(;d!==null&&!(d.instance instanceof I&&!d.instance.customAction&&!d.instance.lockable);)d=d.parentElement;a.target!==d&&(a.target?.instance.release(),(!d||d.instance?.active)&&(d=null),a.target=d,d&&(d.instance.press(),L(c.vibrate)))}}function Ft(o){if(!window.layoutEditor?.opened)for(let r of Array.from(o.changedTouches)){let i=m.currentTouches.findIndex(a=>a.touch.identifier===r.identifier);i<0||(m.currentTouches[i].target?.instance instanceof I&&m.currentTouches[i].target.instance.release(),m.currentTouches.splice(i,1))}}var qt=["mobystk:joystick_left","mobystk:joystick_right"];function yt(o,r,i){if(L(c.vibrateJoystick*i?.distance/45),c.vgamepad&&qt.includes(o.id)){let d=Math.round(-32768+728.1555555555556*(45+i?.distance*Math.cos(i?.angle?.radian))),y=Math.round(-32768+65534/90*(45+i?.distance*Math.sin(i?.angle?.radian)));(isNaN(d)||isNaN(y))&&(d=y=0),o.id==="mobystk:joystick_left"&&v(`${d}|${y}`,!1,"VJL"),o.id==="mobystk:joystick_right"&&v(`${d}|${y}`,!1,"VJR")}if(!i?.direction){a("up",!1),a("left",!1),a("down",!1),a("right",!1);return}c.disJoyYAxis||a("up",i?.angle.degree>22.5&&i?.angle.degree<157.5),c.disJoyXAxis||a("left",i?.angle.degree>112.5&&i?.angle.degree<247.5),c.disJoyYAxis||a("down",i?.angle.degree>202.5&&i?.angle.degree<337.5),c.disJoyXAxis||a("right",i?.angle.degree>292.5||i?.angle.degree<67.5);function a(d,y){let{key:O,border:E}=ue(o.keys,d),$=o.element.querySelector(".back");if($.style[`border${E}Width`]=y?"7px":"",!(c.vgamepad&&qt.includes(o.id))){if(o.position[d]===y)return;v([O],!y)}o.position[d]=y}}function ue(o,r){let i={up:[o[0],"Top"],left:[o[1],"Left"],down:[o[2],"Bottom"],right:[o[3],"Right"]},[a,d]=i[r];return{key:a,border:d}}function Rt(){let o;window.outerHeight>window.outerWidth/1.7777777777777777?o=640:o=window.outerWidth/window.outerHeight*360,Jt.setAttribute("content",`width=${o}, user-scalable=0`),m.currentTouches=m.currentTouches.filter(i=>!i.joystick),m.elements.joysticks.forEach(i=>i.render())}window.addEventListener("load",Rt);window.addEventListener("resize",Rt);var F=class extends X{constructor(r){super(r),this.type="mobystk:group",this.content=r.content||[],this.parsedContent=r.parsedContent||[];let i=document.createElement("div");i.classList.add("controller-group"),i.dataset.id=this.id,i.instance=this,this.element=i;for(let a of this.parsedContent)i.appendChild(a.element),a.render()}toObject(){return{...super.toObject(),type:this.type,content:this.content}}};var fe=`
	<svg viewBox="0 0 32 32">
		<path d="M16 0a16 16 0 100 32 16 16 0 000-32zm0 4a12 12 0 0111.3 8H4.7c1.7-4.6 6-8 11.3-8zm0 14a2 2 0 110-4 2 2 0 010 4zM4 16c5.5 0 9.9 5.3 10 11.8A12 12 0 014 16zm14 11.8c.1-6.5 4.5-11.8 10-11.8a12 12 0 01-10 11.8z"></path>
	</svg>`;function gt(){let o=m.elements.buttons.find(a=>a.customAction==="drive"),r=o?o._html=fe:"";o?.render(),o&&o.element.addEventListener("touchstart",i),!me()&&o&&o.element&&(o.element.style.display="none");function i(){if(window.layoutEditor?.opened)return;o.active?d():a();function a(){o.press(),o.element.innerHTML='<i class="driveArrow mdi mdi-arrow-up"></i>';let y=0,O=0,E=[];window.ondevicemotion=$=>{let A=window.outerWidth>window.outerHeight,V=$.accelerationIncludingGravity[A?"x":"y"]>=0?1:-1;y=parseFloat($.accelerationIncludingGravity[A?"y":"x"].toFixed(1)),y*=V*(A?1:-1);let q=o.element.children[0];if(c.vgamepad){let x=Math.round(32767/c.driveSensitivity*y);x<10923*c.drivePrecision&&x>-10923*c.drivePrecision&&(x=0),x>32767&&(x=32767),x<-32767&&(x=-32767);let T=90*x/32767;q.style.transform=`rotate(${T}deg)`,v(`${x}|0`,!1,"VJL")}else{let x=he(O,y,c.driveSensitivity,c.drivePrecision);if(x===O)return;q.style.transform=`rotate(${x}deg)`,O=x,L(c.vibrate*2);let T=ye(x),R=T.filter(S=>!E.includes(S)),K=E.filter(S=>!T.includes(S));v(R),v(K,!0),E=[...T]}}}function d(){o.release(),o.element.innerHTML=r,window.ondevicemotion=null,c.vgamepad?v("0|0",!1,"VJL"):(v("joyLUp",!0),v("joyLLeft",!0),v("joyLRight",!0))}}}function me(){return location.protocol==="https:"||location.hostname==="localhost"||location.hostname==="127.0.0.1"}function he(o,r,i,a){let d=0;return o===-45?(r>i&&(d=45),r<-i+a&&(d=-45),r>i*2&&(d*=2),r<-i*2-a&&(d*=2)):o===45?(r>i-a&&(d=45),r<-i&&(d=-45),r>i*2+a&&(d*=2),r<-i*2&&(d*=2)):(r>i&&(d=45),r<-i&&(d=-45),r>i*2&&(d*=2),r<-i*2&&(d*=2)),d}function ye(o){let r;switch(o){case-90:r=["joyLLeft"];break;case-45:r=["joyLUp","joyLLeft"];break;case 45:r=["joyLUp","joyLRight"];break;case 90:r=["joyLRight"];break;default:r=["joyLUp"]}return r}function ge(o){let r={...o,parsedContent:o.content.map(Gt).filter(a=>!!a)},i=Ut(r);mt.innerHTML="";for(let a of r.parsedContent)a&&(mt.appendChild(a.element),a.render());return m.currentLayout=r,m.elements.all=i,m.elements.buttons=i.filter(a=>a instanceof I),m.elements.groups=i.filter(a=>a instanceof F),m.elements.joysticks=i.filter(a=>a instanceof _),Bt.innerText=o.name||"???",pt(),gt(),o}function Ut(o,r=[]){if(o.type==="mobystk:layout"||o.type==="mobystk:group"){o=o,o.type!=="mobystk:layout"&&r.push(o);for(let i of o.parsedContent)Ut(i,r)}else r.push(o);return r}function Gt(o){let r="import"in o?o.import:o.id;if(!c.hidden?.includes(r)&&("import"in o&&(o=ve(o)),!!o)){if(o.type==="mobystk:button")return o=o,c.locked?.includes(r)&&(o={...o,lockable:!0}),new I(o);if(o.type==="mobystk:group"){o=o,o.parsedContent=o.content.map(Gt).filter(a=>a);let i=new F(o);return o.parsedContent=o.parsedContent.map(a=>a.parent=i),i}else if(o.type==="mobystk:joystick")return o=o,new _(o)}}function ve(o){let i=[...m.buttons,...m.groups,...m.joysticks].find(a=>a.id===o.import);if(i)return{...i,...o}}if(!c.layout)throw window.location.href="index.html",new Error("Layout n\xE3o selecionado");var Wt=m.layouts.find(o=>o.id===c.layout);if(!Wt)throw alert("Layout n\xE3o encontrado!"),window.location.href="index.html",new Error("Layout n\xE3o encontrado");ge(Wt);for(let o of m.elements.all)o instanceof I?(o.on("press",r=>v(r,!1)),o.on("release",r=>v(r,!0))):o instanceof _&&o.on("move end",yt);c.hidden.includes("mobystk:deviceInfo")&&P.classList.add("hidden");c.hidden.includes("mobystk:ping")&&Ht.classList.add("hidden");ut.addEventListener("click",Ct);ut.addEventListener("contextmenu",()=>{window.layoutEditor.opened?window.layoutEditor.end():window.layoutEditor.start()});c.layout||(location.href="index.html");c.debug&&document.body.classList.add("debug");c.invertL&&document.body.classList.add("invertL");c.invertR&&document.body.classList.add("invertR");c.bgImage&&(nt.style.backgroundImage=`url('${c.bgImage}')`);c.bgOpacity&&(nt.style.opacity=String(c.bgOpacity));c.bgBlur&&(nt.style.filter=`blur(${c.bgBlur}px)`);c.colorsBackground&&W.style.setProperty("--background",c.colorsBackground);c.colorsColor&&W.style.setProperty("--color",c.colorsColor);c.colorsBorder&&W.style.setProperty("--border",c.colorsBorder);c.colorsActive&&W.style.setProperty("--active",c.colorsActive);var Vt=document.createElement("style");Vt.textContent=c.customCSS;document.body.append(Vt);if(c.customJS&&c.customJS.trim()&&confirm("Deseja executar os plugins?"))try{new Function(c.customJS.trim())()}catch(o){alert(`Ocorreu um erro ao executar os plugins

`+(o?.message||""))}if(c.pluginMobile){let o=document.createElement("script");o.src="lib/plugins/mobile.js",o.onerror=()=>It("Erro ao carregar plugin MobyStk Mobile"),document.body.appendChild(o)}navigator.getBattery?.()?.then(o=>{vt(o),o.addEventListener("chargingchange",r=>vt(r.target)),o.addEventListener("levelchange",r=>vt(r.target))}).catch(console.error);function vt(o){J.classList.remove(...Array.from(J.classList)),J.classList.add("mdi");let r=o.charging,i=o.level*100,a=Math.round(i/10)*10;$t.innerText=Math.round(i)+"% \u2022",a===0?J.classList.add("mdi-battery-outline"):a===100?J.classList.add("mdi-battery"+(r?"-charging-100":"")):J.classList.add("mdi-battery-"+(r?"charging-":"")+a)}window.setInterval(Kt,1e3);Kt();function Kt(){let o=new Date().getHours().toString().padStart(2,"0"),r=new Date().getMinutes().toString().padStart(2,"0");St.innerText=o+":"+r}ft.innerText=String(c.player+1);c.debug&&P.addEventListener("click",()=>{c.player+=1,c.player>3&&(c.player=0),ft.innerText=String(c.player+1)});document.addEventListener("contextmenu",o=>o.preventDefault());window.addEventListener("load",()=>{document.body.classList.remove("preload")});
