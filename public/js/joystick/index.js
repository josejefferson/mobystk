import{a as h}from"../chunk-7ERYJHCL.js";import{a as pt,b as d,c as _t,d as P}from"../chunk-Q67UKZSZ.js";import{a as ce,b as le,e as It,f as Ot}from"../chunk-HRGUCOSM.js";var Xt=ce((st,yt)=>{(function(o,n){typeof st=="object"&&typeof yt=="object"?yt.exports=n():typeof define=="function"&&define.amd?define("nipplejs",[],n):typeof st=="object"?st.nipplejs=n():o.nipplejs=n()})(window,function(){return function(o){var n={};function i(s){if(n[s])return n[s].exports;var l=n[s]={i:s,l:!1,exports:{}};return o[s].call(l.exports,l,l.exports,i),l.l=!0,l.exports}return i.m=o,i.c=n,i.d=function(s,l,y){i.o(s,l)||Object.defineProperty(s,l,{enumerable:!0,get:y})},i.r=function(s){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(s,"__esModule",{value:!0})},i.t=function(s,l){if(1&l&&(s=i(s)),8&l||4&l&&typeof s=="object"&&s&&s.__esModule)return s;var y=Object.create(null);if(i.r(y),Object.defineProperty(y,"default",{enumerable:!0,value:s}),2&l&&typeof s!="string")for(var O in s)i.d(y,O,function(E){return s[E]}.bind(null,O));return y},i.n=function(s){var l=s&&s.__esModule?function(){return s.default}:function(){return s};return i.d(l,"a",l),l},i.o=function(s,l){return Object.prototype.hasOwnProperty.call(s,l)},i.p="",i(i.s=0)}([function(o,n,i){"use strict";i.r(n);var s,l=function(e,t){var r=t.x-e.x,a=t.y-e.y;return Math.sqrt(r*r+a*a)},y=function(e){return e*(Math.PI/180)},O=function(e){return e*(180/Math.PI)},E=new Map,S=function(e){E.has(e)&&clearTimeout(E.get(e)),E.set(e,setTimeout(e,100))},z=function(e,t,r){for(var a,c=t.split(/[ ,]+/g),p=0;p<c.length;p+=1)a=c[p],e.addEventListener?e.addEventListener(a,r,!1):e.attachEvent&&e.attachEvent(a,r)},Y=function(e,t,r){for(var a,c=t.split(/[ ,]+/g),p=0;p<c.length;p+=1)a=c[p],e.removeEventListener?e.removeEventListener(a,r):e.detachEvent&&e.detachEvent(a,r)},F=function(e){return e.preventDefault(),e.type.match(/^touch/)?e.changedTouches:e},w=function(){return{x:window.pageXOffset!==void 0?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,y:window.pageYOffset!==void 0?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop}},T=function(e,t){t.top||t.right||t.bottom||t.left?(e.style.top=t.top,e.style.right=t.right,e.style.bottom=t.bottom,e.style.left=t.left):(e.style.left=t.x+"px",e.style.top=t.y+"px")},G=function(e,t,r){var a=K(e);for(var c in a)if(a.hasOwnProperty(c))if(typeof t=="string")a[c]=t+" "+r;else{for(var p="",m=0,u=t.length;m<u;m+=1)p+=t[m]+" "+r+", ";a[c]=p.slice(0,-2)}return a},K=function(e){var t={};return t[e]="",["webkit","Moz","o"].forEach(function(r){t[r+e.charAt(0).toUpperCase()+e.slice(1)]=""}),t},B=function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e},at=function(e,t){if(e.length)for(var r=0,a=e.length;r<a;r+=1)t(e[r]);else t(e)},Qt="ontouchstart"in window,Zt=!!window.PointerEvent,te=!!window.MSPointerEvent,xt={start:"mousedown",move:"mousemove",end:"mouseup"},q={};function j(){}Zt?s={start:"pointerdown",move:"pointermove",end:"pointerup, pointercancel"}:te?s={start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}:Qt?(s={start:"touchstart",move:"touchmove",end:"touchend, touchcancel"},q=xt):s=xt,j.prototype.on=function(e,t){var r,a=e.split(/[ ,]+/g);this._handlers_=this._handlers_||{};for(var c=0;c<a.length;c+=1)r=a[c],this._handlers_[r]=this._handlers_[r]||[],this._handlers_[r].push(t);return this},j.prototype.off=function(e,t){return this._handlers_=this._handlers_||{},e===void 0?this._handlers_={}:t===void 0?this._handlers_[e]=null:this._handlers_[e]&&this._handlers_[e].indexOf(t)>=0&&this._handlers_[e].splice(this._handlers_[e].indexOf(t),1),this},j.prototype.trigger=function(e,t){var r,a=this,c=e.split(/[ ,]+/g);a._handlers_=a._handlers_||{};for(var p=0;p<c.length;p+=1)r=c[p],a._handlers_[r]&&a._handlers_[r].length&&a._handlers_[r].forEach(function(m){m.call(a,{type:r,target:a},t)})},j.prototype.config=function(e){this.options=this.defaults||{},e&&(this.options=function(t,r){var a={};for(var c in t)t.hasOwnProperty(c)&&r.hasOwnProperty(c)?a[c]=r[c]:t.hasOwnProperty(c)&&(a[c]=t[c]);return a}(this.options,e))},j.prototype.bindEvt=function(e,t){var r=this;return r._domHandlers_=r._domHandlers_||{},r._domHandlers_[t]=function(){typeof r["on"+t]=="function"?r["on"+t].apply(r,arguments):console.warn('[WARNING] : Missing "on'+t+'" handler.')},z(e,s[t],r._domHandlers_[t]),q[t]&&z(e,q[t],r._domHandlers_[t]),r},j.prototype.unbindEvt=function(e,t){return this._domHandlers_=this._domHandlers_||{},Y(e,s[t],this._domHandlers_[t]),q[t]&&Y(e,q[t],this._domHandlers_[t]),delete this._domHandlers_[t],this};var ct=j;function b(e,t){return this.identifier=t.identifier,this.position=t.position,this.frontPosition=t.frontPosition,this.collection=e,this.defaults={size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:.5,mode:"dynamic",zone:document.body,lockX:!1,lockY:!1,shape:"circle"},this.config(t),this.options.mode==="dynamic"&&(this.options.restOpacity=0),this.id=b.id,b.id+=1,this.buildEl().stylize(),this.instance={el:this.ui.el,on:this.on.bind(this),off:this.off.bind(this),show:this.show.bind(this),hide:this.hide.bind(this),add:this.addToDom.bind(this),remove:this.removeFromDom.bind(this),destroy:this.destroy.bind(this),setPosition:this.setPosition.bind(this),resetDirection:this.resetDirection.bind(this),computeDirection:this.computeDirection.bind(this),trigger:this.trigger.bind(this),position:this.position,frontPosition:this.frontPosition,ui:this.ui,identifier:this.identifier,id:this.id,options:this.options},this.instance}b.prototype=new ct,b.constructor=b,b.id=0,b.prototype.buildEl=function(e){return this.ui={},this.options.dataOnly?this:(this.ui.el=document.createElement("div"),this.ui.back=document.createElement("div"),this.ui.front=document.createElement("div"),this.ui.el.className="nipple collection_"+this.collection.id,this.ui.back.className="back",this.ui.front.className="front",this.ui.el.setAttribute("id","nipple_"+this.collection.id+"_"+this.id),this.ui.el.appendChild(this.ui.back),this.ui.el.appendChild(this.ui.front),this)},b.prototype.stylize=function(){if(this.options.dataOnly)return this;var e=this.options.fadeTime+"ms",t=function(c,p){var m=K(c);for(var u in m)m.hasOwnProperty(u)&&(m[u]=p);return m}("borderRadius","50%"),r=G("transition","opacity",e),a={};return a.el={position:"absolute",opacity:this.options.restOpacity,display:"block",zIndex:999},a.back={position:"absolute",display:"block",width:this.options.size+"px",height:this.options.size+"px",marginLeft:-this.options.size/2+"px",marginTop:-this.options.size/2+"px",background:this.options.color,opacity:".5"},a.front={width:this.options.size/2+"px",height:this.options.size/2+"px",position:"absolute",display:"block",marginLeft:-this.options.size/4+"px",marginTop:-this.options.size/4+"px",background:this.options.color,opacity:".5"},B(a.el,r),this.options.shape==="circle"&&B(a.back,t),B(a.front,t),this.applyStyles(a),this},b.prototype.applyStyles=function(e){for(var t in this.ui)if(this.ui.hasOwnProperty(t))for(var r in e[t])this.ui[t].style[r]=e[t][r];return this},b.prototype.addToDom=function(){return this.options.dataOnly||document.body.contains(this.ui.el)?this:(this.options.zone.appendChild(this.ui.el),this)},b.prototype.removeFromDom=function(){return this.options.dataOnly||!document.body.contains(this.ui.el)?this:(this.options.zone.removeChild(this.ui.el),this)},b.prototype.destroy=function(){clearTimeout(this.removeTimeout),clearTimeout(this.showTimeout),clearTimeout(this.restTimeout),this.trigger("destroyed",this.instance),this.removeFromDom(),this.off()},b.prototype.show=function(e){var t=this;return t.options.dataOnly||(clearTimeout(t.removeTimeout),clearTimeout(t.showTimeout),clearTimeout(t.restTimeout),t.addToDom(),t.restCallback(),setTimeout(function(){t.ui.el.style.opacity=1},0),t.showTimeout=setTimeout(function(){t.trigger("shown",t.instance),typeof e=="function"&&e.call(this)},t.options.fadeTime)),t},b.prototype.hide=function(e){var t=this;if(t.options.dataOnly)return t;if(t.ui.el.style.opacity=t.options.restOpacity,clearTimeout(t.removeTimeout),clearTimeout(t.showTimeout),clearTimeout(t.restTimeout),t.removeTimeout=setTimeout(function(){var c=t.options.mode==="dynamic"?"none":"block";t.ui.el.style.display=c,typeof e=="function"&&e.call(t),t.trigger("hidden",t.instance)},t.options.fadeTime),t.options.restJoystick){var r=t.options.restJoystick,a={};a.x=r===!0||r.x!==!1?0:t.instance.frontPosition.x,a.y=r===!0||r.y!==!1?0:t.instance.frontPosition.y,t.setPosition(e,a)}return t},b.prototype.setPosition=function(e,t){var r=this;r.frontPosition={x:t.x,y:t.y};var a=r.options.fadeTime+"ms",c={};c.front=G("transition",["top","left"],a);var p={front:{}};p.front={left:r.frontPosition.x+"px",top:r.frontPosition.y+"px"},r.applyStyles(c),r.applyStyles(p),r.restTimeout=setTimeout(function(){typeof e=="function"&&e.call(r),r.restCallback()},r.options.fadeTime)},b.prototype.restCallback=function(){var e={};e.front=G("transition","none",""),this.applyStyles(e),this.trigger("rested",this.instance)},b.prototype.resetDirection=function(){this.direction={x:!1,y:!1,angle:!1}},b.prototype.computeDirection=function(e){var t,r,a,c=e.angle.radian,p=Math.PI/4,m=Math.PI/2;if(c>p&&c<3*p&&!e.lockX?t="up":c>-p&&c<=p&&!e.lockY?t="left":c>3*-p&&c<=-p&&!e.lockX?t="down":e.lockY||(t="right"),e.lockY||(r=c>-m&&c<m?"left":"right"),e.lockX||(a=c>0?"up":"down"),e.force>this.options.threshold){var u,k={};for(u in this.direction)this.direction.hasOwnProperty(u)&&(k[u]=this.direction[u]);var f={};for(u in this.direction={x:r,y:a,angle:t},e.direction=this.direction,k)k[u]===this.direction[u]&&(f[u]=!0);if(f.x&&f.y&&f.angle)return e;f.x&&f.y||this.trigger("plain",e),f.x||this.trigger("plain:"+r,e),f.y||this.trigger("plain:"+a,e),f.angle||this.trigger("dir dir:"+t,e)}else this.resetDirection();return e};var ee=b;function g(e,t){this.nipples=[],this.idles=[],this.actives=[],this.ids=[],this.pressureIntervals={},this.manager=e,this.id=g.id,g.id+=1,this.defaults={zone:document.body,multitouch:!1,maxNumberOfNipples:10,mode:"dynamic",position:{top:0,left:0},catchDistance:200,size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:.5,lockX:!1,lockY:!1,shape:"circle",dynamicPage:!1,follow:!1},this.config(t),this.options.mode!=="static"&&this.options.mode!=="semi"||(this.options.multitouch=!1),this.options.multitouch||(this.options.maxNumberOfNipples=1);var r=getComputedStyle(this.options.zone.parentElement);return r&&r.display==="flex"&&(this.parentIsFlex=!0),this.updateBox(),this.prepareNipples(),this.bindings(),this.begin(),this.nipples}g.prototype=new ct,g.constructor=g,g.id=0,g.prototype.prepareNipples=function(){var e=this.nipples;e.on=this.on.bind(this),e.off=this.off.bind(this),e.options=this.options,e.destroy=this.destroy.bind(this),e.ids=this.ids,e.id=this.id,e.processOnMove=this.processOnMove.bind(this),e.processOnEnd=this.processOnEnd.bind(this),e.get=function(t){if(t===void 0)return e[0];for(var r=0,a=e.length;r<a;r+=1)if(e[r].identifier===t)return e[r];return!1}},g.prototype.bindings=function(){this.bindEvt(this.options.zone,"start"),this.options.zone.style.touchAction="none",this.options.zone.style.msTouchAction="none"},g.prototype.begin=function(){var e=this.options;if(e.mode==="static"){var t=this.createNipple(e.position,this.manager.getIdentifier());t.add(),this.idles.push(t)}},g.prototype.createNipple=function(e,t){var r=this.manager.scroll,a={},c=this.options,p=this.parentIsFlex?r.x:r.x+this.box.left,m=this.parentIsFlex?r.y:r.y+this.box.top;if(e.x&&e.y)a={x:e.x-p,y:e.y-m};else if(e.top||e.right||e.bottom||e.left){var u=document.createElement("DIV");u.style.display="hidden",u.style.top=e.top,u.style.right=e.right,u.style.bottom=e.bottom,u.style.left=e.left,u.style.position="absolute",c.zone.appendChild(u);var k=u.getBoundingClientRect();c.zone.removeChild(u),a=e,e={x:k.left+r.x,y:k.top+r.y}}var f=new ee(this,{color:c.color,size:c.size,threshold:c.threshold,fadeTime:c.fadeTime,dataOnly:c.dataOnly,restJoystick:c.restJoystick,restOpacity:c.restOpacity,mode:c.mode,identifier:t,position:e,zone:c.zone,frontPosition:{x:0,y:0},shape:c.shape});return c.dataOnly||(T(f.ui.el,a),T(f.ui.front,f.frontPosition)),this.nipples.push(f),this.trigger("added "+f.identifier+":added",f),this.manager.trigger("added "+f.identifier+":added",f),this.bindNipple(f),f},g.prototype.updateBox=function(){this.box=this.options.zone.getBoundingClientRect()},g.prototype.bindNipple=function(e){var t,r=this,a=function(c,p){t=c.type+" "+p.id+":"+c.type,r.trigger(t,p)};e.on("destroyed",r.onDestroyed.bind(r)),e.on("shown hidden rested dir plain",a),e.on("dir:up dir:right dir:down dir:left",a),e.on("plain:up plain:right plain:down plain:left",a)},g.prototype.pressureFn=function(e,t,r){var a=this,c=0;clearInterval(a.pressureIntervals[r]),a.pressureIntervals[r]=setInterval(function(){var p=e.force||e.pressure||e.webkitForce||0;p!==c&&(t.trigger("pressure",p),a.trigger("pressure "+t.identifier+":pressure",p),c=p)}.bind(a),100)},g.prototype.onstart=function(e){var t=this,r=t.options,a=e;return e=F(e),t.updateBox(),at(e,function(c){t.actives.length<r.maxNumberOfNipples?t.processOnStart(c):a.type.match(/^touch/)&&(Object.keys(t.manager.ids).forEach(function(p){if(Object.values(a.touches).findIndex(function(u){return u.identifier===p})<0){var m=[e[0]];m.identifier=p,t.processOnEnd(m)}}),t.actives.length<r.maxNumberOfNipples&&t.processOnStart(c))}),t.manager.bindDocument(),!1},g.prototype.processOnStart=function(e){var t,r=this,a=r.options,c=r.manager.getIdentifier(e),p=e.force||e.pressure||e.webkitForce||0,m={x:e.pageX,y:e.pageY},u=r.getOrCreate(c,m);u.identifier!==c&&r.manager.removeIdentifier(u.identifier),u.identifier=c;var k=function(f){f.trigger("start",f),r.trigger("start "+f.id+":start",f),f.show(),p>0&&r.pressureFn(e,f,f.identifier),r.processOnMove(e)};if((t=r.idles.indexOf(u))>=0&&r.idles.splice(t,1),r.actives.push(u),r.ids.push(u.identifier),a.mode!=="semi")k(u);else{if(!(l(m,u.position)<=a.catchDistance))return u.destroy(),void r.processOnStart(e);k(u)}return u},g.prototype.getOrCreate=function(e,t){var r,a=this.options;return/(semi|static)/.test(a.mode)?(r=this.idles[0])?(this.idles.splice(0,1),r):a.mode==="semi"?this.createNipple(t,e):(console.warn("Coudln't find the needed nipple."),!1):r=this.createNipple(t,e)},g.prototype.processOnMove=function(e){var t=this.options,r=this.manager.getIdentifier(e),a=this.nipples.get(r),c=this.manager.scroll;if(function(X){return isNaN(X.buttons)?X.pressure!==0:X.buttons!==0}(e)){if(!a)return console.error("Found zombie joystick with ID "+r),void this.manager.removeIdentifier(r);if(t.dynamicPage){var p=a.el.getBoundingClientRect();a.position={x:c.x+p.left,y:c.y+p.top}}a.identifier=r;var m=a.options.size/2,u={x:e.pageX,y:e.pageY};t.lockX&&(u.y=a.position.y),t.lockY&&(u.x=a.position.x);var k,f,kt,Lt,Q,N,lt,dt,Z,tt,H=l(u,a.position),R=(k=u,f=a.position,kt=f.x-k.x,Lt=f.y-k.y,O(Math.atan2(Lt,kt))),oe=y(R),ie=H/m,re={distance:H,position:u};if(a.options.shape==="circle"?(Q=Math.min(H,m),lt=a.position,dt=Q,tt={x:0,y:0},Z=y(Z=R),tt.x=lt.x-dt*Math.cos(Z),tt.y=lt.y-dt*Math.sin(Z),N=tt):(N=function(X,nt,ot){return{x:Math.min(Math.max(X.x,nt.x-ot),nt.x+ot),y:Math.min(Math.max(X.y,nt.y-ot),nt.y+ot)}}(u,a.position,m),Q=l(N,a.position)),t.follow){if(H>m){var se=u.x-N.x,ae=u.y-N.y;a.position.x+=se,a.position.y+=ae,a.el.style.top=a.position.y-(this.box.top+c.y)+"px",a.el.style.left=a.position.x-(this.box.left+c.x)+"px",H=l(u,a.position)}}else u=N,H=Q;var Et=u.x-a.position.x,Ct=u.y-a.position.y;a.frontPosition={x:Et,y:Ct},t.dataOnly||T(a.ui.front,a.frontPosition);var et={identifier:a.identifier,position:u,force:ie,pressure:e.force||e.pressure||e.webkitForce||0,distance:H,angle:{radian:oe,degree:R},vector:{x:Et/m,y:-Ct/m},raw:re,instance:a,lockX:t.lockX,lockY:t.lockY};(et=a.computeDirection(et)).angle={radian:y(180-R),degree:180-R},a.trigger("move",et),this.trigger("move "+a.id+":move",et)}else this.processOnEnd(e)},g.prototype.processOnEnd=function(e){var t=this,r=t.options,a=t.manager.getIdentifier(e),c=t.nipples.get(a),p=t.manager.removeIdentifier(c.identifier);c&&(r.dataOnly||c.hide(function(){r.mode==="dynamic"&&(c.trigger("removed",c),t.trigger("removed "+c.id+":removed",c),t.manager.trigger("removed "+c.id+":removed",c),c.destroy())}),clearInterval(t.pressureIntervals[c.identifier]),c.resetDirection(),c.trigger("end",c),t.trigger("end "+c.id+":end",c),t.ids.indexOf(c.identifier)>=0&&t.ids.splice(t.ids.indexOf(c.identifier),1),t.actives.indexOf(c)>=0&&t.actives.splice(t.actives.indexOf(c),1),/(semi|static)/.test(r.mode)?t.idles.push(c):t.nipples.indexOf(c)>=0&&t.nipples.splice(t.nipples.indexOf(c),1),t.manager.unbindDocument(),/(semi|static)/.test(r.mode)&&(t.manager.ids[p.id]=p.identifier))},g.prototype.onDestroyed=function(e,t){this.nipples.indexOf(t)>=0&&this.nipples.splice(this.nipples.indexOf(t),1),this.actives.indexOf(t)>=0&&this.actives.splice(this.actives.indexOf(t),1),this.idles.indexOf(t)>=0&&this.idles.splice(this.idles.indexOf(t),1),this.ids.indexOf(t.identifier)>=0&&this.ids.splice(this.ids.indexOf(t.identifier),1),this.manager.removeIdentifier(t.identifier),this.manager.unbindDocument()},g.prototype.destroy=function(){for(var e in this.unbindEvt(this.options.zone,"start"),this.nipples.forEach(function(t){t.destroy()}),this.pressureIntervals)this.pressureIntervals.hasOwnProperty(e)&&clearInterval(this.pressureIntervals[e]);this.trigger("destroyed",this.nipples),this.manager.unbindDocument(),this.off()};var ne=g;function x(e){var t=this;t.ids={},t.index=0,t.collections=[],t.scroll=w(),t.config(e),t.prepareCollections();var r=function(){var c;t.collections.forEach(function(p){p.forEach(function(m){c=m.el.getBoundingClientRect(),m.position={x:t.scroll.x+c.left,y:t.scroll.y+c.top}})})};z(window,"resize",function(){S(r)});var a=function(){t.scroll=w()};return z(window,"scroll",function(){S(a)}),t.collections}x.prototype=new ct,x.constructor=x,x.prototype.prepareCollections=function(){var e=this;e.collections.create=e.create.bind(e),e.collections.on=e.on.bind(e),e.collections.off=e.off.bind(e),e.collections.destroy=e.destroy.bind(e),e.collections.get=function(t){var r;return e.collections.every(function(a){return!(r=a.get(t))}),r}},x.prototype.create=function(e){return this.createCollection(e)},x.prototype.createCollection=function(e){var t=new ne(this,e);return this.bindCollection(t),this.collections.push(t),t},x.prototype.bindCollection=function(e){var t,r=this,a=function(c,p){t=c.type+" "+p.id+":"+c.type,r.trigger(t,p)};e.on("destroyed",r.onDestroyed.bind(r)),e.on("shown hidden rested dir plain",a),e.on("dir:up dir:right dir:down dir:left",a),e.on("plain:up plain:right plain:down plain:left",a)},x.prototype.bindDocument=function(){this.binded||(this.bindEvt(document,"move").bindEvt(document,"end"),this.binded=!0)},x.prototype.unbindDocument=function(e){Object.keys(this.ids).length&&e!==!0||(this.unbindEvt(document,"move").unbindEvt(document,"end"),this.binded=!1)},x.prototype.getIdentifier=function(e){var t;return e?(t=e.identifier===void 0?e.pointerId:e.identifier)===void 0&&(t=this.latest||0):t=this.index,this.ids[t]===void 0&&(this.ids[t]=this.index,this.index+=1),this.latest=t,this.ids[t]},x.prototype.removeIdentifier=function(e){var t={};for(var r in this.ids)if(this.ids[r]===e){t.id=r,t.identifier=this.ids[r],delete this.ids[r];break}return t},x.prototype.onmove=function(e){return this.onAny("move",e),!1},x.prototype.onend=function(e){return this.onAny("end",e),!1},x.prototype.oncancel=function(e){return this.onAny("end",e),!1},x.prototype.onAny=function(e,t){var r,a=this,c="processOn"+e.charAt(0).toUpperCase()+e.slice(1);return t=F(t),at(t,function(p){r=a.getIdentifier(p),at(a.collections,function(m,u,k){k.ids.indexOf(u)>=0&&(k[c](m),m._found_=!0)}.bind(null,p,r)),p._found_||a.removeIdentifier(r)}),!1},x.prototype.destroy=function(){this.unbindDocument(!0),this.ids={},this.index=0,this.collections.forEach(function(e){e.destroy()}),this.off()},x.prototype.onDestroyed=function(e,t){if(this.collections.indexOf(t)<0)return!1;this.collections.splice(this.collections.indexOf(t),1)};var wt=new x;n.default={create:function(e){return wt.create(e)},factory:wt}}]).default})});var Mt=Date.now();function L(o,n=!1){let i;return Array.isArray(o)?i=o.reduce((s,l)=>s+=Number(l),0):i=Number(o),n?(Mt=Date.now()+i,navigator.vibrate(o)):Date.now()+i>Mt?navigator.vibrate(o):!1}var C=!1,_=!1,D=[];function Tt(){window.layoutEditor?.opened||(v("load"),v("load",!0),L(d.vibrate*3))}function Dt(){window.layoutEditor?.opened||(v("save"),v("save",!0),L(d.vibrate*3))}function At(){window.layoutEditor?.opened||_||(this.instance&&this.instance[this.instance.active?"release":"press"](),C||(D=[]),C=!C,window.recordingMacro=C,window.lastMacro=D)}async function zt(){if(!window.layoutEditor?.opened&&!C){_=!_,window.playingMacro=_,this.instance&&this.instance.press();for(let o of D){if(!_||P?.readyState!==1)break;P?.send(o),await new Promise(n=>setTimeout(n,50))}this.instance&&this.instance.release(),_=!1,window.playingMacro=_}}function Pt(){document.documentElement.requestFullscreen()}function ut(){let o=h.elements.buttons.find(l=>l.customAction==="load-state");o&&o.element.addEventListener(d.dblClickLoadSave?"dblclick":"click",Tt);let n=h.elements.buttons.find(l=>l.customAction==="save-state");n&&n.element.addEventListener(d.dblClickLoadSave?"dblclick":"click",Dt),C=!1,_=!1,D=[],window.recordingMacro=C,window.playingMacro=_,window.lastMacro=D;let i=h.elements.buttons.find(l=>l.customAction==="macro-record");i&&i.element.addEventListener("click",At);let s=h.elements.buttons.find(l=>l.customAction==="macro-play");s&&s.element.addEventListener("click",zt),document.querySelector(".deviceInfo").addEventListener("dblclick",Pt)}window.playingMacro=_;window.recordingMacro=C;window.lastMacro=D;window.loadState=Tt;window.saveState=Dt;window.recordMacro=At;window.playMacro=zt;window.fullScreen=Pt;var V=document.documentElement,mt=document.querySelector(".edit"),it=document.querySelector(".backgroundImage"),$=document.querySelector(".deviceInfo"),$t=$.querySelector(".battery"),J=$t.querySelector(".battery-icon"),St=$t.querySelector(".battery-level"),Bt=$.querySelector(".clock"),ht=$.querySelector(".player .player-number"),jt=$.querySelector(".layout"),Oe=$.querySelector(".status"),Ht=document.querySelector(".ping"),rt=document.querySelector(".controller-indicator"),ft=document.querySelector(".controller-layout"),Jt=document.querySelector('meta[name="viewport"]');var Nt=d.vgamepad?"mdi-google-controller":"mdi-keyboard";rt.classList.add(Nt);_t.V=o=>{let[n]=o.toLowerCase().split(" ");if(d.vibrationFromGame){let i=parseInt(n.split("|")[0]);L(i?3e3:0,!0),rt.classList[i?"remove":"add"](Nt),rt.classList[i?"add":"remove"]("mdi-vibrate")}};function de(o,n=!1,i){if(!(!o||!o.length)){if(typeof o=="string"&&(o=[o]),i||(o=o.map(s=>d.vgamepad?pt[s]?.[4]:pt[s]?.[d.player])),C&&i)return D.push(`${i} ${o} ${d.player}`);if(C)return D.push(`${n?"R":"P"} ${o} ${d.player}`);!P||P.readyState!==1||(i?P.send(`${i} ${o} ${d.player}`):P.send(`${n?"R":"P"} ${o} ${d.player}`))}}window.sendCmd=de;var v=(...o)=>window.sendCmd(...o);var W=class{constructor(){this.events={}}on(n,i){for(let s of n.split(" "))typeof this.events[s]!="object"&&(this.events[s]=[]),this.events[s].push(i);return()=>{for(let s of n.split(" "))this.off(s,i)}}off(n,i){for(let s of n.split(" "))if(typeof this.events[s]=="object"){let l=this.events[s].indexOf(i);l>-1&&this.events[s].splice(l,1)}}emit(n,...i){for(let s of n.split(" "))typeof this.events[s]=="object"&&this.events[s].forEach(l=>l.apply(this,i))}once(n,i){for(let s of n.split(" ")){let l=this.on(s,(...y)=>{l(),i.apply(this,y)})}}};var A=class extends W{constructor(n){super(),this.type="mobystk:unknown",this.id=n.id||"mobystk:unknown",this.name=n.name||"(Sem nome)",this.x=n.x||[0,"px"],this.y=n.y||[0,"px"],this.anchorX=n.anchorX||0,this.anchorY=n.anchorY||0,this.width=n.width||[100,"px"],this.height=n.height||[100,"px"]}render(){let n=this.element;n&&(n.style.left="",n.style.right="",n.style.top="",n.style.bottom="",n.style.transform="",n.style.width=this.width.join(""),n.style.height=this.height.join(""),this.anchorX===0&&(n.style.left=this.x.join("")),this.anchorX===1&&(n.style.right=this.x.join("")),this.anchorY===0&&(n.style.top=this.y.join("")),this.anchorY===1&&(n.style.bottom=this.y.join("")),n.classList[this.anchorX===2?"add":"remove"]("center-x"),n.classList[this.anchorY===2?"add":"remove"]("center-y"),n.classList[this.editing?"add":"remove"]("controller-editing"))}toObject(){return{type:this.type,id:this.id,name:this.name,x:this.x,y:this.y,anchorX:this.anchorX,anchorY:this.anchorY,width:this.width,height:this.height}}};var I=class extends A{constructor(n){super(n),this.type="mobystk:button",this.content=n.content||{type:"mobystk:text",value:""},this.key=n.key||"",this.customAction=n.customAction||!1,this.lockable=n.lockable||!1,this.diagonal=n.diagonal||!1,this.diagonal&&(this.targets=n.targets||[]),this.scalable=n.scalable||!1,this.border=n.border||[!0,!0,!0,!0],this.radius=n.radius||[[0,"px"],[0,"px"],[0,"px"],[0,"px"]],this.fontSize=n.fontSize||[20,"px"],this.active=!1,this.editing=!1;let i=document.createElement("button");i.classList.add("controller-button"),i.dataset.id=this.id,i.instance=this,this.element=i}press(n=!1){if(this.diagonal){let i=h.elements.buttons.filter(s=>this.targets.includes(s.id)&&!s.lockable);for(let s of i)s.press(!0)}else!this.active&&!this.customAction&&this.emit("press",this.key),this.scalable&&!this.active&&!n?this.element?.classList.add("controller-button-scale"):!this.active&&n&&(this.element?.classList.add("controller-button-active-diagonal"),this.element?.classList.add("controller-button-scale-diagonal")),this.active=!0,this.element?.classList.add("controller-button-active")}release(){if(this.diagonal){let n=h.elements.buttons.filter(i=>this.targets.includes(i.id));for(let i of n)i.release()}else this.active&&!this.customAction&&this.emit("release",this.key),this.active=!1,this.element?.classList.remove("controller-button-active"),this.element?.classList.remove("controller-button-scale"),this.element?.classList.remove("controller-button-active-diagonal"),this.element?.classList.remove("controller-button-scale-diagonal")}render(){super.render();let n=this.element;if(!n)return;this.border[0]||(n.style.borderTop="0"),this.border[1]||(n.style.borderRight="0"),this.border[2]||(n.style.borderBottom="0"),this.border[3]||(n.style.borderLeft="0");let i=this.radius.map(s=>s.join("")).join(" ");if(n.style.borderRadius=i,n.style.fontSize=this.fontSize.join(""),n.classList[this.diagonal?"add":"remove"]("controller-button-diagonal"),n.classList[this.lockable?"add":"remove"]("controller-button-lockable"),n.innerHTML="",this.content.type==="mobystk:text")n.innerText=this.content.value;else if(this.content.type==="mobystk:icon"){let s=document.createElement("i");s.classList.add("mdi","mdi-"+this.content.value),n.appendChild(s)}this._html&&(n.innerHTML=this._html),n.classList[this.customAction?"add":"remove"]("controller-custom-action"),n.dataset.action=this.customAction||void 0}toObject(){return{...super.toObject(),type:this.type,key:this.key,border:this.border,fontSize:this.fontSize,content:this.content,radius:this.radius,lockable:this.lockable,scalable:this.scalable,customAction:this.customAction,diagonal:this.diagonal,targets:this.targets}}};var Ut=le(Xt(),1);var M=class extends A{constructor(n){super(n),this.type="mobystk:joystick",this.size=n.size||[90,"px"],this.padding=n.padding||60,this.keys=n.keys||["joyLUp","joyLLeft","joyLDown","joyLRight"],this.position={up:!1,down:!1,left:!1,right:!1};let i=document.createElement("div");i.classList.add("controller-joystick"),i.dataset.id=this.id,i.instance=this,this.element=i}render(){this.width=[this.size[0]+this.padding,this.size[1]],this.height=[this.size[0]+this.padding,this.size[1]],super.render();let n=this.element;this.position={up:!1,down:!1,left:!1,right:!1},this.nipple&&this.nipple.destroy(),this.nipple=Ut.default.create({zone:n,size:this.size[0],mode:"static",position:{left:"50%",top:"50%"},lockX:d.disJoyYAxis,lockY:d.disJoyXAxis}),this.nipple.on("move",(i,s)=>this.emit("move",this,i,s)),this.nipple.on("end",(i,s)=>this.emit("end",this,i,s))}toObject(){return{...super.toObject(),type:this.type,size:this.size,padding:this.padding,keys:this.keys}}};document.addEventListener("touchstart",pe);document.addEventListener("touchmove",ue);document.addEventListener("touchend",Ft);document.addEventListener("touchcancel",Ft);function pe(o){if(!window.layoutEditor?.opened)for(let n of Array.from(o.changedTouches)){let i=document.elementFromPoint(n.clientX,n.clientY);for(;i!==null&&!(i.instance instanceof I&&!i.instance.customAction||i.instance instanceof M);)i=i.parentElement;if(i?.instance.lockable){L(d.vibrate),i.instance.active?i.instance.release():i.instance.press();continue}let s=i?.instance instanceof M;h.currentTouches.push({target:i,touch:n,joystick:s}),i&&(L(d.vibrate),!s&&i.instance.press())}}function ue(o){if(!window.layoutEditor?.opened)for(let n of Array.from(o.changedTouches)){let i=h.currentTouches.findIndex(y=>y.touch.identifier===n.identifier);if(i<0)continue;let s=h.currentTouches[i];if(s.joystick||!d.changeKeyOnDrag&&s.target)continue;s.touch=n;let l=document.elementFromPoint(n.clientX,n.clientY);for(;l!==null&&!(l.instance instanceof I&&!l.instance.customAction&&!l.instance.lockable);)l=l.parentElement;s.target!==l&&(s.target?.instance.release(),(!l||l.instance?.active)&&(l=null),s.target=l,l&&(l.instance.press(),L(d.vibrate)))}}function Ft(o){if(!window.layoutEditor?.opened)for(let n of Array.from(o.changedTouches)){let i=h.currentTouches.findIndex(s=>s.touch.identifier===n.identifier);i<0||(h.currentTouches[i].target?.instance instanceof I&&h.currentTouches[i].target.instance.release(),h.currentTouches.splice(i,1))}}var Gt=["mobystk:joystick_left","mobystk:joystick_right"];function gt(o,n,i){if(L(d.vibrateJoystick*i?.distance/45),d.vgamepad&&Gt.includes(o.id)){let l=Math.round(-32768+728.1555555555556*(45+i?.distance*Math.cos(i?.angle?.radian))),y=Math.round(-32768+65534/90*(45+i?.distance*Math.sin(i?.angle?.radian)));(isNaN(l)||isNaN(y))&&(l=y=0),o.id==="mobystk:joystick_left"&&v(`${l}|${y}`,!1,"VJL"),o.id==="mobystk:joystick_right"&&v(`${l}|${y}`,!1,"VJR")}if(!i?.direction){s("up",!1),s("left",!1),s("down",!1),s("right",!1);return}d.disJoyYAxis||s("up",i?.angle.degree>22.5&&i?.angle.degree<157.5),d.disJoyXAxis||s("left",i?.angle.degree>112.5&&i?.angle.degree<247.5),d.disJoyYAxis||s("down",i?.angle.degree>202.5&&i?.angle.degree<337.5),d.disJoyXAxis||s("right",i?.angle.degree>292.5||i?.angle.degree<67.5);function s(l,y){let{key:O,border:E}=me(o.keys,l),S=o.element.querySelector(".back");if(S.style[`border${E}Width`]=y?"7px":"",!(d.vgamepad&&Gt.includes(o.id))){if(o.position[l]===y)return;v([O],!y)}o.position[l]=y}}function me(o,n){let i={up:[o[0],"Top"],left:[o[1],"Left"],down:[o[2],"Bottom"],right:[o[3],"Right"]},[s,l]=i[n];return{key:s,border:l}}function qt(){let o;window.outerHeight>window.outerWidth/1.7777777777777777?o=640:o=window.outerWidth/window.outerHeight*360,Jt.setAttribute("content",`width=${o}, user-scalable=0`),h.currentTouches=h.currentTouches.filter(i=>!i.joystick),h.elements.joysticks.forEach(i=>i.render())}window.addEventListener("load",qt);window.addEventListener("resize",qt);var U=class extends A{constructor(n){super(n),this.type="mobystk:group",this.content=n.content||[],this.parsedContent=n.parsedContent||[];let i=document.createElement("div");i.classList.add("controller-group"),i.dataset.id=this.id,i.instance=this,this.element=i;for(let s of this.parsedContent)i.appendChild(s.element),s.render()}toObject(){return{...super.toObject(),type:this.type,content:this.content}}};var he=`
	<svg viewBox="0 0 32 32">
		<path d="M16 0a16 16 0 100 32 16 16 0 000-32zm0 4a12 12 0 0111.3 8H4.7c1.7-4.6 6-8 11.3-8zm0 14a2 2 0 110-4 2 2 0 010 4zM4 16c5.5 0 9.9 5.3 10 11.8A12 12 0 014 16zm14 11.8c.1-6.5 4.5-11.8 10-11.8a12 12 0 01-10 11.8z"></path>
	</svg>`;function vt(){let o=h.elements.buttons.find(s=>s.customAction==="drive"),n=o?o._html=he:"";o?.render(),o&&o.element.addEventListener("touchstart",i),!fe()&&o&&o.element&&(o.element.style.display="none");function i(){if(window.layoutEditor?.opened)return;o.active?l():s();function s(){o.press(),o.element.innerHTML='<i class="driveArrow mdi mdi-arrow-up"></i>';let y=0,O=0,E=[];window.ondevicemotion=S=>{let z=window.outerWidth>window.outerHeight,Y=S.accelerationIncludingGravity[z?"x":"y"]>=0?1:-1;y=parseFloat(S.accelerationIncludingGravity[z?"y":"x"].toFixed(1)),y*=Y*(z?1:-1);let F=o.element.children[0];if(d.vgamepad){let w=Math.round(32767/d.driveSensitivity*y);w<10923*d.drivePrecision&&w>-10923*d.drivePrecision&&(w=0),w>32767&&(w=32767),w<-32767&&(w=-32767);let T=90*w/32767;F.style.transform=`rotate(${T}deg)`,v(`${w}|0`,!1,"VJL")}else{let w=ye(O,y,d.driveSensitivity,d.drivePrecision);if(w===O)return;F.style.transform=`rotate(${w}deg)`,O=w,L(d.vibrate*2);let T=ge(w),G=T.filter(B=>!E.includes(B)),K=E.filter(B=>!T.includes(B));v(G),v(K,!0),E=[...T]}}}function l(){o.release(),o.element.innerHTML=n,window.ondevicemotion=null,d.vgamepad?v("0|0",!1,"VJL"):(v("joyLUp",!0),v("joyLLeft",!0),v("joyLRight",!0))}}}function fe(){return location.protocol==="https:"||location.hostname==="localhost"||location.hostname==="127.0.0.1"}function ye(o,n,i,s){let l=0;return o===-45?(n>i&&(l=45),n<-i+s&&(l=-45),n>i*2&&(l*=2),n<-i*2-s&&(l*=2)):o===45?(n>i-s&&(l=45),n<-i&&(l=-45),n>i*2+s&&(l*=2),n<-i*2&&(l*=2)):(n>i&&(l=45),n<-i&&(l=-45),n>i*2&&(l*=2),n<-i*2&&(l*=2)),l}function ge(o){let n;switch(o){case-90:n=["joyLLeft"];break;case-45:n=["joyLUp","joyLLeft"];break;case 45:n=["joyLUp","joyLRight"];break;case 90:n=["joyLRight"];break;default:n=["joyLUp"]}return n}function ve(o){let n={...o,parsedContent:o.content.map(Vt).filter(s=>!!s)},i=Rt(n);ft.innerHTML="";for(let s of n.parsedContent)s&&(ft.appendChild(s.element),s.render());return h.currentLayout=n,h.elements.all=i,h.elements.buttons=i.filter(s=>s instanceof I),h.elements.groups=i.filter(s=>s instanceof U),h.elements.joysticks=i.filter(s=>s instanceof M),jt.innerText=o.name||"???",ut(),vt(),o}function Rt(o,n=[]){if(o.type==="mobystk:layout"||o.type==="mobystk:group"){o=o,o.type!=="mobystk:layout"&&n.push(o);for(let i of o.parsedContent)Rt(i,n)}else n.push(o);return n}function Vt(o){let n="import"in o?o.import:o.id;if(!d.hidden?.includes(n)&&("import"in o&&(o=be(o)),!!o)){if(o.type==="mobystk:button")return o=o,d.locked?.includes(n)&&(o={...o,lockable:!0}),new I(o);if(o.type==="mobystk:group"){o=o,o.parsedContent=o.content.map(Vt).filter(s=>s);let i=new U(o);return o.parsedContent=o.parsedContent.map(s=>s.parent=i),i}else if(o.type==="mobystk:joystick")return o=o,new M(o)}}function be(o){let i=[...h.buttons,...h.groups,...h.joysticks].find(s=>s.id===o.import);if(i)return{...i,...o}}if(!d.layout)throw window.location.href="index.html",new Error("Layout n\xE3o selecionado");var Wt=h.layouts.find(o=>o.id===d.layout);if(!Wt)throw alert("Layout n\xE3o encontrado!"),window.location.href="index.html",new Error("Layout n\xE3o encontrado");ve(Wt);for(let o of h.elements.all)o instanceof I?(o.on("press",n=>v(n,!1)),o.on("release",n=>v(n,!0))):o instanceof M&&o.on("move end",gt);d.hidden.includes("mobystk:deviceInfo")&&$.classList.add("hidden");d.hidden.includes("mobystk:ping")&&Ht.classList.add("hidden");mt.addEventListener("click",It);mt.addEventListener("contextmenu",()=>{window.layoutEditor.opened?window.layoutEditor.end():window.layoutEditor.start()});d.layout||(location.href="index.html");d.debug&&document.body.classList.add("debug");d.invertL&&document.body.classList.add("invertL");d.invertR&&document.body.classList.add("invertR");d.bgImage&&(it.style.backgroundImage=`url('${d.bgImage}')`);d.bgOpacity&&(it.style.opacity=String(d.bgOpacity));d.bgBlur&&(it.style.filter=`blur(${d.bgBlur}px)`);d.colorsBackground&&V.style.setProperty("--background",d.colorsBackground);d.colorsColor&&V.style.setProperty("--color",d.colorsColor);d.colorsBorder&&V.style.setProperty("--border",d.colorsBorder);d.colorsActive&&V.style.setProperty("--active",d.colorsActive);var Yt=document.createElement("style");Yt.textContent=d.customCSS;document.body.append(Yt);if(d.customJS&&d.customJS.trim()&&confirm("Deseja executar os plugins?"))try{new Function(d.customJS.trim())()}catch(o){alert(`Ocorreu um erro ao executar os plugins

`+(o?.message||""))}if(d.pluginMobile){let o=document.createElement("script");o.src="lib/plugins/mobile.js",o.onerror=()=>Ot("Erro ao carregar plugin MobyStk Mobile"),document.body.appendChild(o)}navigator.getBattery?.()?.then(o=>{bt(o),o.addEventListener("chargingchange",n=>bt(n.target)),o.addEventListener("levelchange",n=>bt(n.target))}).catch(console.error);function bt(o){J.classList.remove(...Array.from(J.classList)),J.classList.add("mdi");let n=o.charging,i=o.level*100,s=Math.round(i/10)*10;St.innerText=Math.round(i)+"% \u2022",s===0?J.classList.add("mdi-battery-outline"):s===100?J.classList.add("mdi-battery"+(n?"-charging-100":"")):J.classList.add("mdi-battery-"+(n?"charging-":"")+s)}window.setInterval(Kt,1e3);Kt();function Kt(){let o=new Date().getHours().toString().padStart(2,"0"),n=new Date().getMinutes().toString().padStart(2,"0");Bt.innerText=o+":"+n}ht.innerText=String(d.player+1);d.debug&&$.addEventListener("click",()=>{d.player+=1,d.player>3&&(d.player=0),ht.innerText=String(d.player+1)});document.addEventListener("contextmenu",o=>o.preventDefault());window.addEventListener("load",()=>{document.body.classList.remove("preload")});
