import{a as $,b as h}from"../chunk-HOA7L2ME.js";import{a as st,b as rt,c as at,d as vt,e as bt,f as T}from"../chunk-AGBWWW2P.js";import{a as Rt,b as Wt,g as u}from"../chunk-QGJALF3G.js";var Ct=Rt((tt,ct)=>{(function(o,s){typeof tt=="object"&&typeof ct=="object"?ct.exports=s():typeof define=="function"&&define.amd?define("nipplejs",[],s):typeof tt=="object"?tt.nipplejs=s():o.nipplejs=s()})(window,function(){return function(o){var s={};function n(a){if(s[a])return s[a].exports;var c=s[a]={i:a,l:!1,exports:{}};return o[a].call(c.exports,c,c.exports,n),c.l=!0,c.exports}return n.m=o,n.c=s,n.d=function(a,c,f){n.o(a,c)||Object.defineProperty(a,c,{enumerable:!0,get:f})},n.r=function(a){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},n.t=function(a,c){if(1&c&&(a=n(a)),8&c||4&c&&typeof a=="object"&&a&&a.__esModule)return a;var f=Object.create(null);if(n.r(f),Object.defineProperty(f,"default",{enumerable:!0,value:a}),2&c&&typeof a!="string")for(var O in a)n.d(f,O,function(L){return a[L]}.bind(null,O));return f},n.n=function(a){var c=a&&a.__esModule?function(){return a.default}:function(){return a};return n.d(c,"a",c),c},n.o=function(a,c){return Object.prototype.hasOwnProperty.call(a,c)},n.p="",n(n.s=0)}([function(o,s,n){"use strict";n.r(s);var a,c=function(e,t){var i=t.x-e.x,r=t.y-e.y;return Math.sqrt(i*i+r*r)},f=function(e){return e*(Math.PI/180)},O=function(e){return e*(180/Math.PI)},L=new Map,P=function(e){L.has(e)&&clearTimeout(L.get(e)),L.set(e,setTimeout(e,100))},D=function(e,t,i){for(var r,l=t.split(/[ ,]+/g),d=0;d<l.length;d+=1)r=l[d],e.addEventListener?e.addEventListener(r,i,!1):e.attachEvent&&e.attachEvent(r,i)},R=function(e,t,i){for(var r,l=t.split(/[ ,]+/g),d=0;d<l.length;d+=1)r=l[d],e.removeEventListener?e.removeEventListener(r,i):e.detachEvent&&e.detachEvent(r,i)},X=function(e){return e.preventDefault(),e.type.match(/^touch/)?e.changedTouches:e},x=function(){return{x:window.pageXOffset!==void 0?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,y:window.pageYOffset!==void 0?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop}},A=function(e,t){t.top||t.right||t.bottom||t.left?(e.style.top=t.top,e.style.right=t.right,e.style.bottom=t.bottom,e.style.left=t.left):(e.style.left=t.x+"px",e.style.top=t.y+"px")},F=function(e,t,i){var r=W(e);for(var l in r)if(r.hasOwnProperty(l))if(typeof t=="string")r[l]=t+" "+i;else{for(var d="",m=0,p=t.length;m<p;m+=1)d+=t[m]+" "+i+", ";r[l]=d.slice(0,-2)}return r},W=function(e){var t={};return t[e]="",["webkit","Moz","o"].forEach(function(i){t[i+e.charAt(0).toUpperCase()+e.slice(1)]=""}),t},B=function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e},et=function(e,t){if(e.length)for(var i=0,r=e.length;i<r;i+=1)t(e[i]);else t(e)},Jt="ontouchstart"in window,jt=!!window.PointerEvent,Ht=!!window.MSPointerEvent,ut={start:"mousedown",move:"mousemove",end:"mouseup"},G={};function J(){}jt?a={start:"pointerdown",move:"pointermove",end:"pointerup, pointercancel"}:Ht?a={start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}:Jt?(a={start:"touchstart",move:"touchmove",end:"touchend, touchcancel"},G=ut):a=ut,J.prototype.on=function(e,t){var i,r=e.split(/[ ,]+/g);this._handlers_=this._handlers_||{};for(var l=0;l<r.length;l+=1)i=r[l],this._handlers_[i]=this._handlers_[i]||[],this._handlers_[i].push(t);return this},J.prototype.off=function(e,t){return this._handlers_=this._handlers_||{},e===void 0?this._handlers_={}:t===void 0?this._handlers_[e]=null:this._handlers_[e]&&this._handlers_[e].indexOf(t)>=0&&this._handlers_[e].splice(this._handlers_[e].indexOf(t),1),this},J.prototype.trigger=function(e,t){var i,r=this,l=e.split(/[ ,]+/g);r._handlers_=r._handlers_||{};for(var d=0;d<l.length;d+=1)i=l[d],r._handlers_[i]&&r._handlers_[i].length&&r._handlers_[i].forEach(function(m){m.call(r,{type:i,target:r},t)})},J.prototype.config=function(e){this.options=this.defaults||{},e&&(this.options=function(t,i){var r={};for(var l in t)t.hasOwnProperty(l)&&i.hasOwnProperty(l)?r[l]=i[l]:t.hasOwnProperty(l)&&(r[l]=t[l]);return r}(this.options,e))},J.prototype.bindEvt=function(e,t){var i=this;return i._domHandlers_=i._domHandlers_||{},i._domHandlers_[t]=function(){typeof i["on"+t]=="function"?i["on"+t].apply(i,arguments):console.warn('[WARNING] : Missing "on'+t+'" handler.')},D(e,a[t],i._domHandlers_[t]),G[t]&&D(e,G[t],i._domHandlers_[t]),i},J.prototype.unbindEvt=function(e,t){return this._domHandlers_=this._domHandlers_||{},R(e,a[t],this._domHandlers_[t]),G[t]&&R(e,G[t],this._domHandlers_[t]),delete this._domHandlers_[t],this};var it=J;function b(e,t){return this.identifier=t.identifier,this.position=t.position,this.frontPosition=t.frontPosition,this.collection=e,this.defaults={size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:.5,mode:"dynamic",zone:document.body,lockX:!1,lockY:!1,shape:"circle"},this.config(t),this.options.mode==="dynamic"&&(this.options.restOpacity=0),this.id=b.id,b.id+=1,this.buildEl().stylize(),this.instance={el:this.ui.el,on:this.on.bind(this),off:this.off.bind(this),show:this.show.bind(this),hide:this.hide.bind(this),add:this.addToDom.bind(this),remove:this.removeFromDom.bind(this),destroy:this.destroy.bind(this),setPosition:this.setPosition.bind(this),resetDirection:this.resetDirection.bind(this),computeDirection:this.computeDirection.bind(this),trigger:this.trigger.bind(this),position:this.position,frontPosition:this.frontPosition,ui:this.ui,identifier:this.identifier,id:this.id,options:this.options},this.instance}b.prototype=new it,b.constructor=b,b.id=0,b.prototype.buildEl=function(e){return this.ui={},this.options.dataOnly?this:(this.ui.el=document.createElement("div"),this.ui.back=document.createElement("div"),this.ui.front=document.createElement("div"),this.ui.el.className="nipple collection_"+this.collection.id,this.ui.back.className="back",this.ui.front.className="front",this.ui.el.setAttribute("id","nipple_"+this.collection.id+"_"+this.id),this.ui.el.appendChild(this.ui.back),this.ui.el.appendChild(this.ui.front),this)},b.prototype.stylize=function(){if(this.options.dataOnly)return this;var e=this.options.fadeTime+"ms",t=function(l,d){var m=W(l);for(var p in m)m.hasOwnProperty(p)&&(m[p]=d);return m}("borderRadius","50%"),i=F("transition","opacity",e),r={};return r.el={position:"absolute",opacity:this.options.restOpacity,display:"block",zIndex:999},r.back={position:"absolute",display:"block",width:this.options.size+"px",height:this.options.size+"px",marginLeft:-this.options.size/2+"px",marginTop:-this.options.size/2+"px",background:this.options.color,opacity:".5"},r.front={width:this.options.size/2+"px",height:this.options.size/2+"px",position:"absolute",display:"block",marginLeft:-this.options.size/4+"px",marginTop:-this.options.size/4+"px",background:this.options.color,opacity:".5"},B(r.el,i),this.options.shape==="circle"&&B(r.back,t),B(r.front,t),this.applyStyles(r),this},b.prototype.applyStyles=function(e){for(var t in this.ui)if(this.ui.hasOwnProperty(t))for(var i in e[t])this.ui[t].style[i]=e[t][i];return this},b.prototype.addToDom=function(){return this.options.dataOnly||document.body.contains(this.ui.el)?this:(this.options.zone.appendChild(this.ui.el),this)},b.prototype.removeFromDom=function(){return this.options.dataOnly||!document.body.contains(this.ui.el)?this:(this.options.zone.removeChild(this.ui.el),this)},b.prototype.destroy=function(){clearTimeout(this.removeTimeout),clearTimeout(this.showTimeout),clearTimeout(this.restTimeout),this.trigger("destroyed",this.instance),this.removeFromDom(),this.off()},b.prototype.show=function(e){var t=this;return t.options.dataOnly||(clearTimeout(t.removeTimeout),clearTimeout(t.showTimeout),clearTimeout(t.restTimeout),t.addToDom(),t.restCallback(),setTimeout(function(){t.ui.el.style.opacity=1},0),t.showTimeout=setTimeout(function(){t.trigger("shown",t.instance),typeof e=="function"&&e.call(this)},t.options.fadeTime)),t},b.prototype.hide=function(e){var t=this;if(t.options.dataOnly)return t;if(t.ui.el.style.opacity=t.options.restOpacity,clearTimeout(t.removeTimeout),clearTimeout(t.showTimeout),clearTimeout(t.restTimeout),t.removeTimeout=setTimeout(function(){var l=t.options.mode==="dynamic"?"none":"block";t.ui.el.style.display=l,typeof e=="function"&&e.call(t),t.trigger("hidden",t.instance)},t.options.fadeTime),t.options.restJoystick){var i=t.options.restJoystick,r={};r.x=i===!0||i.x!==!1?0:t.instance.frontPosition.x,r.y=i===!0||i.y!==!1?0:t.instance.frontPosition.y,t.setPosition(e,r)}return t},b.prototype.setPosition=function(e,t){var i=this;i.frontPosition={x:t.x,y:t.y};var r=i.options.fadeTime+"ms",l={};l.front=F("transition",["top","left"],r);var d={front:{}};d.front={left:i.frontPosition.x+"px",top:i.frontPosition.y+"px"},i.applyStyles(l),i.applyStyles(d),i.restTimeout=setTimeout(function(){typeof e=="function"&&e.call(i),i.restCallback()},i.options.fadeTime)},b.prototype.restCallback=function(){var e={};e.front=F("transition","none",""),this.applyStyles(e),this.trigger("rested",this.instance)},b.prototype.resetDirection=function(){this.direction={x:!1,y:!1,angle:!1}},b.prototype.computeDirection=function(e){var t,i,r,l=e.angle.radian,d=Math.PI/4,m=Math.PI/2;if(l>d&&l<3*d&&!e.lockX?t="up":l>-d&&l<=d&&!e.lockY?t="left":l>3*-d&&l<=-d&&!e.lockX?t="down":e.lockY||(t="right"),e.lockY||(i=l>-m&&l<m?"left":"right"),e.lockX||(r=l>0?"up":"down"),e.force>this.options.threshold){var p,k={};for(p in this.direction)this.direction.hasOwnProperty(p)&&(k[p]=this.direction[p]);var y={};for(p in this.direction={x:i,y:r,angle:t},e.direction=this.direction,k)k[p]===this.direction[p]&&(y[p]=!0);if(y.x&&y.y&&y.angle)return e;y.x&&y.y||this.trigger("plain",e),y.x||this.trigger("plain:"+i,e),y.y||this.trigger("plain:"+r,e),y.angle||this.trigger("dir dir:"+t,e)}else this.resetDirection();return e};var Nt=b;function g(e,t){this.nipples=[],this.idles=[],this.actives=[],this.ids=[],this.pressureIntervals={},this.manager=e,this.id=g.id,g.id+=1,this.defaults={zone:document.body,multitouch:!1,maxNumberOfNipples:10,mode:"dynamic",position:{top:0,left:0},catchDistance:200,size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:.5,lockX:!1,lockY:!1,shape:"circle",dynamicPage:!1,follow:!1},this.config(t),this.options.mode!=="static"&&this.options.mode!=="semi"||(this.options.multitouch=!1),this.options.multitouch||(this.options.maxNumberOfNipples=1);var i=getComputedStyle(this.options.zone.parentElement);return i&&i.display==="flex"&&(this.parentIsFlex=!0),this.updateBox(),this.prepareNipples(),this.bindings(),this.begin(),this.nipples}g.prototype=new it,g.constructor=g,g.id=0,g.prototype.prepareNipples=function(){var e=this.nipples;e.on=this.on.bind(this),e.off=this.off.bind(this),e.options=this.options,e.destroy=this.destroy.bind(this),e.ids=this.ids,e.id=this.id,e.processOnMove=this.processOnMove.bind(this),e.processOnEnd=this.processOnEnd.bind(this),e.get=function(t){if(t===void 0)return e[0];for(var i=0,r=e.length;i<r;i+=1)if(e[i].identifier===t)return e[i];return!1}},g.prototype.bindings=function(){this.bindEvt(this.options.zone,"start"),this.options.zone.style.touchAction="none",this.options.zone.style.msTouchAction="none"},g.prototype.begin=function(){var e=this.options;if(e.mode==="static"){var t=this.createNipple(e.position,this.manager.getIdentifier());t.add(),this.idles.push(t)}},g.prototype.createNipple=function(e,t){var i=this.manager.scroll,r={},l=this.options,d=this.parentIsFlex?i.x:i.x+this.box.left,m=this.parentIsFlex?i.y:i.y+this.box.top;if(e.x&&e.y)r={x:e.x-d,y:e.y-m};else if(e.top||e.right||e.bottom||e.left){var p=document.createElement("DIV");p.style.display="hidden",p.style.top=e.top,p.style.right=e.right,p.style.bottom=e.bottom,p.style.left=e.left,p.style.position="absolute",l.zone.appendChild(p);var k=p.getBoundingClientRect();l.zone.removeChild(p),r=e,e={x:k.left+i.x,y:k.top+i.y}}var y=new Nt(this,{color:l.color,size:l.size,threshold:l.threshold,fadeTime:l.fadeTime,dataOnly:l.dataOnly,restJoystick:l.restJoystick,restOpacity:l.restOpacity,mode:l.mode,identifier:t,position:e,zone:l.zone,frontPosition:{x:0,y:0},shape:l.shape});return l.dataOnly||(A(y.ui.el,r),A(y.ui.front,y.frontPosition)),this.nipples.push(y),this.trigger("added "+y.identifier+":added",y),this.manager.trigger("added "+y.identifier+":added",y),this.bindNipple(y),y},g.prototype.updateBox=function(){this.box=this.options.zone.getBoundingClientRect()},g.prototype.bindNipple=function(e){var t,i=this,r=function(l,d){t=l.type+" "+d.id+":"+l.type,i.trigger(t,d)};e.on("destroyed",i.onDestroyed.bind(i)),e.on("shown hidden rested dir plain",r),e.on("dir:up dir:right dir:down dir:left",r),e.on("plain:up plain:right plain:down plain:left",r)},g.prototype.pressureFn=function(e,t,i){var r=this,l=0;clearInterval(r.pressureIntervals[i]),r.pressureIntervals[i]=setInterval(function(){var d=e.force||e.pressure||e.webkitForce||0;d!==l&&(t.trigger("pressure",d),r.trigger("pressure "+t.identifier+":pressure",d),l=d)}.bind(r),100)},g.prototype.onstart=function(e){var t=this,i=t.options,r=e;return e=X(e),t.updateBox(),et(e,function(l){t.actives.length<i.maxNumberOfNipples?t.processOnStart(l):r.type.match(/^touch/)&&(Object.keys(t.manager.ids).forEach(function(d){if(Object.values(r.touches).findIndex(function(p){return p.identifier===d})<0){var m=[e[0]];m.identifier=d,t.processOnEnd(m)}}),t.actives.length<i.maxNumberOfNipples&&t.processOnStart(l))}),t.manager.bindDocument(),!1},g.prototype.processOnStart=function(e){var t,i=this,r=i.options,l=i.manager.getIdentifier(e),d=e.force||e.pressure||e.webkitForce||0,m={x:e.pageX,y:e.pageY},p=i.getOrCreate(l,m);p.identifier!==l&&i.manager.removeIdentifier(p.identifier),p.identifier=l;var k=function(y){y.trigger("start",y),i.trigger("start "+y.id+":start",y),y.show(),d>0&&i.pressureFn(e,y,y.identifier),i.processOnMove(e)};if((t=i.idles.indexOf(p))>=0&&i.idles.splice(t,1),i.actives.push(p),i.ids.push(p.identifier),r.mode!=="semi")k(p);else{if(!(c(m,p.position)<=r.catchDistance))return p.destroy(),void i.processOnStart(e);k(p)}return p},g.prototype.getOrCreate=function(e,t){var i,r=this.options;return/(semi|static)/.test(r.mode)?(i=this.idles[0])?(this.idles.splice(0,1),i):r.mode==="semi"?this.createNipple(t,e):(console.warn("Coudln't find the needed nipple."),!1):i=this.createNipple(t,e)},g.prototype.processOnMove=function(e){var t=this.options,i=this.manager.getIdentifier(e),r=this.nipples.get(i),l=this.manager.scroll;if(function(N){return isNaN(N.buttons)?N.pressure!==0:N.buttons!==0}(e)){if(!r)return console.error("Found zombie joystick with ID "+i),void this.manager.removeIdentifier(i);if(t.dynamicPage){var d=r.el.getBoundingClientRect();r.position={x:l.x+d.left,y:l.y+d.top}}r.identifier=i;var m=r.options.size/2,p={x:e.pageX,y:e.pageY};t.lockX&&(p.y=r.position.y),t.lockY&&(p.x=r.position.x);var k,y,ht,mt,K,H,nt,ot,V,q,j=c(p,r.position),U=(k=p,y=r.position,ht=y.x-k.x,mt=y.y-k.y,O(Math.atan2(mt,ht))),St=f(U),Xt=j/m,Ft={distance:j,position:p};if(r.options.shape==="circle"?(K=Math.min(j,m),nt=r.position,ot=K,q={x:0,y:0},V=f(V=U),q.x=nt.x-ot*Math.cos(V),q.y=nt.y-ot*Math.sin(V),H=q):(H=function(N,Z,Y){return{x:Math.min(Math.max(N.x,Z.x-Y),Z.x+Y),y:Math.min(Math.max(N.y,Z.y-Y),Z.y+Y)}}(p,r.position,m),K=c(H,r.position)),t.follow){if(j>m){var Gt=p.x-H.x,Ut=p.y-H.y;r.position.x+=Gt,r.position.y+=Ut,r.el.style.top=r.position.y-(this.box.top+l.y)+"px",r.el.style.left=r.position.x-(this.box.left+l.x)+"px",j=c(p,r.position)}}else p=H,j=K;var yt=p.x-r.position.x,gt=p.y-r.position.y;r.frontPosition={x:yt,y:gt},t.dataOnly||A(r.ui.front,r.frontPosition);var Q={identifier:r.identifier,position:p,force:Xt,pressure:e.force||e.pressure||e.webkitForce||0,distance:j,angle:{radian:St,degree:U},vector:{x:yt/m,y:-gt/m},raw:Ft,instance:r,lockX:t.lockX,lockY:t.lockY};(Q=r.computeDirection(Q)).angle={radian:f(180-U),degree:180-U},r.trigger("move",Q),this.trigger("move "+r.id+":move",Q)}else this.processOnEnd(e)},g.prototype.processOnEnd=function(e){var t=this,i=t.options,r=t.manager.getIdentifier(e),l=t.nipples.get(r),d=t.manager.removeIdentifier(l.identifier);l&&(i.dataOnly||l.hide(function(){i.mode==="dynamic"&&(l.trigger("removed",l),t.trigger("removed "+l.id+":removed",l),t.manager.trigger("removed "+l.id+":removed",l),l.destroy())}),clearInterval(t.pressureIntervals[l.identifier]),l.resetDirection(),l.trigger("end",l),t.trigger("end "+l.id+":end",l),t.ids.indexOf(l.identifier)>=0&&t.ids.splice(t.ids.indexOf(l.identifier),1),t.actives.indexOf(l)>=0&&t.actives.splice(t.actives.indexOf(l),1),/(semi|static)/.test(i.mode)?t.idles.push(l):t.nipples.indexOf(l)>=0&&t.nipples.splice(t.nipples.indexOf(l),1),t.manager.unbindDocument(),/(semi|static)/.test(i.mode)&&(t.manager.ids[d.id]=d.identifier))},g.prototype.onDestroyed=function(e,t){this.nipples.indexOf(t)>=0&&this.nipples.splice(this.nipples.indexOf(t),1),this.actives.indexOf(t)>=0&&this.actives.splice(this.actives.indexOf(t),1),this.idles.indexOf(t)>=0&&this.idles.splice(this.idles.indexOf(t),1),this.ids.indexOf(t.identifier)>=0&&this.ids.splice(this.ids.indexOf(t.identifier),1),this.manager.removeIdentifier(t.identifier),this.manager.unbindDocument()},g.prototype.destroy=function(){for(var e in this.unbindEvt(this.options.zone,"start"),this.nipples.forEach(function(t){t.destroy()}),this.pressureIntervals)this.pressureIntervals.hasOwnProperty(e)&&clearInterval(this.pressureIntervals[e]);this.trigger("destroyed",this.nipples),this.manager.unbindDocument(),this.off()};var $t=g;function w(e){var t=this;t.ids={},t.index=0,t.collections=[],t.scroll=x(),t.config(e),t.prepareCollections();var i=function(){var l;t.collections.forEach(function(d){d.forEach(function(m){l=m.el.getBoundingClientRect(),m.position={x:t.scroll.x+l.left,y:t.scroll.y+l.top}})})};D(window,"resize",function(){P(i)});var r=function(){t.scroll=x()};return D(window,"scroll",function(){P(r)}),t.collections}w.prototype=new it,w.constructor=w,w.prototype.prepareCollections=function(){var e=this;e.collections.create=e.create.bind(e),e.collections.on=e.on.bind(e),e.collections.off=e.off.bind(e),e.collections.destroy=e.destroy.bind(e),e.collections.get=function(t){var i;return e.collections.every(function(r){return!(i=r.get(t))}),i}},w.prototype.create=function(e){return this.createCollection(e)},w.prototype.createCollection=function(e){var t=new $t(this,e);return this.bindCollection(t),this.collections.push(t),t},w.prototype.bindCollection=function(e){var t,i=this,r=function(l,d){t=l.type+" "+d.id+":"+l.type,i.trigger(t,d)};e.on("destroyed",i.onDestroyed.bind(i)),e.on("shown hidden rested dir plain",r),e.on("dir:up dir:right dir:down dir:left",r),e.on("plain:up plain:right plain:down plain:left",r)},w.prototype.bindDocument=function(){this.binded||(this.bindEvt(document,"move").bindEvt(document,"end"),this.binded=!0)},w.prototype.unbindDocument=function(e){Object.keys(this.ids).length&&e!==!0||(this.unbindEvt(document,"move").unbindEvt(document,"end"),this.binded=!1)},w.prototype.getIdentifier=function(e){var t;return e?(t=e.identifier===void 0?e.pointerId:e.identifier)===void 0&&(t=this.latest||0):t=this.index,this.ids[t]===void 0&&(this.ids[t]=this.index,this.index+=1),this.latest=t,this.ids[t]},w.prototype.removeIdentifier=function(e){var t={};for(var i in this.ids)if(this.ids[i]===e){t.id=i,t.identifier=this.ids[i],delete this.ids[i];break}return t},w.prototype.onmove=function(e){return this.onAny("move",e),!1},w.prototype.onend=function(e){return this.onAny("end",e),!1},w.prototype.oncancel=function(e){return this.onAny("end",e),!1},w.prototype.onAny=function(e,t){var i,r=this,l="processOn"+e.charAt(0).toUpperCase()+e.slice(1);return t=X(t),et(t,function(d){i=r.getIdentifier(d),et(r.collections,function(m,p,k){k.ids.indexOf(p)>=0&&(k[l](m),m._found_=!0)}.bind(null,d,i)),d._found_||r.removeIdentifier(i)}),!1},w.prototype.destroy=function(){this.unbindDocument(!0),this.ids={},this.index=0,this.collections.forEach(function(e){e.destroy()}),this.off()},w.prototype.onDestroyed=function(e,t){if(this.collections.indexOf(t)<0)return!1;this.collections.splice(this.collections.indexOf(t),1)};var ft=new w;s.default={create:function(e){return ft.create(e)},factory:ft}}]).default})});var wt=Date.now();function E(o,s=!1){let n;return Array.isArray(o)?n=o.reduce((a,c)=>a+=Number(c),0):n=Number(o),s?(wt=Date.now()+n,navigator.vibrate(o)):Date.now()+n>wt?navigator.vibrate(o):!1}var _=!1,I=!1,z=[];function xt(){window.layoutEditor?.opened||(v("load"),v("load",!0),E(u.vibrate*3))}function kt(){window.layoutEditor?.opened||(v("save"),v("save",!0),E(u.vibrate*3))}function Et(){window.layoutEditor?.opened||I||(this.instance&&this.instance[this.instance.active?"release":"press"](),_||(z=[]),_=!_,window.recordingMacro=_,window.lastMacro=z)}async function Lt(){if(!window.layoutEditor?.opened&&!_){I=!I,window.playingMacro=I,this.instance&&this.instance.press();for(let o of z){if(!I||T?.readyState!==1)break;T?.send(o),await new Promise(s=>setTimeout(s,50))}this.instance&&this.instance.release(),I=!1,window.playingMacro=I}}function _t(){document.documentElement.requestFullscreen()}document.addEventListener("fullscreenchange",o=>{let s=h.elements.buttons.find(n=>n.customAction==="fullscreen");s&&(document.fullscreenElement?s.element.classList.add("hidden"):s.element.classList.remove("hidden"))});function lt(){let o=h.elements.buttons.find(f=>f.customAction==="load-state");o&&o.element.addEventListener(u.dblClickLoadSave?"dblclick":"click",xt);let s=h.elements.buttons.find(f=>f.customAction==="save-state");s&&s.element.addEventListener(u.dblClickLoadSave?"dblclick":"click",kt),_=!1,I=!1,z=[],window.recordingMacro=_,window.playingMacro=I,window.lastMacro=z;let n=h.elements.buttons.find(f=>f.customAction==="macro-record");n&&n.element.addEventListener("click",Et);let a=h.elements.buttons.find(f=>f.customAction==="macro-play");a&&a.element.addEventListener("click",Lt);let c=h.elements.buttons.find(f=>f.customAction==="fullscreen");c&&c.element.addEventListener("click",_t)}window.playingMacro=I;window.recordingMacro=_;window.lastMacro=z;window.loadState=xt;window.saveState=kt;window.recordMacro=Et;window.playMacro=Lt;window.fullScreen=_t;bt.V=o=>{let[s]=o.toLowerCase().split(" ");if(u.vibrationFromGame){let n=parseInt(s.split("|")[0]);E(n?3e3:0,!0),rt.classList[n?"remove":"add"](u.useKeyboard?"mdi-keyboard":"mdi-google-controller"),rt.classList[n?"add":"remove"]("mdi-vibrate")}};function Kt(o,s=!1,n){if(!(!o||!o.length)){if(typeof o=="string"&&(o=[o]),n||(o=o.map(a=>u.useKeyboard?st[a]?.[u.player]:st[a]?.[4])),_&&n)return z.push(`${n} ${o} ${u.player}`);if(_)return z.push(`${s?"R":"P"} ${o} ${u.player}`);!T||T.readyState!==T.OPEN||(n?T.send(`${n} ${o} ${u.player}`):T.send(`${s?"R":"P"} ${o} ${u.player}`))}}window.sendCmd=Kt;var v=(...o)=>window.sendCmd(...o);var C=class extends ${constructor(s){super(s),this.type="mobystk:button",this.content=s.content||{type:"mobystk:text",value:""},this.key=s.key||"",this.customAction=s.customAction||!1,this.lockable=s.lockable||!1,this.diagonal=s.diagonal||!1,this.diagonal&&(this.targets=s.targets||[]),this.scalable=s.scalable||!1,this.border=s.border||[!0,!0,!0,!0],this.radius=s.radius||[[0,"px"],[0,"px"],[0,"px"],[0,"px"]],this.fontSize=s.fontSize||[20,"px"],this.active=!1,this.editing=!1;let n=document.createElement("button");n.classList.add("controller-button"),n.dataset.id=this.id,n.instance=this,this.element=n}press(s=!1){if(this.diagonal){let n=h.elements.buttons.filter(a=>this.targets.includes(a.id)&&!a.lockable);for(let a of n)a.press(!0)}else!this.active&&!this.customAction&&this.emit("press",this.key),this.scalable&&!this.active&&!s?this.element?.classList.add("controller-button-scale"):!this.active&&s&&(this.element?.classList.add("controller-button-active-diagonal"),this.element?.classList.add("controller-button-scale-diagonal")),this.active=!0,this.element?.classList.add("controller-button-active")}release(){if(this.diagonal){let s=h.elements.buttons.filter(n=>this.targets.includes(n.id));for(let n of s)n.release()}else this.active&&!this.customAction&&this.emit("release",this.key),this.active=!1,this.element?.classList.remove("controller-button-active"),this.element?.classList.remove("controller-button-scale"),this.element?.classList.remove("controller-button-active-diagonal"),this.element?.classList.remove("controller-button-scale-diagonal")}render(){super.render();let s=this.element;if(!s)return;this.border[0]||(s.style.borderTop="0"),this.border[1]||(s.style.borderRight="0"),this.border[2]||(s.style.borderBottom="0"),this.border[3]||(s.style.borderLeft="0");let n=this.radius.map(a=>a.join("")).join(" ");if(s.style.borderRadius=n,s.style.fontSize=this.fontSize.join(""),s.classList[this.diagonal?"add":"remove"]("controller-button-diagonal"),s.classList[this.lockable?"add":"remove"]("controller-button-lockable"),s.innerHTML="",this.content.type==="mobystk:text")s.innerText=this.content.value;else if(this.content.type==="mobystk:icon"){let a=document.createElement("i");a.classList.add("mdi","mdi-"+this.content.value),s.appendChild(a)}this._html&&(s.innerHTML=this._html),s.classList[this.customAction?"add":"remove"]("controller-custom-action"),s.dataset.action=this.customAction||void 0}toObject(){return{...super.toObject(),type:this.type,key:this.key,border:this.border,fontSize:this.fontSize,content:this.content,radius:this.radius,lockable:this.lockable,scalable:this.scalable,customAction:this.customAction,diagonal:this.diagonal,targets:this.targets}}};var Ot=Wt(Ct(),1);var M=class extends ${constructor(s){super(s),this.type="mobystk:joystick",this.size=s.size||[90,"px"],this.padding=s.padding||60,this.keys=s.keys||["joyLUp","joyLLeft","joyLDown","joyLRight"],this.position={up:!1,down:!1,left:!1,right:!1};let n=document.createElement("div");n.classList.add("controller-joystick"),n.dataset.id=this.id,n.instance=this,this.element=n}render(){this.width=[this.size[0]+this.padding,this.size[1]],this.height=[this.size[0]+this.padding,this.size[1]],super.render();let s=this.element;this.position={up:!1,down:!1,left:!1,right:!1},this.nipple&&this.nipple.destroy(),this.nipple=Ot.default.create({zone:s,size:this.size[0],mode:"static",position:{left:"50%",top:"50%"},lockX:u.disJoyYAxis,lockY:u.disJoyXAxis}),this.nipple.on("move",(n,a)=>this.emit("move",this,n,a)),this.nipple.on("end",(n,a)=>this.emit("end",this,n,a))}toObject(){return{...super.toObject(),type:this.type,size:this.size,padding:this.padding,keys:this.keys}}};document.addEventListener("touchstart",Vt);document.addEventListener("touchmove",qt);document.addEventListener("touchend",It);document.addEventListener("touchcancel",It);function Vt(o){if(!window.layoutEditor?.opened)for(let s of Array.from(o.changedTouches)){let n=document.elementFromPoint(s.clientX,s.clientY);for(;n!==null&&!(n.instance instanceof C&&!n.instance.customAction||n.instance instanceof M);)n=n.parentElement;if(n?.instance.lockable){E(u.vibrate),n.instance.active?n.instance.release():n.instance.press();continue}let a=n?.instance instanceof M;h.currentTouches.push({target:n,touch:s,joystick:a}),n&&(E(u.vibrate),!a&&n.instance.press())}}function qt(o){if(!window.layoutEditor?.opened)for(let s of Array.from(o.changedTouches)){let n=h.currentTouches.findIndex(f=>f.touch.identifier===s.identifier);if(n<0)continue;let a=h.currentTouches[n];if(a.joystick||!u.changeKeyOnDrag&&a.target)continue;a.touch=s;let c=document.elementFromPoint(s.clientX,s.clientY);for(;c!==null&&!(c.instance instanceof C&&!c.instance.customAction&&!c.instance.lockable);)c=c.parentElement;a.target!==c&&(a.target?.instance.release(),(!c||c.instance?.active)&&(c=null),a.target=c,c&&(c.instance.press(),E(u.vibrate)))}}function It(o){if(!window.layoutEditor?.opened)for(let s of Array.from(o.changedTouches)){let n=h.currentTouches.findIndex(a=>a.touch.identifier===s.identifier);n<0||(h.currentTouches[n].target?.instance instanceof C&&h.currentTouches[n].target.instance.release(),h.currentTouches.splice(n,1))}}var Mt=["mobystk:joystick_left_bottom","mobystk:joystick_left_top","mobystk:joystick_right_top","mobystk:joystick_right_bottom"];function dt(o,s,n){if(E(u.vibrateJoystick*n?.distance/45),!u.useKeyboard&&Mt.includes(o.id)){let c=n?.vector?.x,f=n?.vector?.y;o.id.startsWith("mobystk:joystick_left")&&v(`${c||0}|${f||0}`,!1,"VJL"),o.id.startsWith("mobystk:joystick_right")&&v(`${c||0}|${f||0}`,!1,"VJR")}if(!n?.direction){a("up",!1),a("left",!1),a("down",!1),a("right",!1);return}u.disJoyYAxis||a("up",n?.angle.degree>22.5&&n?.angle.degree<157.5),u.disJoyXAxis||a("left",n?.angle.degree>112.5&&n?.angle.degree<247.5),u.disJoyYAxis||a("down",n?.angle.degree>202.5&&n?.angle.degree<337.5),u.disJoyXAxis||a("right",n?.angle.degree>292.5||n?.angle.degree<67.5);function a(c,f){let{key:O,border:L}=Qt(o.keys,c),P=o.element.querySelector(".back");if(P.style[`border${L}Width`]=f?"7px":"",!(!u.useKeyboard&&Mt.includes(o.id))){if(o.position[c]===f)return;v([O],!f)}o.position[c]=f}}function Qt(o,s){let n={up:[o[0],"Top"],left:[o[1],"Left"],down:[o[2],"Bottom"],right:[o[3],"Right"]},[a,c]=n[s];return{key:a,border:c}}var At=720,Tt=400;function zt(){let o;window.outerHeight>window.outerWidth/(At/Tt)?o=At:o=window.outerWidth/window.outerHeight*Tt,vt.setAttribute("content",`width=${o}, user-scalable=0`),h.currentTouches=h.currentTouches.filter(n=>!n.joystick),h.elements.joysticks.forEach(n=>n.render())}window.addEventListener("load",zt);window.addEventListener("resize",zt);var S=class extends ${constructor(s){super(s),this.type="mobystk:group",this.content=s.content||[],this.parsedContent=s.parsedContent||[];let n=document.createElement("div");n.classList.add("controller-group"),n.dataset.id=this.id,n.instance=this,this.element=n;for(let a of this.parsedContent)n.appendChild(a.element),a.render()}toObject(){return{...super.toObject(),type:this.type,content:this.content}}};var Zt=`
	<svg viewBox="0 0 32 32">
		<path d="M16 0a16 16 0 100 32 16 16 0 000-32zm0 4a12 12 0 0111.3 8H4.7c1.7-4.6 6-8 11.3-8zm0 14a2 2 0 110-4 2 2 0 010 4zM4 16c5.5 0 9.9 5.3 10 11.8A12 12 0 014 16zm14 11.8c.1-6.5 4.5-11.8 10-11.8a12 12 0 01-10 11.8z"></path>
	</svg>`;function pt(){let o=h.elements.buttons.find(a=>a.customAction==="drive"),s=o?o._html=Zt:"";o?.render(),o&&o.element.addEventListener("touchstart",n),!Yt()&&o&&o.element&&(o.element.style.display="none");function n(){if(window.layoutEditor?.opened)return;o.active?c():a();function a(){o.press(),o.element.innerHTML='<i class="driveArrow mdi mdi-arrow-up"></i>';let f=0,O=0,L=[];window.ondevicemotion=P=>{let D=window.outerWidth>window.outerHeight,R=P.accelerationIncludingGravity[D?"x":"y"]>=0?1:-1;f=parseFloat(P.accelerationIncludingGravity[D?"y":"x"].toFixed(1)),f*=R*(D?1:-1);let X=o.element.children[0];if(u.useKeyboard){let x=te(O,f,u.driveSensitivity,u.drivePrecision);if(x===O)return;X.style.transform=`rotate(${x}deg)`,O=x,E(u.vibrate*2);let A=ee(x),F=A.filter(B=>!L.includes(B)),W=L.filter(B=>!A.includes(B));v(F),v(W,!0),L=[...A]}else{let x=Math.round(32767/u.driveSensitivity*f);x<10923*u.drivePrecision&&x>-10923*u.drivePrecision&&(x=0),x>32767&&(x=32767),x<-32767&&(x=-32767);let A=90*x/32767;X.style.transform=`rotate(${A}deg)`,v(`${x}|0`,!1,"VJL")}}}function c(){o.release(),o.element.innerHTML=s,window.ondevicemotion=null,u.useKeyboard?(v("joyLUp",!0),v("joyLLeft",!0),v("joyLRight",!0)):v("0|0",!1,"VJL")}}}function Yt(){return location.protocol==="https:"||location.hostname==="localhost"||location.hostname==="127.0.0.1"}function te(o,s,n,a){let c=0;return o===-45?(s>n&&(c=45),s<-n+a&&(c=-45),s>n*2&&(c*=2),s<-n*2-a&&(c*=2)):o===45?(s>n-a&&(c=45),s<-n&&(c=-45),s>n*2+a&&(c*=2),s<-n*2&&(c*=2)):(s>n&&(c=45),s<-n&&(c=-45),s>n*2&&(c*=2),s<-n*2&&(c*=2)),c}function ee(o){let s;switch(o){case-90:s=["joyLLeft"];break;case-45:s=["joyLUp","joyLLeft"];break;case 45:s=["joyLUp","joyLRight"];break;case 90:s=["joyLRight"];break;default:s=["joyLUp"]}return s}function ie(o){let s={...o,parsedContent:o.content.map(Pt).filter(a=>!!a)},n=Dt(s);at.innerHTML="";for(let a of s.parsedContent)a&&(at.appendChild(a.element),a.render());return h.currentLayout=s,h.elements.all=n,h.elements.buttons=n.filter(a=>a instanceof C),h.elements.groups=n.filter(a=>a instanceof S),h.elements.joysticks=n.filter(a=>a instanceof M),lt(),pt(),o}function Dt(o,s=[]){if(o.type==="mobystk:layout"||o.type==="mobystk:group"){o=o,o.type!=="mobystk:layout"&&s.push(o);for(let n of o.parsedContent)Dt(n,s)}else s.push(o);return s}function Pt(o){let s="import"in o?o.import:o.id;if(!u.hidden?.includes(s)&&("import"in o&&(o=ne(o)),!!o)){if(o.type==="mobystk:button")return o=o,u.locked?.includes(s)&&(o={...o,lockable:!0}),new C(o);if(o.type==="mobystk:group"){o=o,o.parsedContent=o.content.map(Pt).filter(a=>a);let n=new S(o);return o.parsedContent=o.parsedContent.map(a=>a.parent=n),n}else if(o.type==="mobystk:joystick")return o=o,new M(o)}}function ne(o){let n=[...h.buttons,...h.groups,...h.joysticks].find(a=>a.id===o.import);if(n)return{...n,...o}}if(!u.layout)throw window.location.href="index.html",new Error("Layout n\xE3o selecionado");var Bt=h.layouts.find(o=>o.id===u.layout);if(!Bt)throw alert("Layout n\xE3o encontrado!"),window.location.href="index.html",new Error("Layout n\xE3o encontrado");ie(Bt);for(let o of h.elements.all)o instanceof C?(o.on("press",s=>v(s,!1)),o.on("release",s=>v(s,!0))):o instanceof M&&o.on("move end",dt);document.addEventListener("contextmenu",o=>o.preventDefault());window.addEventListener("load",()=>{document.body.classList.remove("preload")});
